IMOD History
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
IMOD_2-7-10
12/10/02: Prevented Edit-image-flip during initial image load from crashing
Imod; also stopped a big memory leak upon closing zap windows.

12/10/02: Made newst able to combine transformation, rotation, and scaling.

IMOD_2-7-9
12/3/02: Fixed Transferfid to keep from getting no points in clipped out model
due to roundoff errors.  Also added full error trapping and reporting.

IMOD_2-7-8
12/3/02: Changes to prevent multiple file dialog boxes from appearing in
Imod with unpredictable results.

11/30/02: Made many changes to give clean compilation with g++ compiler.

11/29/02: Improved new visual selection logic in imodv so that it would
work again on an O2.

11/29/02: Fixed bug in Midas that made X/Y translations become incorrect when
passing through 0 shift.

IMOD_2-7-7
11/14/02: Made newst exit with an error status when newstack does.

11/13/02: Prevented right mouse button drag in zap window from modifying 
points in scattered point contours or from other sections.

11/12/02: IMOD_2-7-6 released to replace 2.7.5
11/11/02: Fixed bug in Solvematch caused by the 10/2/02 changes in the 
routines shared with Refinematch and Findwarp.

11/5/02 IMOD_2-7-5 released
11/5/02: Revised and simplified installation guide.

IMOD_2-7-4
11/5/02: Changed Midas to choose a visual explicitly so it will work on
machines with only double-buffered visuals.

11/5/02: Standardized copyright notices with lab name as a variable.

11/5/02: Changed raw2mrc to use library routines to write header.

11/4/02: Modified setupcombine to work around a bug in tcsh 6.12 as distributed
in Redhat 8.0

10/23/02: Added ability to combine thin dual-axis reconstructions by computing
and using only one layer of patches.  Setupcombine will set up for one layer
of patches if the patch thickness is more than two-thirds of the available
range in Z for patches; Refinematch and Findwarp will constrain their solutions
appropriately.

10/22/02: Fixed a bug that was causing movies to freeze because of the
delay imposed after expose events.

10/15/02: Further additions to the event-receiving code and rearrangements
to make model I/O functions more easily accessible from the event processer.

IMOD_2-7-3
9/17/02: Added a signature code to the X events and made Imod ignore events
without the signature.

IMOD_2-7-2
9/13/02: Fixed the way Imod was storing scale in the model header when header
"grid" values are 1,1,1 instead of nx,ny,nz.  Beadtrack now works with this
pattern of header values.  Also fixed the way scale was being reported from
"clip info".

9/13/02: Added ability for imod to receive X events with commands, and added
a program, Imodsendevent, to send such events.

9/11/02: Made changes to zap window to minimize X hangups on the PC with
Nvidia Ti4600 cards when window is resize with R, especially when it is
movieing.  This includes a delay after expose events.

9/9/02: Eliminated strange include statements in Fortran programs that were
needed under VMS.

IMOD_2-7-1
9/5/02: Fixed some problems with combining: a bug in Corrsearch3d when the
rotation is close to 45 degrees, the need for an error exit from Findwarp
when there are too few patches; and Patchcrawl3d exiting with an error when
Corrsearch3d does so, so that combine.com processing stops.

9/5/02: Explicitly choose a visual for the cube in slicer to prevent GLw
crashes.

9/4/02: Fixed coordinate scaling and standardized error reporting in Xfmodel
so that Transferfid would work on files with pixel sizes.

9/3/02: Fixed bugs in storing fill color and the black and white levels for
viewing normal magnitudes in a mesh so they will work between machines of 
different endianness.  Made it backward compatible so that existing models
will still read correctly on machines of the same endianness.

9/3/02: Implemented new method for choosing visuals in imodv to avoid problems
on non-Nvidia systems.

=============================================================================
8/22/02: IMOD_2-7-0 Released
8/21/02: Fixed memory overrun problem in copy function of line tracker and
added a copy button.

IMOD_2-6-22
8/21/02: Updated tomography guide

8/21/02: In Squeezevol, suppressed the confusing output from Matchvol that
seemed to be asking for user input.

8/20/02: Fixed problem with Xfsimplex created on 8/18/02.

8/19/02: Added an option to Trimvol to flip Y and Z in output file.

IMOD_2-6-21
8/18/02: Implemented an include file for the commons in Blendmont and
Reducemont, placed large arrays in common to avoid stack limits, and
made changes so that shifts could be solved for with > 1000 pieces.

8/18/02: Changed Midas's montage fixing mode so that it would do a series
of local solutions for displacement errors when there are more than ~80
pieces.  This makes interactive use possible with > 1000 pieces.

8/18/02: Made ICLAVGSD a library function after finding 2 versions in 4
programs; changed Newstack, Alterheader, Xfsimplex, and Subimage to use it.

8/16/02: Made Alterheader able to set the RMS value in the new-style MRC
header.

IMOD_2-6-20
7/31/02: More modifications to Clip, Matchvol, Warpvol, Taperoutvol, and
Assemblevol to propagate a pixel size as well as all titles in the header
through the entire tomogram combining process.

7/31/02: Changed IMOD's image format to conform to MRC image2000 standard
by moving origin information, eliminating wavelength entries, and adding
'MAP', stamp, and rms entries.  Programs read old or new style headers, and
output new style headers, even when writing back into an existing file.

IMOD_2-6-19
7/28/02: Added 3 fractional zooms to Imod to keep step size to a factor of
1.4-1.6.

7/28/02: Made the I hotkey in the Zap window pop the Information Window to
the front as well as print image information and added a button to the toolbar
to do the same thing.

7/28/02: Modified Transferfid and Repackseed to use a fiducial coordinate
file from Tiltalign to get a better analysis of how points will correspond
between two data sets.  Added ability to use Midas within Transferfid to get
an initial rotational and translational alignment between the axes.

7/28/02: Made Beadtrack, Tiltalign, and Remapmodel scale model coordinates
properly to work with pixel sizes other than 1.0, and standardized their
error outputs.  Changed Tilt to propagate pixel size into a reconstruction.
Verified that all processing steps in generating a tomogram, transferring
fiducials, and combining two axes work with a non-unitary pixel size.

7/27/02: Modified Solvematch to be able to work with fiducial coordinate
files from which lines have been removed, and to refer to points from 
matching model files by negative numbers.

7/26/02: Added ability for Tilt to decide not to use fast backprojection based
on the width, thickness, and number of views in the reconstruction, with
different switch points for PC, SGI, and Sun.

IMOD_2-6-18
7/21/02: In Imod, increased section number output in Zap window to 4 columns
and made the filename outputs in windows show the number of image files
when multiple files are loaded.

7/21/02: Made Setupcombine set up default border sizes based on size of input
volume.  Increased default thickness of small 3-D volume used by Matchshifts
and made this thickness increase with input volume thickness.

7/21/02: Modified Matchshifts to reduce extraneous output and report on
its progress instead.  Added STATUS reports for each piece to volcombine.com.

7/20/02: Standardized error outputs for Tilt, Ccderaser, Tomopitch,
Solvematch, Refinematch, Findwarp, Corrsearch3d, and image reading routines.

7/20/02: Made imod start saving image file origin information in the model
file so that programs can convert model coordinates back to the index
coordinates in the full volume even if the model was loaded on a subset of the
image file.

7/20/02: Revised Solvematch, Refinematch, Findwarp, Tomopitch, and
Corrsearch3d to scale model coordinates properly, so they should work with
volumes that have pixel sizes other than 1.0.

7/20/02: Made Corrsearch3d rather than Patchcrawl3d determine which patches 
should be excluded because they are not from good areas of the second volume,
which should fix problems in combining tomograms with a rotation much
different from 90 degrees and with both a large shift between volumes and
large excluded areas.

7/20/02: Resurrected Solvematch's ability to work with matching model files
and added a capability to find a solution using just matching model files and
no fiducial coordinates.

7/20/02: Rearranged input to Findwarp so that it is easier to run it
automatically while excluding rows or columns of patches, and added arguments
to Matchorwarp to specify rows or columns to exclude and to run it in a trial
mode.  Exclusion of rows or columns can now be explored by running
matcorwarp.com, without running Findwarp interactively.

IMOD_2-6-17
7/7/02: Made Ccderaser use scale factors from the model file to get back to
index coordinates, so now one model file can be used with image files that
have different pixel spacings.  Also made all errors cause the program to exit
with error status, and upgraded the title entry.

7/7/02: Added a function to the model reading interface for Fortran to return
the scale factors used to get between model to index coordinates.  Modified
Clipmodel to use these factors, so it will now work with a model built on
an image file with a pixel spacing other than 1.0.

7/6/02: Fixed problem in nda caused by adding checks on array size.

7/1/02: Fixed bug in corrsearch3d (used by patchcrawl3d) that was giving 
slightly wrong patch displacements on the SGI and "nan" output on the PC.

IMOD_2-6-16
6/26/02: Added ability for C programs to write back to byte-swapped files also,
so now Mrctaper and Clip work overwriting or appending to byte-swapped files.

6/25/02: Fortran programs can now write back into byte-swapped files, except
for extended header data.  Ccderaser and Densmatch will now run on 
byte-swapped files.

6/25/02: Changed all STOP statements in Fortran image library to call exit
with an error status instead.

6/25/02: Fixed bug in Tomopitch and Findsection that gave the wrong vertical
shift with X-axis tilt correction.

IMOD_2-6-15
6/20/02: Fixed bug in imodfillin that gave points out of order at start of
contour.

6/19/02: Added an option to imodauto to enter thresholds as unscaled values.

IMOD_2-6-14
6/19/02: Changed tomogram combining so that it uses a master command file to
run a set of other command files that do specific steps.

6/18/02: Added an option to Imodauto to specify a color for the model object.

6/5/02: Made Nda work with scattered points, which can be in contours that
have many points per section.  Increased array size for boundary contours
and added check on overrunning these arrays.

5/22/02: Had Transferfid analyze and report the correspondence between points
in the two fiducial models, and eliminate empty contours from the new seed.

IMOD_2-6-13
5/20/02: Added -S option to Imod to start with slicer rather than Zap window.
To make this option more convenient, made slicer set current point to center
if it has been defined, and made it load the cache for the current point.

5/20/02: Changed Tomopitch so that it can analyze a single model file
containing contours at different time intervals, so that all samples can be
modeled in a single invocation of Imod.  To support this option, when multiple
image files are loaded, Imod will now set up new objects (or a new model) to
assign time indexes to contours by default.

5/20/02: Fixed Tiltxcorr and Xfsimplex to work with 4Kx4K images; in Xfsimplex
such large images must still be reduced by at least a factor of 2 internally.

5/20/02: Implemented Transferfid for making a seed model for the bead tracking
on a second axis from the fiducial model for the first axis.

5/20/02: Fixed 3-D model output in Tiltalign for points assigned to two
surfaces and made it work properly with points in multiple objects; also
defined objects as scattered points so the model is ready to view.

5/6/02: IMOD_2-6-12
5/6/02: Changed Tiltalign to work better with a subset of views; it puts out
a full set of transforms and tilt angles for downstream programs and refers
to all views by their view number in the file rather than in the particular
selected subset.  Added an entry for a list of views to exclude in
Copytomocoms and propagated this into track.com, align.com, and tilt.com.
Added an EXCLUDELIST option to Tilt to make it easier to use the same list
in both Tiltalign and Tilt.

5/6/02: Changed the surface analysis output in Tiltalign to make it more
understandable and more easily readable by programs; made Alignlog read the
old or new form correctly and fixed a problem with Alignlog's reading of the
log file name.

5/2/02: IMOD_2-6-11
5/2/02: Fixed bug in tiltxcorr in which images with negative tilt angles
had their shifts inappropriately destretched.

4/29/02: Made tiltxcorr bin images larger than 1024 pixels down to 1024 or
smaller.

4/29/02: Stopped xfalign (xfsimplex) from failing when images match perfectly.

4/19/02: IMOD_2-6-10
4/18/02: Made transfer of extra header swap bytes correctly for data
consisting of integers and reals.  Made newstack copy this kind of extra
header information properly on a per-section basis.

4/10/02: Fixed a bug in imodmesh in routine that scans for shortest legal 
connection between contours on same slice.

2/26/02: IMOD_2-6-9
2/26/02: Made the Fortran code that reads image files test for Boulder-style
extended header data versus data consisting of 4-byte integers and reals,
and swap byte appropriately.  Made extracttilts able to get tilt angles if
they are the first real numbers in an extended header.  Also improved the
protection against misinterpreting non-Boulder image files as montages.

2/26/02: The 1/25/02 change to xyzproj broke it for the SGI, so the array 
dimensions were reduced so that it can do either very large images or very 
many projections,

2/1/02: In Tilt, modified the writing in the PARALLEL mode to partially
demangle the file and prevent very slow reading under Linux.

1/28/02: IMOD_2-6-8
1/28/02: Fixed new bug in xyz drawing routine.

1/28/02: IMOD_2-6-7
1/27/02: Added ability to apply selection criteria to Genhstplt.

1/25/02: Increased allowed number of projections in xyzproj and added check on
number requested.

1/25/02: Made goodframe produce only even sizes.

1/25/02: Fixed two problems with movie controller: coming up with no image
sizes if it is opened before image is done loading; and the average rate
becoming wrong if movie is stopped with the mouse button.

1/24/02: Enhancements to XYZ window: Made it use the same image drawing code as
the Zap window so that it would not be slow with fractional zooms; added
ability to display in high-resolution mode and to take snapshots of the
window; added ability to pan the window with the mouse; made the model
display have fixed line widths and symbol sizes independent of zoom; made
attachment to the nearest model point work just like in the Zap window;
added ability to riffle through images by dragging the current point
indicators with the mouse.  Added a section documenting this window to the
imod man page.

1/23/02: Fixed imodextract's report of invalid object number.

1/15/02: Fixed a problem with midas in montage fixing mode that occurred
if there was only one section.

=============================================================================
1/13/02: IMOD_2-6-6 - released to provide Red Hat 7.1 distributed version that
later patches would be compatible with, and to provide Sun version that would
work with large files.

1/13/02: Made imodmesh work with inside-out annular-horseshoe transitions.

1/10/02: Added alignlog to makefile so it would be properly installed.

1/9/02: Fixed Tiltxcorr and Tilt to work with more than 360 tilt views.

1/8/02: IMOD_2-6-5
1/8/02: Changed prenewst.com to reset pixel sizes to 1 in the prealigned
stack, so that align.com would run correctly if pixel sizes are set in the
raw stack.

1/7/02: Fixed dimensioning error in Beadtrack that was erroneously producing
a diagnostic image file and could have produced other problems with very
large bead radius values.

1/6/02: Determined configuration parameters needed to make large files work on
the Sun.

1/4/02: IMOD_2-6-4
1/4/02: Discovered that invoking csh with the -ef flags in the subm alias
prevented problems with csh startup scripts that generate errors, so changed
the ...install files and documentation accordingly.

12/31/01: IMOD_2-6-3
12/31/01: Added dm2mrc for converting Digital Micrograph version 2.5 and 3 
images files.

12/28/01: Added option to newstack to disable scaling upon mode changes.

12/27/01: Fixed raw2mrc to do long integers, to do bytes correctly on PC, and
to swap floats and long integers correctly.

12/17/01: IMOD_2-6-2
12/13/01: Added hotkeys to the zap window for smoothing and advancing to the
next section when using autocontouring; removed the b hotkey from the xyz 
window.

12/13/01: Added ability to fill the cache to a selected degree and with
several possibilities for apportioning the filling among multiple image
files.  Also added an autofill option.  This can provide faster, more 
efficient loading of Y-Z flipped slices from large image files.  The window is
opened via Edit-Image-Cache Filler.

12/10/01: Added program imodfillin to interpolate contours on sections that
are missing them.

12/10/01: In libiimod.so, added a test that extra header information be
consistent with being produced by our programs before a file would be
recognized and treated as a montage; also excluded Deltavision files from
being montages.

12/4/01: IMOD_2-6-1
12/3/01: Restored capability of Fortran programs to read old Wimp binary
models even though the package is compiled to convert IEEE floats rather than
VMS floats, and made this work on both little and big endian machines.

11/30/01: Fixed bug in imodv when lighting both sides of an object with 
transparency.

================================================================

Version 2.6.0 was the first release after putting the source under CVS.  It
had mostly bug fixes and would have been labeled as a minor release if not
for the change in the numbering scheme.  The dates are 2001.

Jul. 26: Modified xftoxg and xf2xg to do hybrid of local and global alignments.

Jul. 27: Added echo2 (echo to standard error) to distribution.

Jul. 27: Modified xfalign to do initial cross-correlation before alignment
search; modified xfsimplex to take the initial transform; changed setupcoms and
setuplong to accommodate this and use echo2.

Jul. 27: removed diagnostic print statement from imodmesh.

Jul. 29: bashinstall was missing /bin in the path statement.

Jul. 30: Fixed bug in computation of plane information from point and normal
(libimod.so).

Jul. 30: Setupcombine reported size of large patches wrong in query.

Jul. 31: Fixed memory leak in clip stat.

Aug. 2: Discovered mrcv, tomrc, frommrc missing group/other execute permission
in Irix distribution

Aug. 3: In imodv, made the current object for object editing be initialized as
the current model object if possible; this fixed a problem with clipping planes
not being reported correctly and not being movable before the object edit
window was opened.

Aug. 4: In imodv, made changes to views be stored automatically before going
to a different view or saving the model, so that the last settings that were
seen for a view become the settings that are seen when coming back to the 
view.

Aug. 4: Added capability to imodinfo for applying object clipping planes when
calculating surface areas and volumes and getting information about scattered
points.  Inside contours are handled properly.  Added mesh surface area outputs
to the full object report, and eliminated erroneous clipped cylinder surface
area.

Aug. 10: In imod zap window, added double draw after resize on PC to workaround
bad display with GeForce3 card.

Aug. 11: Fixed the display of autocontour pixels in the zap window with
fractional zooms.

Aug. 11: Fixed bad problem with center of mass calculations that are reported
in imodinfo and used in imodmesh to place caps correctly.  This was broken by
the time-related changes on June 19.

Aug. 27: Found that compiling with -D_FILE_OFFSET_BITS=64 made Linux version
work with large files over NFS and on EXT2 file systems.

Aug. 28: Added numbers to the depth cue sliders in imod.

Aug. 28: Added an option to tif2mrc to turn a 24-bit color image into 8-bit
grayscale; made tif2mrc work correctly with multi-page tiff files in all 3
modes, 8 and 16-bit grayscale and 24-bit color.

Aug. 28: Added a function to libiimod.so so that midas could read RGB images
directly.

Aug. 29: Added ability to move center of rotation and stretch in midas, 
defined this as a position on the image rather than in the display, and made
all mouse actions occur relative to this position.

Sept. 6: Made background subtraction in tif2mrc work for 16-bit data.

Sept. 7: Added a guide to serial section alignment, with links to it from
the IMOD guide.

Sept. 10: Fixed bug writing models from Fortran programs.

Sept. 21: Made clip resize change image origin in correct direction.

Sept. 24: Changed setupcombine to delete ...mat~ by name, without a *, to 
work around big file globbing problem.

Sept. 24: Made .ecd file get backed up by "savework".

Sept. 24: Made imodjoin able to combine more than two models.

Sept. 25: Modified newstack to operate on very large images by reading and
writing in chunks.  Images bigger than 10K by 10K can be used if there is not a
large rotation; for rotations > 30 degrees, images can be up to 4K by 4K.

Sept. 26: Added -P option to imodmesh to make connections between contours
progressively farther apart in Z on multiple passes through the contours.

Sept. 26: Added a message to midas reminding user to build new edge functions 
when fixing montage overlaps.

Sept. 26: Fixed two memory-related bugs in clip 2d correlation.

Sept. 27: Increased maximum output line length for Blendmont to 30000 pixels.

Sept. 27: Fixed bugs in densmatch, filltomo and tilt for file size > 2
gigapixels; integer arithmetic cannot be used to get total number of pixels.

Oct. 24: In raw2mrc, added option to divide unsigned 16-bit values by 2 instead
of subtracting 32767.

Oct. 24: Make a new contour inherit the open-closed flag from the current
contour so that one does not have to push the button for each contour.

Nov. 6: Fixed a bug in matchvol and warpvol that would only show up if there
is substantial expansion in the transformation; changed rotatevol for 
consistency.

Nov. 6: Added output of min, max, mean and s.d. to subimage, and ability to
get no output file.

Nov. 8: Implemented a new way of imposing a tilt around the X axis in Tilt,
so that fast backprojection could be used.

Nov. 10: Changes from working with Intel compiler: change "call exit" to
"call exit(0)" in 44 Fortran programs; change name of /mod/ common to /wmpmod/;
eliminate features deleted in Fotran 95 (non-integer do loop in tiltalign.f,
pause in betacf.f and betai.f, Hollerith in cmplft.f, mdftkd.f, rsymft.f,
sdiad.f, and srfp.f).

Nov. 14: Fixed bug in solvematch from failure to declare a 3-item array.

Nov. 15: Fixed patch2imod, badly broken when patch files started being
generated by patchcrawl3d instead of patchcorr3d.

Nov. 15: In every script, added $IMOD_DIR/bin to the front of the path if
$IMOD_DIR was defined.  Modified vmstocsh to output the same command into the
csh script that it produces.

Nov. 15: Changed copytomocoms and setupcombine to detect when image files are
floating point and adjust tilt.com and combine.com accordingly.

Nov. 16: Updated the iclden subroutine in libim.so to get a more accurate mean
for large images by computing partial sums.

Nov. 16: Changed imod to detect VPRO grpahics on Octane2 and use rgb mode 
rather than pseudocolor.

Nov. 17: Added a shell script, alignlog, to extract useful parts of a
tiltalign log file.

Nov. 17: In imod, stop movie in X and Y when close XYZ window.

Nov. 18: Changed tif2mrc, mrc2tif, and the the tiff routines in libiimod.so so
that 1) the routines (and thus imod) can now read data from files organized in
tiles, compressed or not; 2) tif2mrc will now use the libiimod.so routines if
libtiff.so is installed on the system, so it can now convert files that are
compressed and/or organized in tiles.  3) tif2mrc can preserve information in
unsigned integer files by shifting the data or dividing it by two; 4) mrc2tif
sets a tag that a 16-bit file is signed; 5) imod reads 16-bit tiff data as
unsigned unless there is a tag that it is signed; 6) the tiff reading routines
work better with data from various sources by no longer assuming that there is
a tag for samples per pixel and not allowing incorrect strip counts to cause a
read past the end of an image.

Nov. 19: Added option to imodinfo to suppress listing of each contour.

Nov. 23: Switched slicer high-res mode to use faster method for zoom > 1.5
in which it forms an interpolated image at 1:1 zoom then zooms it up with cubic
interpolation, giving a smoother result (coded in 1999 but left unactivated).

Nov. 28: Fixed a bug in Tilt when fast backprojection padded to odd sizes.

Nov. 28: Made samplea.com produce topa.rec, mida.rec, bota.rec, and similarly
for sampleb.com.  Made align.com easier to use with added comments and use
of CAPITALS for common items to change.  Changed $! to # for comments in all
command files.


================================================================

Version 2.50 had a lot of changes in tomography processing and included
changes from building for the Sun.  The dates are 2001.

Feb. 25: In Irix 6.5 distribution, changed lib/libtiff.so to lib/nolibtiff.so
to prevent masking of system-installed libtiff for old 32-bit programs.

Feb. 25: Prevent graph window from opening if no image data.

Feb. 25: Fix bug in line tracker that crashed program when doing an undo after
a contour copy.

Feb. 26: Implemented ability to do tomogram combining in temp space, requiring
changes to matchvol, warpvol, and rotatevol, and various scripts in addition
to setupcombine.

Feb. 28: Implemented Taperoutvol and Assemblevol for extracting a padded volume
that is tapered on the outside, and for efficiently reassembling a volume
from pieces in X, Y and Z.  Changed Tomopieces and Setupcombine to divide 
volume in X and Z and use these new programs.

Mar. 1: Implemented ability to build tomograms in scratch space and have files
copied automatically to backed-up area.

Mar. 2: Increased file limit for MRC files to 20, made an imsubs include file
to make this easier and safer to do.

Mar. 4: Changed Makefiles to use $(FC) and $(CC) instead of cc and f77; 
changed "find" to $(FIND) in flib/subrs Makefiles.

Mar. 4: Got calc working correctly and compilable under g77.

Mar. 5: Speeded up XYZ window with cached data by eliminating calls to
ivwGetValue.

Mar. 7: Added ability to take automatic snapshots of a Zap window through one 
full cycle of a movie.

Mar. 8: Fixed matchvol, warpvol, and rotatevol so that their temporary 
filenames will be distinct even if the time subroutine fails to return a time.

Mar. 10: Eliminated Sun-specific geometry settings of dialog boxes.

Mar. 10: Fixed problems with imodv-edit-objects window that caused lower frame
area to shrink at the expense of the top line, and made it resize the whole
dialog box if necessary when switching frames, to fit the size of a given 
frame.

Mar. 12: Set up imod and midas to fork into the background on all platforms, 
and made imodv fork into background also.

Mar. 12: Changed logic for selecting a GL visual in imod so that it would first
try 12-bit pseudocolor, then 24-bit RGB, then 8-bit pseudocolor.  This makes
it come out with a good visual on the Sun by default, avoiding the 8-bit
pseudocolor which works poorly.

Mar. 12: Cleaned up the setup program and changed some variables used by a few
Makefiles, and added some explanations to the "default" section of setup.

Mar. 12: Consolidated all changes from the Sun port and released locally;
packed up the Sun binaries.

Mar. 13: Fixed bug in extracttilts that showed up with more than 1000 pieces.

Mar. 14: Fixed bug in blendmont when reading edge function files that need
swapping.

Mar. 14: Fixed bug in midas that changed contrast settings inappropriately
when going to overlay mode.

Mar. 14: Prevent F2, F3, F6, F7, and F8 from taking black/white sliders out
of bounds.

Mar. 16: Made fortran library routines read tilt angles correctly from the
header of byte-swapped files.  Rationalized the definitions of some of the
MRC header entries between the fortran and C code and made both sets of
routines swap the unused but defined header entries in the same way.  Found
that mrcx did not work on little-endian machines and fixed that.

Mar. 18: Built current source for Sun, released as 2.42.

Mar. 20: Implemented pre-stretching of input data in the Tilt program, which
provides an alternate solution to the problem of slow integer truncations on
the PC and speeds up the program 30-50% on SGI and PC.  Used linear 
interpolation with internal representation at twice the frequency of the input
data, after finding that this best approximates the results from the regular
method without unduly amplifying noise.  It falls back to the regular method
if there is insufficient array space for the stretched data.

Mar. 21: Fixed bugs in clip, midas, imodmop and imodcmopp that prevented them
from writing an output image file if the input file was byte-swapped.

Mar. 22: Changed if-test code in mtoverlap to workaround bug in g77 
optimization.

Mar. 22: After compiling with Portland compilers with warnings, changed a type
conversion in densmatch and fixed an actual bug in blendmont.

Mar. 23: Fixed memory leak and failure to initialize font on repeated files 
in the fortran postscript graphics interface.  Added ability to set new page
or not in mtoverlap, and fixed some problems with paging and drawing.

Mar. 23: Fixed problems in clip and mrcfiles.c with flipping data from swapped
files, and with flipping xz or xy in general.

Mar. 25: Fixed problem with putimod when it was used to write multiple
model files from Fortran.

Mar. 26: Adopted some changes from Lambert Zijp: fixed memory leak in
imodel_contour_overlap; fixed memory leak in imodel_point_delete in which it
failed to free arrays when the number of points dropped to zero; then had to
change imodel_contour_scan to not use this function to delete points; made
imodContourMoment use pre-existing scan contour or make one if needed; made
imodContourCenterOfMass create a scan contour before calling
imodContourMoment.

Mar. 28: Modifed tif2mrc to detect whether Tiff image is organized in tiles
and exit with an error message.

Mar. 29: Fixed computation of slice minimum when clip makes an FFT.

Mar. 29: Fixed bug that crashed imod when two kill events were issued to a
slowly displaying slicer window that needed to do a redraw first.

Mar. 29: Made it drop back to previous contour when deleting a contour or
moving a single contour to another object, but leave the current point
undefined so that it would not pop that contour into the display.  

Mar. 30: Replaced use of imodel_point_add with adding of points and allocation
in chunks in the scan conversion routine, another slight efficiency improvement
for imodmesh.

Mar. 31: Changed all uses of mrc_slice_getval and mrc_slice_putval to 
sliceGetVal and slicePutVal to avoid double function calls.

Apr. 6: Fixed setupcombine so that combine.com won't stop if someone purges
the mat~ file before the command file goes to delete it. 

Apr. 16: Added a frames per CPU second in imodv to the o hotkey output.

Apr. 19: Made the imod Edit-Image-Process functions take account of time
properly in multi-file displays.

May 3: Added a new program, Fiberpitch, to measure pitch angles relative to
an axis.

May 6: Added the Sandberg/Beylkin fast back projection algorithm to the Tilt
program.

May 8: Changed makejoincom and finishjoin to handle different file sizes
properly.

May 15: Fixed bug that crashed imodv when switching between models after
opening and closing the model edit window.

May 21: Made the frame rate output of imodv be based on real time rather than
CPU time, and added a frame rate output for image display to the movie 
controller window.

May 23: Wrote Mrctaper to taper the transitions between actual image and
filled-in background, such as occur in images that have been transformed by
Newstack or Blendmont.

May 25: Modified Blendmont and Midas to allow fixing of montage overlaps.
In blendmont, added options to save edge displacements to a file and to read
them from a file on a second run, and improved the finding of displacements by
adding a search for displacement that minimizes the SD of the difference,
after the initial cross-correlation.  In midas, added a whole new mode for
displaying displacements between montage pieces, with solutions for edge
displacement errors.

May 30: Fixed memory allocation bug in midas when saving transforms.

Jun. 8: Incorporated ability to solve for tilt around the X-axis into
Tiltalign, but had it run the old code when no tilt is being solved for,
for speed and consistency.  Got Tilt to use these tilts with the right sign,
but found that the resulting reconstruction had a poorer quality than when
the alignment solution used in-plane rotation instead.  Left Tiltalign so that
it does not ask for entries about X-axis tilting, so as not to make align.com
needlessly more complex; but the X-axis option can be available by changing a
single flag and recompiling.

Jun. 9: Solved memory allocation problems in Tiltalign and Beadtrack by 
coding some 2-D arrays as 1-D; set limits for number of fiducials and number of
tilts quite high with the assumption that only one of these would be very high
for a given data set.

Jun. 11: Made tiltalign keep track of and report imod object and contour
number, and modified beadfix to work with this information when present.

Jun. 11: Fixed bug in imodjoin when using -r flag to replace objects.

Jun. 11: Made new programs, patch2imod and imod2patch, for converting patch
displacements to and from a model file.  Modified findwarp so that it would
work with a patch file missing displacements at some positions.

Jun. 11: In Imod and Midas, found and implemented a workaround to an 
X/Motif bug that made radio buttons "stick" on the PC after being set from
within the code.

Jun. 11: Made smoothsurf work properly on a model built on a flipped stack.

Jun. 13: Added "subsetstart" and "fullimage" entries to Tilt so that it could
correctly compute a sample of a tomogram from a subset of an aligned stack
with and X-axis tilt or local alignments.  Changed Copytomocoms and sample.com
to feed the correct starting coordinates in when sampling.

Jun. 15: Added ability to specify IMOD_AUTOSAVE_DIR to do autosave onto a
local disk.

Jun. 16: Made Bead fixer plugin able to move a point by its residual and to 
undo the move, and keep track of points so that they can be examined only once.

Jun. 16: Provided finer control of ghost display mode by adding toggle
buttons for Up and Down in the Edit-Contour-Type window; fixed problem with
ghost display when Zap window is locked.

Jun. 17: Fixed some obvious problems with modeling time data, such as 
autocreation of new contours when section or time does not match, and control
of contour display for closed contours in the zap window.

Jun. 17: Made attach with mouse button in the Zap window be distance-invariant
with zoom, so that it would be easier to attach in zoomed-down images.

Jun. 20: Fixed remainder of problems with handling of time data.  Made imodmesh
mesh separate times separately by default, and set both the surface number
and the time in output meshes.  Modified model I/O so that mesh time and
surface number are stored together where time used to be.  Made imodv display
meshes by time and added ability to display current surface only for mesh
data just as it can be for contour data.

Jun. 21: Fixed bug in Taperoutvol (taperoutpad subroutine) when X or Y input
dimension is odd.  Made sure tapervoledge could handle odd input sizes too.

Jun. 22: Fixed bug in auto snapshot of zap window on PC with float on.

Jun. 23: In Solvematch, changed limit for adding new pairs of fiducials so that
it equalled the residual limit for stopping, since there were problems with
points being added that were not recognized as outliers.  Increased limit in
combine.com from 5 to 8 to compensate.  Tested on 12 data sets.

Jun. 23: Changed rotatevol, matchvol, and warpvol to strip directories off
of image file name before composing the temporary filenames.

Jun. 27: Made newstack really not float images when no floating is selected,
by truncating out-of-range pixels in a byte image that has been interpolated.

Jun. 27: Added an option to offset images in finishjoin.

Jun. 27: Made the default number of pixels for findcontrast to saturate be the
maximum of one per slice and one per million.

Jul. 16: Wrote programs to find displacements in 3D between patches of two 
volumes by iterative search instead of FFT-based cross-correlation
(Corrsearch3d and two shell scripts, Patchcrawl3d and Onepatchcorr).  This is
over 10 times faster than Patchcorr3d and allows larger patches to be used
routinely with little time penalty, thus giving more accurate fits.

Jul. 22: Fixed horrible bug when doing local fits in xftoxg, introduced with 
elimination of structures in IMOD 2.40.

Jul. 22: Added a shell script, Selfalign, to do refined alignment of a
microtubule model.


================================================================

Version 2.42 fixed a lot of problems that showed up after the Linux release,
and had enhancements in autocontouring. The dates are 2001.

Dec. 31: Made image drag with mouse in zap window work the way it used to: it
just slips for the 0.25 second, then follows the mouse from there, instead of
lurching to match the moves in the first 0.25 second.

Jan. 4: Implemented another hack on PC to draw images in chunks no bigger than
a fraction of the original size of a window, needed for ULTRA card only.

Jan. 12: Fixed problem in imodmesh when capping a contour for which moments
can't be computed.

Jan. 15: Fixed bug when drawing open triangles in plax on the PC.

Jan. 17: Upgraded imodauto: incorporated the non-recursive algorithms from
imod autocontouring; fixed problems with setting of low and high thresholds
and redefined the options for setting threshold; made sure it created areas
exclusively above the high threshold or below the low threshold; added option
for intensity scaling and made sure that intensities would match those in data
loaded into imod, with or without the -s option; made contours go to the edge
of the image area instead of 0.5 pixel in; added an option to eliminate
contours touching a selected number of edges; and revamped the man page to
explain what the program actually does.  Also modified imod to call the same
library routine for building the contour.

Jan. 18: Fixed some problems with imod2vrml, added capabilities to match
almost all of the display variation in imodv, and amplified the man page to
explain how to get desired results.

Jan. 19: Implemented ability to press keypad insert key instead of middle
mouse button for adding model points, either single points or continuous
tracing.

Jan. 20: Changed Nda to use double precision to avoid problems from
difference between internal representation of numbers in the FPU on the PC and
the nominally single-precision numbers.

Jan. 26: Implemented a new algorithm for converting a pixel area to a contour
in imodauto and imod autocontouring.  Added smooth, shrink, and expand to
imodauto.  Adjusted threshold tests so that in imod, the pixels that are black
are exactly the ones that are filled (the white already were correct), and 
made sure that imodauto interpreted thresholds exactly the same.

Jan. 27: In midas, fixed bug that computed translations incorrectly when 
reading transforms in from a file; fixed bug that crashed program when Save-As
was invoked after reading transforms from a file.

Jan. 30: Fixed new library routine for converting a region of pixels to
contours so that individualy included or excluded pixels will be handled
correctly in imod autocontouring.  Implemented an option of connecting pixels
that touch on their corners in imodauto and imod autocontouring, and added
options to imodauto to make it easier to find inside contours.

Jan. 31: Updated Makejoincom was not installed on SGI or in SGI distribution.

Feb. 1: In the line tracker, implemented proper handling of bytes based on
the Fortran "endian" include file, so that it would work on both PC and SGI.

Feb. 1: Fixed bug in imodv object edit window that crashed on PC when On's
are selected and the draw type is changed.

Feb. 1: Make F2 advance black and white when they are already equal.

Feb. 1: When adding or deleting pixels to autocontouring in the zap window,
made it call routines in auto with integer rather than floating coordinates,
made those routines test for points out of bounds, and made the pixels display
as yellow and ghost color in both index and RGB color mode.

Feb. 2: Modified Tapervoledge to allow single X/Y slices to be tapered on 
edges.

Feb. 2: Prevented contrast change from making the zap window pan to current 
model point with 24-bit visual (PC).

Feb. 5: In midas, fixed bug that failed to get a new array for image
when window became larger.

Feb. 5: Added option to alterheader to change header so that programs will no
longer access piece list data in extra header.

Feb. 5: Changed Caret-G to Ctrl-G in subm aliases in sgiinstall and pcinstall.

Feb. 7: Prevented multiple confirmation windows for saving model when quitting
imod, or for saving transforms when quitting midas.

Feb. 7: Made sure imodv object list window is updated when a different view is
selected, even if object edit window isn't open.

Feb. 10: Made montaging work for color image files, via piece list or image 
list file.

Feb. 10: Added command-line options to create a piece list internally in order
to display a set of images in montaged arrays.

Feb. 11: Fixed problems with the size of the cache when images are loaded
flipped; implemented ability to specify cache size as megabytes or sections;
centralized the code for setting cache size for all kinds of data so that all
routes to getting montaged images would work the same; made it preserve the
memory size of the cache when images are flipped.

Feb. 11: Set the scaling properly for reading complex float data into cache
situations, so that complex files can be cached, displayed with multiple files,
and displayed as a montage.  Only complex integer files cannot be used with
these features now.

Feb. 11: Added ability to save a tiff file of the contents of memory so that
a montaged set of model snapshots could be assembled easily into a single big
image.

Feb. 12: Fixed bugs when loading subsets of a complex float image in uncached
mode, and when loading subsets of a single image file of any type when cache
is turned on with -C.

Feb. 12: Made reducemont clear out extra header information in the output
file.

Feb. 12: Fixed problem with Edit-Object-Info when there are empty contours,
caused by comparisons with psize - 1 when psize is 0, because psize is an
unsigned int.  Scanned all C code for similar comparisons, fixed a few others.

Feb. 12: Put in better sequence of tests for legality of objects and contours
in contour break and join functions.

Feb. 12: Made object, contour, and point up and down arrows in info window
cycle around instead of stopping at the bottom and top.

Feb. 14: Fixed bug in the way that clip fft -2d replicates the right half of
FFT into the left half by mirror imaging.

Feb. 14: Fixed rounding error which made pixel view window show double display
of row 1 or column 1.

Feb. 15: Made -s option in imod work for loading complex data, both cached and
noncached cases.

Feb. 16: Upgraded mrcbyte and added it to distribution, since it is a good way
to convert complex data to bytes, and to replicate the two stages of scaling
that can be achieved in imod with the -s option and contrast sliders.

Feb. 16: Added copy to previous and next section to the Edit-Contour-Copy
capabilities, added some more checks on validity.


================================================================

Version 2.41 was the first release for Linux.  The dates are 2000.

Nov. 6: Fixed Midas Makefile sync failure and changed setup to eliminate rpath
- repacked source.  Also made a new pcinstall and added comment to install 
file.

Nov. 7: Fixed plax.c sync failure.  Rebuild our libraries, but since it still
works on SGI, don't need to change distribution.

Nov. 8: Got version of tilt with subroutines that could be doctored to keep
integer truncation from being such a poison step on the PC.

Nov. 9: Fixed all makefiles to use $(CP) and $(FIND) to insulate from aliases,
to handle non-buildable programs better, and to do the conditional make on
tilt.  Fixed details in top makefile and man directories so that make src
will make a fully competent distribution.

Nov. 10: Contour moving: finish job of preventing the replacement of a contour
by a single point from happening to scattered point contours.  Also, prevent
contours from being moved within an object, which was disastrous.

Nov. 10: Fixed scripts/Makefile so it would install makejoincom and
finishjoin.  These are not in the distribution.  Also retrieved a version
of makejoincom with fixes for files of unequal sizes and made it be the
current version.

Nov. 10: Midas built on Indy instead of Indigo crashed on Octane - this is
in distribution.

Nov 10: Made imodinfo able to analyze for inside contours and compute areas
and volumes in a specified subvolume.

Nov. 11: Fixed rounding of point sizes for on-section display of scattered
points in zap window.

Nov. 11: Use OpenGL display list to draw scattered points of default size in
model display - makes big difference on PC but not on SGI.

Nov. 11: Fixed the selection of alpha blending functions so that line
anti-aliasing works properly and transparency works better.  Discovered
that transparency works better with no back faces displayed unless there is
two-sided lighting, so enabled back-face culling.  Revised help menus to
describe this, and some lighting properties better.

Nov. 13: Fixed release copies in web site to incorporate all of the above.

Nov. 14: Fixed error in calculating surface area of a subvolume in imodinfo.
Made mtk, nda and sda compute a random seed on only the first invocation of
the randomizing subroutines, to avoid repeatedly getting the same seed on
fast-running tests.

Nov. 16: Imod: fixed problems with color map not being recomputed
after cleaning model and with bad attempts to free colors (for color
index display).  Fixed problem on PC with using contrast sliders when
float button is on.

Nov. 16: Fixed makefiles in imod and scripts directories to create local links
in the bin directory for imodv and bgimodv - the link for imodv in the
distribution must never have worked before.

Nov. 16: Made Makejoincom compute how the actual rotation angles change slice
numbers, instead of assuming typical rotations, so that it can extract the
right slices and figure out if a section is inverted.

Nov. 17: Made Mtk not move items outside of the bounding contours when
randomly shifting items.

Dec. 6: Made closing the model view window via the window manager go through
the same quit routine as the q key, so that all dialog windows get closed.

Dec. 6: Made ghost mode display contours from next section as well previous
one.

Dec. 9: Fixed problem with findwarp when boundary contours are used to define
usable patches; made it require that the data not be almost all in one row of
patches in any dimension before it would find a local solution.

Dec. 10: Made TIFF and RGB saving from image windows (zap, slicer, etc) work on
PC (i.e., for TrueColor displays).  Added ability to save TIFF snaphot of model
view window - so Ctrl-S saves as TIFF, movies or montages can be saved as RGB
or TIFF, and one can save either a TIFF or an RGB snapshot under a specified
file name.  Also added option to the File menu to set the file counter to
zero.

Dec. 10: Fixed tif2mrc so that, running on either the PC or the SGI, it
can correctly convert byte, integer, and RGB tiff files originating on either
kind of machine.  Also made mrc2tif work for byte, integer, and RGB files
originating from either machine.

Dec. 11: Made Blendmont work properly on the PC, by implementing an include
file to provide the system-dependent parameter needed for specifying the
record length in the edge function files.  Implemented byte swapping so that
Blendmont on the PC can use existing edge function files written on the SGI,
and vice versa.

Dec. 12: Fixed problem in Imodmesh that was making it create glitches on PC
when joining contours on the same section.  Made it have a default resolution
for point reduction of 0.25.

Dec. 12: Put in two hacks to keep contour-fill in model view from crashing the
program on the PC, when there are colinear points at start of contour and when
the contour crosses itself.

Dec. 13: Fixed Imod bug in which contrast-floating on a section with no image
crashed the SGI.

Dec. 15: Installed new midas, a successor to manali that adopts all the
important functionality of the old midas, has new features such as ability to
zoom down large images and ability to hold a limited number of images in a
cache, and has a new set of controls and menu entries.

Dec. 19: Premature sync to new version for 2.41.

Dec. 21: Made Addtostack set the header sample and cell sizes the same as
the image size because some people are using it to compose an image stack from
files converted from another format.

Dec. 21: Changed modeling cursor to include tails on ends to make it more
visible.

Dec. 21: Implemented rubber band feature in zap window for selecting a desired
area, ability to take snapshot of or get info about the rubber band area, and
ability to resize the zap window to either the full image size or the rubber
band area.

Dec. 22: Implemented ability to read TIFF files using system-supplied
library libtiff.so, including byte, 16-bit integer, or RGB files, with
intensity scaling and loading of subsets.  Images cannot be flipped.
Compressed files can be read depending on capabilities of the system library.

Dec. 22: Implemented ability to load and display color (RGB) files, either MRC
or TIFF (but not SGI .rgb files).  Added a new -G option so that RGB-mode MRC
files can be loaded in gray-scale as before if desired.

Dec. 24: Changed Imod code to eliminate all non-suppressed warnings when
compiling for debugging.

Dec. 24: Made intensity scaling use lookup tables for byte and integer loading
into Imod, which improves loading speed ~40%.  Had the lookup take care of 
byte swapping too, so that there is no penalty in loading a file that needs
byte swapping.

Dec. 25: Added option to run image movies in imod in one direction instead of
forward-and-back.

Dec. 25: Fixed some problems with the way clip was resetting the cell and
sample sizes after cutting out a subvolume.


================================================================

Version 2.40 includes changes required to get almost everything running on a
PC under Linux.  There are lot of changes here, and dates were recorded for 
only a few, so the dates have been omitted.  Changed are listed in three
groups, and in each group ** marks items of most interest to average users,
and * marks other items of likely interest.

CHANGES IN PROGRAMS OTHER THAN IMOD AND IMODMESH

** All C programs can now automatically swap bytes if necessary
when reading from image files.  Fortran programs already had this capability
when reading from VMS files, but have now been configured to swap IEEE
floating point numbers instead.  All image files are written in the native
format of the particular machine.  This means SGIs and PCs can be used
interchangeably to create and read from image files, transparently to the
user.

** Mtk: Implemented ability to measure distances of closest approach in 3-D
between any combination of spherical items, extended lines, and meshed
surfaces, compute approximate density curves as a function of distance, and
assess the statistical significance of such density curves.  (Man page not
updated yet).

* Install script: added entries for installing man pages, fixed the statement
for IMOD_PLUGIN_DIR to used setenv instead of set.

* Subm alias: fixed and enhanced the recommended alias for "subm" in 
the "Guide to Tomography".

* Implemented system-independent ability to access files bigger than 2.1 GB in
both the Fortran and the C code, which should work as long as the operating
system supports large files.

* Changed Edmont so that it will renumber output sections sequentially from
zero, change Z coordinates in the extended image header, and work
with montaged image files without separate piece list files.

* Clipmodel: made it work correctly with index coordinates from the last image
display, work properly with models built on flipped stacks, report the
length of cut edges, and treat open and closed contours and scattered points
separately in appropriate ways.

* Tilt: had it write the header periodically, so that one can use imod to
examine a tomogram while it is still being built.

* Changed Subimage so that it can put differences between lists of
sections into a single output stack.

Copytomocoms: Fixed bug that made it crash when setting up command files for
data from "film".

Combine.com: fixed entries for using matching model files for initial
registration. 

Made Tif2mrc set all the header sizes to the same values, which was needed to
keep beadtrack from failing.

Made Clip flip all of the header sizes when flipping an image stack.

Rewrote mrcx to translate back and forth between SGI and VMS, and between PC
and SGI, so that once programs are built to swap between SGI and PC, there is
still one program that can deal with VMS files.

Implemented a faster algorithm for testing when a point is inside a contour,
and modified the scan contour conversion function to avoid many function calls
and mallocs; neither improvement speeded up imodmesh much.

Reworked the code for byte-swapping when reading and writing model files to
avoid function calls on each item; although little-endian machines are still
second-class citizens in this regard, the speed differential is now less than
a factor of two rather than a factor of 12, and byte-swapping time is now
trivial from a user's perspective.

Many changes were required to the Fortran programs to eliminate VMS extensions
unsupported by the g77 compiler.  Principal ones were replacement of ENCODES
with internal write statements, elimination of the convenient use of
structures for linear transformations, parameter statements without
parentheses, elimination of "carriagecontrol", "readonly" and "shared"
attributes when opening files, removal of "$" from common names, and a
thorough conversion of "type" to "print".  Small libraries were added to
provide trigonometric functions using degrees, and to provide calls to the
C-standard random number generator.

Stopped clip stat from trying to rewrite header with new min/max/mean.


CHANGES IN IMODMESH

** Implemented ability to store high and low resolution meshes.

** Implemented ability to handle inside contours to any level
of nesting, and to make proper transitions from an annulus to a horseshoe
shape.  Added automatic multi-point capping for elongated contours, and the
ability to use a looped-back contour to form a more complex cap.
Distinguished between open contours in open objects and "horseshoe" contours
that are open contours in closed objects, so that outside surfaces would be
defined properly when meshing between open contours in a closed object; fixed
problems with meshing between open and closed contours.  Allowed multiple open
contours to be present on a given slice, and had it join the most closely
associated pairs of such contours instead of joining all open contours to each
other.  Added the ability to mesh open contours by surface number also.

* Implemented the percentage overlap option, and fixed a
bug that had eliminated ability to mesh at z intervals greater than 1.

* Made it able to evaluate the appropriateness of joining two
contours on the same section by making sure there was overlap in the joined
region with a contour on the adjacent section.  This removes the proximity
requirement for contours to be joined.  Made it find the closest approach
between two contours even if it is in the middle of a long line segment, which
can happen with point reduction.  Made it handle tubules emerging inside an
inside contour.  Improved the code for finding the transition from donut to
horseshoe.

Fixed bug that kept imodmesh -S from working (meshing by surface) if
any surface was empty.

Fixed bug in the handling of open contours in a closed object that
only showed up for contours going in a certain direction.  When an open
contour is joined to a closed one in the same section, made sure that the
joined contour inherited the openness and endpoints of the open contour, so
that it would mesh correctly.

Switched to using qsort and bsearch in imeshReMeshNormal.


CHANGES IN IMOD

** Implemented low resolution meshes that can be toggled to in imodv.

** Rationalized concepts for inside-out contours, two sided lighting,
open or horseshoe contours, and the contours needed for making complex caps.
Made the "Closed Options: IN - OUT" buttons read "Front Surface: Outside
-Inside", and made imodmesh reverse the direction of the skins when the
Inside option is selected.  Added two-sided lighting as an object display
option.  Added a menu entry Edit-Contour-Loopback to create a complex cap.
Changed help text appropriately, and explained the proper meaning of open
contours without referring to "horseshoes".

** Added size-dependent resolution for point display in imodv, limited
the sphere drawing quality to 4 levels, and added a low resolution mode as
well.

** Multiple image files: Added the ability to enter several image files on the
command line, which are then treated as images at separate "times", just as if
the files were listed in an image list file.

** Allowed files of different sizes to be displayed from an image list or
multiple entries on the command line.  The displayed size of the minimum of
the various sizes in each dimension.

** Loading of subsets of cached images: Fixed all of the problems involved in
loading subsets with the -x, -y, or -z flag, with all kinds of cached data,
namely montaged or piece-list data, regular files loaded with -C, and multiple
files entered on the command line or in an image list file.

** Flipping of images and models: Fixed problems with flipping on all kinds of
data, so that any kind of loaded data, including subsets, can be flipped on
startup with -Y or while the program is running.  If a model built on a
flipped image stack is loaded without an image, then saved, its flipped
character is now properly preserved.

** Added a montage maker to the model view movie maker, so that one can
automatically take snapshots of overlapping, zoomed up displays of the model.

* Made rgb's saved from Imodv have 4 digit numbering.

* Added ability to give a filename for an rgb snapshot from Imodv.

* Changed the Edit-Object-Color window so that Cancel will restore the color
that the object had before the window was invoked, and so that color is
changed and the model redisplayed when the user drops the slider if running
with an rgb visual.

* Made keyboard input go back to the Zap window after a new number is typed
into the section number or zoom text box.

* Made zoom 1.5 display with true interpolation if the high resolution button
is on.

* Made the filename be the default time label for an image entered in an image
list file; a TIME entry overrides that.

* Imodv: eliminated duplicate model display on startup, and triple model
display when going into stereo, although it still displays 2 or 3 times when
leaving stereo.  Also eliminated some duplicate model displays when the model
is moved or rotated with the mouse, and when a new model is read into imod.

* When a new model is read into imod while the imodv window is open, the new
model is now properly displayed instead of the old one, and disaster is
averted.

* Added Edit-Contour-Fix by Z to allow one to break a closed contour that had
accidentally been drawn on more than one section into one contour per section.

* Added Edit-Contour-Fill In.  For an open contour that moves in Z and doesn't
have points on every successive Z slice, the program will fill in the gaps in
Z by interpolation between existing points.

* Auto contouring: recoded the searches for pixels inside and outside the
flooded area to use a ring buffer instead of recursion, which was going too
deep for the PC and was very slow.  Added protections in case the image is
flipped when the auto window is auto.

* XYZ window: Rationalized the display of the current contour with that of
other contours.  Had it manage and use the "wild" flag correctly, and display
open or closed contours correctly if they were on more than one section.
Fixed an error in model positioning on the X/Z and Y/Z panels when zoomed up
or down.  Limited the size of the window to the size of the screen, and set it
up to find an initial fractional zoom that would make the window fit in the
display.

* Doubled the Z-extent of the clipping box in imodv; it is now 10 times the
lateral extent of the window.

* Implemented Edit-Model-Clean to delete all empty objects.

* Added option to preserve point sizes of points with the default size in a
scattered point object, when moving contours to another object.  

Fixed bug that kept the window for choosing a model from opening a second time
if it was closed with a cancel.

Fixed truncation bug in using the left mouse button to increment the
Z scale slider.

Fixed bug when reading piece coordinates from image header
(failure to allocate memory for coordinates).

Extirpated the horseshoe flag from icont.h and switched all references
from it to ICONT_OPEN, which was already defined to have the same value.

Time labels in zap window: had it make the toolbar long enough to fit the
longest label.

Made current directory changes work properly when using an image list file
that is not in the current directory.

Movieing in model display: Revamped movie logic to eliminate interlocked
time-outs and workprocs, and to use just a workproc after the movie starts.
This may prevent its occasionally falling into a CPU-intensive coma.

Added a "Save Model" button to the view editing window to make it clearer that
saving is needed to really store a view.

Fixed bug that kept the line tracker from working if it was opened while the
image was still loading.

Fixed bug in time output when model file is saved.

Fixed bug that crashed imodv if the command to open the object list window was
given twice.

Fixed bug in which the Edit-Contour-Move window had the wrong number of
objects when it first started.

Fixed bug in coding of menu acceleration keys.

Eliminated CTRL-S as a hot key for saving the model from imodv; this will 
eventually be used to make a tiff snapshot.

Found out how to constrain the geometry of the Imodv-Edit-Objects window so
that it reopens at the right size for all menu panels on the SGI, and doesn't
do weird expansion of the top-most panel on the PC.

Set the widget attachments in the slider window so that the sliders wouldn't
become half as small when the window was resized on the PC.

Tumbler window: implemented proper "traversal" so that keyboard input would
always work; fixed some problems with intensity scaling and made it update
when contrast sliders changed; tried to speed it up by eliminating function
calls to fetch pixel data; fixed problems caused by failure to initialize
angles.

Fixed problems with initial setting of some buttons in auto window and depth
cue window.

Slicer: to clear the lower-left part of the window when zoomed up at
low-resolution, switched from pixel draws, which crashed sometimes, to a box
clear.

Slicer: fixed display of the red slice in the graphic cube to work at all
zooms and for high as well as low quality.  

In Edit-Contour-Move, disabled the option to replace a contour with a single
point if the contour consists of scattered points.

Eliminated ghost display in the zap window for scattered points or for
contours that are not all in one Z-plane; made open contours show up as open.

Made sure that all dialog windows are closed properly when the model view
window is closed, so that they can be reopened again.

Made the object color be set in the info window when a new model is read in.

Major changes were required to get image display to work with TrueColor (rgb)
rather than PseudoColor (color index) visuals, since the PC did not support
Pseudocolor.  All image displays now handle both kinds of visuals.  The
contrast sliders are handled a little differently, so that the number will
be displayed as the slider is dragged, even though the image is not
redisplayed in rgb mode until the slider is dropped.  Modification were also
needed to prevent double image display with an rgb visual with the float
button turned on.



================================================================

Version 2.31 is a minor release, mostly with changes in programs other than
Imod:

SOLVEMATCH: Implemented ability for Solvematch to start with a small
subset of known correspondences and find the rest.

FENESTRA: Fixed problems with Fenestra so that it can handle openings
facing anywhere in the X/Y direction. 

TILT: Speeded up the Tilt program by eliminating boundary checks from
inner loops: it is about 2.7 times faster without X-axis tilting, 3
times faster with X-axis tilting, and 1.8 times faster with local
alignments.

INTERPOLATION: Speeded up the interpolation routine used by Newstack,
Tiltxcorr, and a few other programs by eliminating boundary checks
from the inner loop, and substituted cubic for quadratic interpolation
with no loss of speed.

JOINING TOMOGRAMS: Wrote shell scripts and guide for joining tomograms
from serial sections.

3-D DISTANCES: Generalized code in Mtk to analyze 3-D distances
between any combination of points, lines, and meshes (Man page not
updated yet).

Here are changes in Imod itself; dates are 2000.

Jan 31: fixed bug in edit-object-clean; needed to run loop backwards.

Feb 1: fixed bug in scan contour conversion that gave improper connections in
imodmesh.

Feb 2: fixed problem with high quality and regular mode not being distinguished
in double buffering with fractional zooms.

Feb 9: Made left mouse button clicks on Go To Surface slider skip across empty
surfaces just as the up and down arrows do.

Feb 9: Fixed problems with picking current point with the right mouse button
when displaying subsets (e.g. current surface) in imodv window.

Feb 10: Fixed problems with new version of scan contour conversion, handling
cases where the contour reduces to only two points or to a single horizontal
line.

Feb 29: Fixed bug that crashed imodmesh when connecting across skipped
sections.

Mar 2: Fixed bug that crashed imodjoin when no object list given for second
model.

Apr 20: Added time output to report in info window when a file is saved or
autosaved.

Apr 20: Fixed bug so that new Y and Z size would appear right away after
flipping an image.

Apr 21: Added menu entry to fix a closed contour that goes across sections by
mistake by breaking it into separate contours, each in one Z plane.  Changed
point adding with middle mouse button so that a new contour would be started
(with warning) even if existing contour has only a single point.

================================================================

Version 2.30 includes many changes in programs other than Imod:

IMODMESH: Fixed bugs with meshing of open contours as tubes.  Eliminated some
inefficiencies and recoded to alleviate quadratic increase in execution time
with increase in the number of contours, so it is now 20-30 times faster with
very large models (~10,000 contours/object).  Eliminated duplicate storage of
meshed model to save memory, but there is still a memory leak somewhere.

TILTALIGN and TILT: implemented local tilt alignment and ability to generate 
a reconstruction using these local alignments while correcting for a small tilt
around the X-axis.

MIDAS: this mixed Fortran/C program, ported from a Vax, is a predecessor to
manali that allows mouse control of shift, rotation, and stretching as well as
some other convenient features.  It is now included in the distribution, until
manali is modified to incorporate MIDAS's desirable features.

BLENDMONT: Revamped the code for blending information where 3 or 4 pieces
overlap so that there would be smooth transitions from these regions into the
regions covered by 2 pieces or 1 piece, especially with a sloppy montage.

TOMOGRAPHY: Included revised master command files and shell scripts for 
generating command files for a particular data set.  Improved procedures for
combining two tomograms obtained from tilting around two axes, including
automatic use of warping where necessary to obatin a good fit.  Made the
latter procedure easier for users to run without editing the command file.
Revised the tomography guide and made a new, up-to-date HTML version with links
to all man pages.

FORTRAN PROGRAMS: Updated all programs to allow model sizes of 5,000,000
points, image sizes of at least 2K x 2K, or larger in some cases, and filename
lengths of 80 characters, and to have "print" statements instead of
non-standard "type" statements.


Changes to Imod itself are listed next; dates are generally 1999, with most
undated entries made in December 1999.

Dec 28: fixed bug that made slicer crash when zooming down below 1.

Dec 28: fixed bugs in routines for reading Y planes from integer or float
files, so that cached data may be flipped.

Jan 18: Fixed bug in slicer multiple-slice display with zoomed-up high-quality
mode so that the correct number of slices would be summed.

Feb 15: Added ability to have a size value for each model point, which
controls the point display size for scattered points.  Added ability in
Contour Move window to convert the current contour into a single scattered
point of the equivalent area.

Feb 15: Made sure wild flag was set properly when reading in a model without 
an image.

Feb 16: Changed bead fixer plugin so that it could go to one series of
residuals after another in the log file from a local tilt alignment.

May 29: Changed high-res mode in the zap window so that when one pans with the
mouse, it drops into low-res mode while moving.

Aug 12: Made the Move buttons in IModv object edit window operate on all
models, not just current one.

Aug 12: Fixed bug so that zooming down from an entered, fractional zoom, goes
to next fixed zoom; and prevented negative zooms from being entered.

Changed high-res mode in slicer so that it only interpolates once per actual
pixel, forms a projection of multiple slices at these pixel positions, and
then uses cubic interpolation to make the display image.

As another speed trick, slicer was given its own routine for fetching data
from the cache, so it could look up all slices by Z value in advance of
getting each pixel.

Adjusted coordinates of a mesh when reading in a model on a subset of the
image, so that the mesh and contours would display at the same position.

Made sure the wild flag was properly maintained when breaking or joining
contours or deleting points.

Fixed problem of zap window not popping up without a mouse event after startup.

Fixed bugs in autocontouring (Next button not working right, Build without a
filled area hung program), and made it generate multiple contours if the
filled area is no longer connected after a shrink operation.  Also switched
to a point-reduction routine as is used in imodmesh (-R) and the line tracker.

Fixed problems with using slicer to view multiple flipped tomograms, and made
sure the cache was set to an appropriate size when flipping cached data.

Made it update the info window properly when doing auto-section advance after
adding a point.

Made Object Move and Contour Move be able to remember two different
target objects.

Revamped the handling of surfaces.  Instead of having a slider control surface
number of current contour, one changes surface number of an existing contour
only by moving it to a different surface in Contour Move.  Provided arrows
and hot keys for moving to the next or previous contour within a surface or
to the next or previous surface in an object, and a slider for going to a
selected surface.  The Contour Move window allows one to move contours to
either a different object or a different surface.  Added help text
to make it clear what happens to surface numbers when copying.
Added Edit Surface Move, Go To, and New menu entries.

Implemented an Object List window in Imodv, containing the name and number of
each object and a toggle button to turn it on or off.

Added a Subsets panel to the Imodv Edit Objects window to provide a way to
display just the current object, surface, or contour in the model view window.

Added numbers to the Near, Far, and Perspective sliders in the Imodv Edit
Controls window.

Fixed bug that crashed program when a piece list specified Z coordinates not
starting at zero.

Added ability to read piece coordinates directly from the image file header
for montaged data.

Made left mouse button click far from a model point in model mode update the
slicer window position.

Made hot keys to align a line between first and last points in contour to the
X, Y or Z axis in slicer.

Made it take current section as reference for floating when the float button
is clicked on.

Made Contour Join preserve all points in both contours if joining scattered
points.

Added Edit Object Clean to delete empty contours.

Added Edit Contour Invert to invert the direction of a contour.

Fixed rounding error that kept left mouse clicks from being able to increase
Near and Far sliders by one in Imodv Control window.


Version 2.20 includes the following changes (all 1998):

July 21: Imodv object edit: when turn on an object with its check box, it
becomes the current object for editing.

Aug 19: imod_cont_edit.c, made char array longer for the description of the 
selected point, stops program from crashing when start contour join.

Aug 19: For contour joining, made sure the current point and contour after the
operation was the first point after the join.  For open contours, made it join
things sensibly when set 1 is the start of a contour and set 2 is the end of
another contour, instead of wiping out all but 2 points.

Aug 19: Fixed bugs in auto-section advance and setting of the wild flag (which
keeps track of whether a contour is in one Z plane) when points are being
inserted before the current point.

Aug 21: Fixed bug in initialization of wild flag - it had to be scanned for
after flipping model, and regardless of whether model is read in initially or
via the menus.

Aug 28: Fixed bug that caused crash when doing Edit-Object-Move.  Label data
or lack thereof was not being copied correctly, when contours were moved.  Also
fixed bug if try to move contours to the same object that they are in.

Sept. 17: Joining contours: eliminated error message when contours not in same
object, added error message if a set point is past end of contour.

Oct. 24: Added Window and image size and coordinate output to Zap hot keys.

Oct. 26: Truncated filenames in Imod info window to keep it from getting huge.

Oct. 26: Added sorting points by Z value and clarified menu and help with
regard to the original "sorting by distance".

Oct. 27: Set model checksum before image load, so that if the user quits
during image load, it no longer asks whether to save the model.

Oct. 28: Added a kludgey system call to find out how many imods are
running on the machine and pick the colormap based on that.  Also increased
spacing between colormaps from 300 to 330, to allow up to 74 objects without
interference between colormaps.

Oct. 28: Added a Stop button to the imodv movie maker.

Oct. 31: Added the movie controller window to adjust limits to display during
a movie, and to control the frame rate.  Made the rate change in geometric
steps and modified the time-out code so that the rate would be independent
of display time (until display time becomes the limiting factor).

Nov. 1: Fixed problems related to the Model Edit window and the display of
multiple models.  Rearranged the sequence of calls for setting up model
transformations and screen properties, so that multiple models could be
displayed properly in mono and stereo and manipulated together or
independently.  Fixed code related to editing models and objects in tandem
in Edit Objects and Edit Controls menus.

Nov. 2: Fixed depth cueing by shifting the model back in Z before projection
and implementing sliders for start and end distances.

Nov. 3: Fixed model rotation so that all rotations of the model or of the
object clipping plane will be with respect to the viewer's coordinate system
rather than the model axes.  Mouse movement will always cause a rotation
about an axis perpendicular to the direction of movement.

Nov. 3: Clipping plane adjustment is now much easier.  Also made clipping
plane come out in the middle of the object the first time it is turned on.

Nov. 4: Deleted unused and obsolete functions or code options related to
model display, including code that used the GL matrix operations to
compute transformations (the WORLD_ON flag options).

Nov. 4: Added Full 360 X and Y buttons to the imodv movie maker, to give
true rotation about those axes.

Nov. 4: Made , and . control rotation increment (and speed) in imodv.

Nov. 4: Added bell when there is an error saving a file.

Nov. 4: Eliminated resyncing (panning) display to current model point in the
zap window when changing section.  Also changed arrow keys in model mode so
that they pan image instead of moving "current mouse point", and made an
exemption to resyncing for this too.  Also prevented resyncing when turning on
model mode.

Nov. 5: Fixed code that referenced model coordinates to the coordinate
system of each image file, so that models will display correctly when a subset
of the image file is loaded, or when the image scale or origins are changed.
This works on flipped and unflipped image volumes.  Implemented a new bit in
the flag that is saved with the model, which indicates that tilt angles were
stored with the model.  Thus a model will display correctly on a subset volume
that has been extracted and rotated with ROTATEVOL.

Nov. 5: Fixed bug that kept time labels from displaying in Zap toolbar.

Nov. 11: Fixed bugs in image processing window so that Apply always works on
the original image and the original image is changed only if Save button is
pushed; added a More button to apply an operation to the current, already
processed image.

Nov. 11: Changed help dialog windows to be top level shells instead of
dialog shells so they wouldn't be parked if the IMOD infor window is parked.

Nov. 11: Fixed F9 and F10 to switch between colormaps, fixed initialization
of additional ramps, and made F10 cycle through the 4 maps instead of just
selecting a second one.

Nov. 13: Implemented a contrast "float" feature which adjusts the sliders
according to the mean and standard deviations of each image to maintain
constant brightness and contrast through the stack, just as if the images
had been floated to mean in newstack.

Nov. 13: Fixed bug, to allow XYZ input specification in image list file.

Nov. 13: Allowed a new model to be opened under a file name given on command
line when the file is not found.

Nov. 14: Had the imodv movie maker resolve the change in rotation into a
rotation around a single axis and rotate by regular increments around that
axis; made zoom change by a factor instead of an increment; added a reverse and
a "long way around" check box; made dialog box smaller.

Nov. 18: In imodv, had it set the menu lighting flag based on the value of the
lighting flag in the initial model view.

Nov. 19: Made Zap window set up cursor correctly if it is opened in model mode.

Nov. 19: In the movie routine, had it flush and process events after each
display, so that the movie will not be unstoppable when loading cache.

Nov. 20: Fixed transparency - seems to work on all SGIs.  Fixed code for
assessing whether there are alpha planes.

Nov. 21: Got the "throwing" feature working: when the model is movie-rotating,
moving the mouse while holding down the second button will start it rotating
in the given direction when the button is released, with a speed proportional
to the distance moved.

Nov. 26: Fixed bug in saving and restoring clip planes in stored views.  Also
made sure that a shifted but unrotated clip plane that is turned off will be 
saved in model file.

Dec. 1: Kept slicer from crashing program if started up while movieing, and
improved the fix for keeping the XYZ window from crashing it also.

Dec. 1: Discovered hot keys for changing depth of model or image display in
slicer, made them update the text displays of these values, and documented
them in the help display.

Dec. 5: Got slicer to pass keyboard input to the window after using sliders or
other controls; programmed numeric keypad keys to change the last adjusted
angle by 0.1 or 0.5 degrees or set it to zero.

Dec. 7: Made slicer use the same zoom steps as the zap window, including
zooming down below 1.

Dec. 10: Fixed bug in image scaling when non-byte images are read in with
an image list file; made intensity floating and image scaling/reloading
work properly with multiple times.

Dec. 10: Made Graphing along a contour keep track of distance properly, and
work properly in 3-D.  Restored G to open Graph window.

Dec. 10: Miscellaneous fixes while updating man page and help screens:
eliminated R to reload since it no longer worked; added i in Zap window to
toggle modeling direction; made sure info window is updated when switching
to an empty object with o or p.

Dec. 11: In slicer, inverted the sign of angles, and allowed Y and Z angles to
go from -180 to +180 degrees, so that all possible orientations of the volume
can be achieved.  Added hot keys to rotate so that the current and previous
model point are oriented along the X, Y, or Z axis.

Dec. 13: Made changes to ensure accurate modeling in the slicer.
Reworked coordinate calculations in slicer so that the low resolution
image will display as close as possible to the high quality image and so that
positions picked by the mouse will be converted accurately to image volume
coordinates.  Made it use fractional Z values for the center of the display
when inserting or moving a point in model mode, so that one can model within
a slice without the slice changing progressively due to truncation of Z
values.  Made image and model display work accurately with Z-Scaling both
before and after slice rotation.  Expanded help display.

Dec. 14: Cleaned up code in slicer; eliminated single-slice display and made
multi-slice routine work properly for single-slice case.

Dec. 14: Made middle mouse drag add points to contour properly, regardless
of insertion direction or whether at the end of the contour.

Dec. 16: Set color ramp and sliders correctly when reading in a model through
the menus.

Dec. 17: Made left mouse click work properly for sliders in contour move and
depth cueing operations.

Dec. 19: Made images with piece list Z values not starting at Z display
from the lowest to the highest Z value instead of from absolute 0 Z.  Had it
subtract the minimum X, Y and Z coordinates in the pieces from the model
offsets so that models would display correctly when moved from one stack to
another as long as piece coordinates correspond between the two.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Version 2.10 is the first version that David Mastronarde released.  It includes
the following changes:

Saving RGBs: fixed bug in which it was saving the back buffer instead of the
front.  On Octane, it would always return an image whose X size was a multiple
of four, so as a the workaround to this system bug, the X dimension is rounded
down to a multiple of 4.

Model display in imod, using right mouse button to pick a new current point:
Fixed bug that caused crashes.  Made buffer much bigger to handle models with
more points.  Had it pick the front-most point within the box around the
cursor.

File names on windows: add a line in the Info window to hold the image file
and model file names, so that info windows from multiple imods could be
distinguished.  Made sure names were maintained properly as different model
files were read; added model file names to various imodv windows as well.

Help windows: made the code properly count lines of help text as they will
be displayed with 80-column lines and word wrap - so now windows are opened to
the right size to see all of the text.

Added numbers to the sliders in the imod Edit Object Color window, and to
various frames in the Imodv Edit Object window, i.e. Line Color, Fill Color, 
Mesh View, and Material.

Imodv Edit controls: zoom down arrow was zooming it down 10-fold; fixed this. 

Fixed the bug that kept the proper colors from being displayed in the
colorpanel in the Imodv Edit Object window, and made this panel change
dynamically as sliders were moved.

Put in workaround to system bug that made the upper frame of the Imodv Edit
Object window expand in height whenever the object # changed between 1 and 2
digits.

Fixed bug in Edit Image Reload function, reorganized window and rewrote help
text to make it clearer, had it calculate scaling limits that would preserve
current contrast with sliders moved to 32 and 223, added featured to
recalculate these settings based on a new current contrast.  So, the window
can be used to easily back off on contrast for an image that comes in with too
much contrast.

File saving: made it rename an existing file as backup if one does a SAVE AS
with an existing file name (previously it would just blow away the earlier
file.)  Added a temporary "double-backup" system in case of errors in the
saving operation, so that an existing file and its backup would be retained.
Made it clean up autosave files scrupulously when the model file name is
changed.

Expanded help text for new features and fixed a few mispellings - a chunk of
work could be done on this overall.

Stereo on Octane: fixed bug that was introduced by making it return from
stereo to full screen size.  Rationalized code so that it set fallback
resources, set up default resources, read resources from the system
properly, and used the proper variables to enter and leave stereo.
Made sure this worked on all machines in both imod and imodv.  Still needs
major cleanup.

Made stereo window move to top of screen if it was going to go off the bottom,
made it shrink in width if >1280, and move to left if it was going to go off
left side.  Had stereo image appear at same effective zoom as mono window
(needs more work - some models now zoom down by 2).
Changed default stereo angle to 5 degrees from 3, appropriate for viewing from
70 cm away.

View selection in the Move frame of Imodv Edit Objects: added 6 buttons and
organized in columns so that one can move through a series of views with
rotation about a single axis.

Color selection for objects past 12: fixed bug that was cycling only through
red and giving the same green and blue each time.

Fixed bug in false color map at index 64.

June 23: In dia_sgicolor.c, used a flag to keep track of color allocation,
rather than the pixel value, because the latter came through as zero for a
black background when running imodv and setting background color.

June 23: In imod_menu.c, fix bug in Edit Object Move to actually move all
contours.

June 23: Fixed scattered point display in zap window; size is now properly
based on size of the circle for a sphere cut by the given plane.

June 23: Made all calls to mrc_read_byte save the header before and restore
after.  This was required for pixelview to read ints and floats correctly, and
for pixelview, graph, and who knows what else to read data from file correctly
when a subset of the image file was loaded in.  This will probably break
something else.

June 23: Fixed bug to make current point marker come out in the middle of the
pixel.

June 24: mrcfiles.c: add extra header size regardless of file creator flag.
Now imod can read all MRC files with extra headers.

June 24: Implemented direct report and control of model view scaling with an
edit field in the control window.  Also fixed the problems of rescaling when
going into and out of stereo.

June 24: Made the mousemode flag in xzap be a member of the zap structure
so that the mouse changes in all zap windows when going to model mode.

June 25: Fully implemented the ICONT_WILD flag so that each contour in the
model is scanned when a file is read in, and the flag is set for contours that
don't stay in a z-plane.  Then, the flag is set when a point is added or
modified that does not match the z-plane of the first point.  Now closed
contours that cross sections display correctly, and open contours that do
not cross sections can be skipped over rapidly as well.

June 25: Fixed bug in automatic starting of new closed contour and prevented
starting a new one if there is only a single point - but gave a warning in
this case.

June 25: Implemented a "smart" centering in the zap window: recentering occurs
only if the point is within 10% or 50 pixels of the edge of the window.  Added
control button to zap toolbar to switch between this and full centering, and
reduced the lock button to simple lock-unlock function.

June 25: Implemented auto section advance that goes in the direction of the
last two model points, or doesn't advance if the points were on the same
section.

June 25: eliminated confusing display of current point off-section when it is
the only point in an open contour.

June 25: Fixed reading of piece lists so that the number of items in the list
can be less than the number of sections in the file.  Eliminated both X and Y
offsets from piece list coordinates because they were not being dealt with at
all, and made sure that positive or negative offsets in Z were properly dealt
with.

June 25: Changed the computation of model checksum so that small changes would
not be lost.

June 25: Fixed bug on reading in a new model into imod when there is no image
being displayed ; had to have it skip transforming the model.

June 25: Had it compute a model checksum when initially reading an image file
descriptor, so it wouldn't ask whether to save the model after no modeling.

June 26: Substituted a false color table with a slightly broader range of
colors and better contrast resolution over the whole range.

June 26-27: Added ability to save object characteristics as part of saved
views in Imodv; the information is also saved in the model file with backward
compatibility, so no new model version is needed.  Revamped the logic of the
Edit Views window so that there is an "Original Default View" and not an empty
"View 1"; made the title of the selected view display properly in the edit
field and made sure that a view could be selected with either "Goto View" or
double clicking on the title.  Rewrote the help text.

June 27: Rationalized model scaling so that it would come out the same for
each of the various paths through which a model can be displayed.

June 29: Fixed a bug that caused lighting to be turned off the first time one
switched off double-buffering.  Could not find out why there was an extra
expose event and extra redisplay when switching buffering.

June 29: Added checkboxes for all model objects (up to 48) in the Imodv Edit
Objects Window, to make it easy to turn selected objects on and off.

June 29: Made it so this if one switches display type from contour to mesh, and
display style is line, it will switch automatically to fill; and similarly
fill will go to line when going from mesh to contour.

June 30: Fixed another bug in the selection of new colors for objects beyond
12, and set it up so that the new colors would be based on a fixed cycle of
values rather than on previous object.

June 30: Made Save Model and Save As in Imodv save the previous version as
backup instead of blowing it away.  This is not as elaborate as the backup
features in the imod main modeler, but it's a lot better than no backup.

July 1: Eliminated a few items from the Zap keyboard input list, augmented
the zap help window with complete toolbar and special hot key listings,
revised main hot key and menu help windows, moved Process from
Image to Edit Image menu, and moved Pixel View from Edit Image to Image menu.
Updated the imodv help windows also.


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Version 2.02 is the last version that Jim Kremer produced.

Version 2.00
	- Fix bug that caused 2d Cross-correlation on non-square images
	  to report bad peak values.
	- Added ability for imodmesh to skin a range of z values.


Version 2.00b7 March 11, 1997
	- Fixed some bugs with 8-bit displays.
	- Added rgb type to the raw2mrc program.
	- Fixed major bug in imodmesh that caused bad skins to be made unless
	  the -T option was given.
	- Fixed hardware stereo-rendering on SGI's for imodv.
	- Fixed bug that broke model view when imod was started with no image.
	- Added model mesh functions to the imod software developement kit.

Version 2.00b6 Jan 23, 1997
	- Fixed display of sections with negative Z values.
	- Centered 3D spheres properly in zap window.
	- Slicer window now updates colormap properly.
	- Moved lighting and depth cue in imodv from object edit to
	  the View menu in order to make the effects global.
	- Fixed single buffer, near, far and perspective controls in imodv.
	- Made imodv views dialog usable.
	- Made fixes for building on DEC alpha.
	- Fixed core dump on clip functions brighten, contrast, edge,
	  resize shadow and average.

Version 2.00b5 Sep 19, 1996
	- Fixes to imodv: cindex mode, movie, background, stereo.
	- Several fixes to the manali program.

Version 2.00b4 Sep 6, 1996
	- Added picking of contours in model view window.
	- Added plugin module support.

Version 2.00b3 Aug 23, 1996
	- Several fixes for machines with 8-bit graphics.
	- Fixed contour copy and join bugs.

Version 2.00b2 Aug 9, 1996
	- Several Bug fixes.
	- Multiple zap windows can now be opened.
	- Rendering at 1.5x magnification optimization.

Version 2.00b1 Jul 19 1996

	- Enhanced zap window tool bar.
	- Fixed OpenGL network display bug.
	- Fixed window resize bug that cropped up on some systems.
	- All programs now use shared libraries.
	- Added Hardware support for StereoGraphics eyewear for SGI's.
	  imodv can now render models using hardware stereo.
	- Updated manual pages.

	Some new experimental features are added:
	- Added image cache; Imod can now display large serial section
	  data sets, limited by drive space, not memory.  
	- Added image piece lists for serial sections.  Now imod can
	  load montaged data sets, and skip missing sections of data.
	  Added image time lists for viewing time series 3-D data sets.	
	- Limited support for 4D data sets. Data sets that contain	
	  time data as well as x, y and z.

Version 1.21a (For Irix 5.3 Only) Feb 1996 :
	- imod does all rendering in OpenGL. imodv and imod are now the
	  same program.
	- Fixed bug in imodv that slowed rendering down.
	- Added more contour info to imodinfo.

Version 1.21 Jan 1996 :
	- imod no longer leaves #autosave# files around when not needed.
	- It is now possible to exit imod while loading files.
	- Fixed startup option bugs for imod. The -s (scale)
	  option didn't work on byte type data, and the -x & -y options
	  sometimes didn't work on short or float image data.
	- Added toolbar to Zap window in imod.  Toolbar contains new fuctions,
	  HQ graphics, Insert, Lock and Help.
	- The Z down button in imod's Information window used to move the
	  X coordinate instead of the Z coordinate. :(
	- Tomographic images can now be flipped inside of imod.
	- Improved save image performace in xmrcv.
	- Fixed bugs in the contour break and sort functions in imod.
	- New program, imod2rib, creates a Pixar RIB format model file
	  from an IMOD model file.
	- Bug fixes for imodv: Fixed scaling problem for unfilled scatterd
	  contours.  Filled contours shaped like an (8) can be drawn. Added
	  clipping planes for objects.
	- Fixed snapshot bug in imod for all image windows.

Version 1.20 Oct 1995 :
	- First release for Solaris and VMS.
	- All image windows in imod were enhanced.
	- Imodv rewritten in OpenGL/X11/Motif.
	- Fixed units reported in imodinfo.

Version 1.11 04-26-95 : 
	- Improved Skin rendering and added snapshot to imodv.
	- Fixed major bugs in imodmop and imodcmopp.
	- New program, imodmesh, added to skin contour data.

Version 1.1  03-27-95 : General bug fixes, enhanced slicer window.

Version 1.0  10-06-94 : Initial release.



Thanks to the following for reporting and/or fixing bugs.

Chris Pudney
Hossein Tahani
John Harwell

