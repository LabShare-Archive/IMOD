<head>
<title>Setting Fine Grain Properties</title>
</head>
<A NAME = "TOP"><H3>Setting Fine Grain Properties</H3></A>

This window is used to set display properties at a finer level than is
ordinarily allowed.  Properties such as color and line width can be
set for individual points within a contour, for individual contours,
or for specific surfaces.  
<P>
The radio buttons at the top are used to select whether properties are
being shown
and controlled for the current <B>Point</B>, <B>Contour</B>, or
<B>Surface</B>.  For the current item, the various controls show the
existing display properties of that item.  For each property, there
appears the letter <B>D</B> if the property has a default value, or
<B>S</B> if the property has been set.
<P>
The fine grain changes operate somewhat differently for points than
for contours and surfaces.  For points, when a property is set for one
point, its value applies to all following points in the contour until
the change in property is ended, or until a different value is set for
a later point.  Thus, when a property has a non-default value for the
current point, an <B>End</B> button is enabled to allow you to end the
sequence of changes at that point.  In addition, a <B>Clear</B> button
is enabled, which will allow you to reset that property to the default
for the whole contiguous sequence of points that have the property set.
There are two exceptions to this pattern: <B>Gap to next point</B>
applies only to the single point at which it is set, so that one can
create an opening in a contour.  The <B>Mesh Connection #</B> also
applies only to a single point.
<P>
For contours and surfaces, all changes apply only to a single contour
or surface, or to a selected group of contours rather than a contiguous set
of them.  Thus, once a property has been set, the <B>Clear</B>
button is enabled to allow you to restore the default value, while the
<B>End</B> button has no function.
<P>
Once you have set a property, the <B>Last</B> button is enabled so
that you can conveniently apply the same change to other items, for
example points in a corresponding position on another contour.
<P>
If the <B>Change all selected contours</B> checkbox is turned on, then changes
will be applied to all currently selected contours.  This feature is enabled
only when contour properties are being controlled.  You can use 
Ctrl and the first mouse button to select multiple
contours in the Zap window, where they will be drawn extra-thick.  You can
also select multiple contours using Ctrl and the
right mouse button in the Model View window (to see the selected contours
there, turn on <B>Thicken current contour</B> in the Lines panel of the
Edit-Objects dialog).  In both cases, moving the mouse while holding down Ctrl
and the relevant button will select contours crossed by the mouse.  All
properties except connection numbers
can be changed in tandem for the selected contours.
<P>
The <B>Draw dashed lines at gaps</B> checkbox lets you see where you have
inserted gaps in contours.  This is especially useful for seeing line segments
on the ends of open-type contours in closed contour objects.  Such segments
are added so that the whole contour will not cross itself or any other
contours that it is meshed with.
<P>
The <B>Draw mesh connections</B> checkbox allows you to visualize the mesh
connections that have been defined for individual points (see below).  At each
point with a mesh connection, a square will be drawn in the Zap window; the
size of the square is the assigned mesh connection number plus 4.
<P>
The <B>Go to Next Change</B> button can be used to step forward
to the next item where a change occurs.  When point properties are being
displayed, this will move the current point to the point where the next change
occurs (which can be the end of a change or the beginning of a new one).  With 
contour properties displayed, the program will move to the next contour with a
nondefault property; and with surface properties displayed, it will move to
the first contour of the next surface with changes.
<P>
If the rubberband is on in the Zap window and positioned over the
current contour, then pressing a <B>Set</B> button will apply the
property change to all the points and line segments within the
rubberband.  This feature should 
make it easy to change several properties in tandem, and to apply
similar changes on successive sections.  If any of the included points
already has this property set, then those changes will be cleared out
first, as if the <B>Clear</B> button were pressed for every point in
the range.  Unfortunately, this feature will not work on both the start and
end of a contour if the rubberband spans the endpoints of the contour.
<P>
Most property changes will show up immediately in the image or model
view windows.  However, properties that affect a mesh display will
have an effect only after being
incorporated into the mesh, and you will not see any change in the
display of the mesh until the model is saved, remeshed with 
<A HREF = "../man/imodmesh.html#TOP">Imodmesh</A>,
and reloaded.  Changes in surface properties are a potential exception
to this rule.  Ordinarily, <A HREF="../man/imodmesh.html#TOP">Imodmesh</A>
encodes surface information into the mesh
just like the lower levels of information.  However, if surfaces are
meshed separately with the <B>-S</B> option to 
<A HREF = "../man/imodmesh.html#TOP">Imodmesh</A>, then surface
properties are not encoded in the mesh.  Instead, they are applied
during model display, because in this case each mesh can be identified
by surface number.  As a result, surface properties can be changed
dynamically and visualized immediately.
<P>
A final general note before descriptions of individual properties: the
ability to make these fine grained changes in the model represents a
big change in the potential content of IMOD models.  Many programs
outside of 3dmod will ignore, discard, or garble this information
until they are modified to handle it properly.  Even some operations
within 3dmod will not deal with the fine grained data correctly,
notably sorting of points and use of the line tracker.
<UL>
<LI><B>Line color</B> is the color of lines in image and model views,
and the default color for mesh displays in model view.  Pressing the
<B>Set</B> button opens a standard color selector window.  When the
color is changed in this window, the changes are applied to the
current point or contour, not necessarily to the same item that was
selected when the window was opened.
<LI><B>Fill color</B> is the color used for displaying filled meshes
when the <B>Use fill color</B> option is selected in the fill color
panel of the model view Object Edit window.  For spheres, changes here
will show up immediately when either this option or <B>Use for
spheres</B> is selected; but for other meshed items, the changes will
not show up until incorporated into a mesh.  The <B>Set</B> button
opens a separate color selector window which works like the <B>Line
color</B> window.
<LI><B>Transparency</B> is a property that appears in the model view.
Changes will appear immediately for line or sphere displays but will
have to be incorporated into a new mesh for filled mesh displays.
<LI><B>2D line width</B>, <B>Symbol type</B>, and <B>Symbol size</b>
are properties that appear only in 2d (image) displays and their
default values are set in the 3dmod Object Edit window.
<LI><B>3D line width</B> governs the width of lines displayed in the
model view.
<LI><B>Gap to next point</B> introduces an opening in the contour after
the current point, so that contours can have multiple openings.  These
gaps are introduced into the mesh when the model is meshed with
<A HREF = "../man/imodmesh.html#TOP">Imodmesh</A> or in the Edit-Objects dialog of
the Model View window. The hot key for toggling this property is <B>Ctrl+G</B> and it
is available even when the dialog is closed.  When
contour or surface properties are being shown, this button mutates to
<B>Turn off drawing</B>, which lets you turn off an individual contour or
surface.
<LI><B>Mesh connection #</B> also has two different meanings.  When point
properties are being shown, it can be used to force particular points
in adjacent contours to be connected in a mesh
and to prevent some connections.  The meshing routines attempt to match up
gaps that are close to each other in two contours being meshed together, and
then connect their starting points together and their ending points together.
If this process fails, you may have to specify which points to connect with
connection numbers.  
The points to be connected need to be assigned the
same unique connection number (unique within the pair of contours being
connected).  It may be necessary to connect three
points rather than two to guarantee that a gap connects correctly
between contours.  If there are more than three points with the same
connection number, points after the third one will be silently ignored
when meshing.  
<br>
There are two cases where connections can be prevented:
<OL>
<LI>
At the ends of two contours in an open contour object, or two open
contours in a closed contour object.  Here, the same connection number should
be assigned to the end of one of the contours and to an interior point of
the other contour where you want the mesh to end (the two points marked "1" in
the diagram below, where "X" is the end of the lower contour).  Then assign a
unique connection number to the next point out from that interior point (the
point marked "2", which is adjacent to "1"
in the lower contour).
<br><pre>
            1----------...
   X------2-1----------...
</pre>
<LI>
Between two sets of connected points when meshing two contours in a closed
contour object.  Typically this would be a place where you define a gap in one
of the contours, or it would be the place where the open end of an open
contour connects to a closed contour.  In the diagram below, the upper contour
has either a gap or an open end between points marked "1" and "2".  The
desired points for them to connect to in the lower contour are marked "1" and
"2" there.  If the points just adjacent to them are marked with a unique 
value ("3"), then no mesh will be made between the line connecting points
"1" and the line connecting points "2".  These points block the
mesh from filling up the gap on the lower contour.
<br><pre>
     ...-----1                  2------...
     ...------1-3-----------3-2--------...
</pre>
</OL>
<br>
If contour properties are
being shown, then connection numbers can be used to control whether
contours on adjacent sections are meshed together by 
<A HREF = "../man/imodmesh.html#TOP">Imodmesh</A>.  To connect two contours that
do not overlap, give them the same connection number.  To prevent a connection
between two contours that do overlap, give them two different connection
numbers.


<LI><B>General value:</B> shows the value that has been stored, if any, for
the current point or contour.  These values can be inserted into a model with
programs such as 
<A HREF = "../man/imodcurvature.html#TOP">Imodcurvature</A>, 
<A HREF = "../man/patch2imod.html#TOP">Patch2imod</A>, 
<A HREF = "../man/point2model.html#TOP">Point2model</A>, 
<A HREF = "../man/imodfindbeads.html#TOP">Imodfindbeads</A>, 
<A HREF = "../man/findbeads3d.html#TOP">Findbeads3d</A>, and PEET.
</UL>
<P>
<A HREF="index.html#TOP">Help Index<A>
