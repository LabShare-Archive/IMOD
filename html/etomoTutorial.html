<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HEAD>
  <title>ETomo Tutorial</title><! DO NOT EDIT THIS FILE IN MOZILLA COMPOSER! It 
  destroys line endings and replaces spaces in tags with %20, which fails in some 
  browsers. OpenOffice also replaces spaces with %20.>
</HEAD>
<body bgcolor="white" lang="EN-US">
  <A NAME="TOP"></A>
  <h1 align="center">ETomo Tutorial for IMOD Version 4.7</h1>
  <h3 align="center">Eileen O'Toole</h3>
  <h3 align="center">Boulder Laboratory for 3-D Electron Microscopy of Cells</h3>
  <hr>
  <H2>I.&nbsp; Initial set up and viewing the raw tilt series</H2>
  <p><br>
    This tutorial contains a small, dual-axis sample data set and a step-by-step 
    guide to eTomo. The tutorial is not meant to be a replacement for the 
    Tomography Guide. Please refer to the more comprehensive <a href="tomoguide.html#TOP">
      Tomography Guide</a> for additional detail about each step. The sample data 
    set was chosen because you should get through the entire process with no 
    problems! The Tomography Guide is a good reference for trouble shooting and 
    learning more about the many programs that are used for computing dual-axis 
    tomograms.
  </p>
  <P>There are a number of new features in IMOD 4.7 that are illustrated in this 
    version of the tutorial.&nbsp; If you do not have IMOD 4.7 installed, you 
    should either upgrade to it, or enter <code><font size="+1">imodhelp</font></code>
    in the terminal and select the eTomo Tutorial that comes in your installed 
    version.</P>
  <p>
    To get started, <a href="http://bio3d.colorado.edu/imod/files/tutorialData.tar.gz">
      download</a> the sample data set from our web site.&nbsp; Unpack the data by 
    typing:</p>
  <p>
    &nbsp; &nbsp; &nbsp; &nbsp; <code><font size="+1">tar -xzf tutorialData.tar.gz<br>
      </font></code>
  </p>
  <p>
    This will create a directory, <code><font size="+1">tutorialData</font></code>, 
    containing the two raw stacks needed to start the tutorial, named BBa.st and 
    BBb.st, respectively.&nbsp; There is also a subdirectory, <code><font size="+1">finalFiles</font></code>, 
    containing all of the small working files left after completing the data set, 
    as well a copy of the final reconstruction.</p>
  The file names reflect a convention that you will have to follow with your own 
  data sets:&nbsp; the raw stacks have the extension .st and dual axis stacks 
  have a common,&nbsp;&nbsp;root name that ends in a.st and b.st.&nbsp; This 
  extension is just a convention and does not indicate the format of the image 
  file.&nbsp; It is also acceptable to have extensions of .mrc; eTomo will rename 
  the files to have extension .st.&nbsp; If you have a data file in the right 
  format but with some other&nbsp;extension, you just need to rename the file to 
  have the extension .st instead.
  <P></P>
  <p>&nbsp;</p>
  <H2>II.&nbsp; eTomo Setup</H2>
  <p>To start eTomo, type:</p>
  <p>
    &nbsp; &nbsp; &nbsp; &nbsp; <code><font size="+1">etomo</font> </code>
  </p>
  <p></p>
  <div align="center"><img src="etomoImages/frontPage.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>
  </p>
  <P>When eTomo is first started, a <b>Front Page</b> panel will come up (shown 
    above), allowing you to select what operation you want to perform with 
    eTomo.&nbsp; At this point you can either start working on a new data set by 
    pressing the <B>Build Tomogram</B> button or open an existing data set under 
    the <b>File</b> and <b>Recent Projects</b> menus.&nbsp;<br>
  </P>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/setupwindow1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>
  </p>
  <p>Press <B>Build Tomogram</B> and the <b>Setup Tomogram</b> panel will come up 
    (shown above). A <B>Project Log</B> window will also open that will contain a 
    history of actions and report useful log file solutions specific to particular 
    steps.</p>
  <p>
    To start working on a new data set, the following fields must be filled out. 
    The <b>Dataset name</b> is the name of the file containing the raw, tilt series 
    (or the root_namea.st if a dual axis data set was collected).&nbsp; You can 
    enter the <b>Dataset name</b> by clicking on the yellow file selection button 
    associated with the <b>Dataset name</b> field, or type in the directory path 
    and file name directly in the field. The <b>Backup directory </b>is an optional 
    field to save small working files every time you run a procedure.&nbsp; This 
    field can be left empty if you don't wish to use a backup directory.
  </p>
  <p>In the <b>Templates</b> box, select the <i>plasticSection.adoc</i> <b>System 
      template</b>.&nbsp;&nbsp;This template is part of the IMOD installation and 
    it can be used to set some parameters that are appropriate for this kind of 
    reconstruction.</p>
  <p>
    Select whether the data set is <b>Single axis</b> or <b>Dual axis.</b> The <b>Montage</b>
    option is available for processing montaged tilt series.</p>
  <p>
    The next fields specify Pixel size (nm), the size of gold Fiducial 
    diameter&nbsp;(nm) and Image rotation (degrees).&nbsp; <b>Pixel size</b> (in 
    nm) is dependent on the microscope, camera, and magnification. The<b> Image 
      rotation</b> (tilt axis angle from vertical, in degrees) will also vary based 
    on the microscope and magnification. Pressing the <b>Scan Header</b> button 
    will retrieve the <b>Pixel size</b> and <b>Image rotation</b> values if these 
    are specified in the MRC file header.&nbsp; For this tutorial example, press <b>Scan 
      Header</b> to define the pixel size for this data set (2.02) and Image 
    rotation (-12.5). You must specify the size of the gold <b>Fiducial diameter</b>
    (10 nm).
  </p>
  <p>
    If the <b>Parallel Processing</b> checkbox is enabled, uncheck it so that your 
    screen will look the same as the ones shown here. Parallel processing, which is 
    not covered in this tutorial, allows some processes to be distributed across 
    multiple computers or to multiple processors on one computer (see <A href="UsingEtomo.html#ParallelProcessing">
      Using eTomo</A> for information on how to activate it). Leave the <B>Image 
      distortion field file</B> entry blank.&nbsp; This feature can be used to 
    correct for nonlinear image distortions if they have been measured and 
    characterized, which is particularly useful with data from an energy filter. 
    Leave the <B>Mag gradient corrections</B> entry blank. This feature contains a 
    file with magnification gradients to be applied for each image, which&nbsp;is 
    useful&nbsp;for use with&nbsp;montage data.
  </p>
  <p>Specify the source of the tilt angles for either one or both axes, as 
    appropriate in the <b>Axis A</b> and, if necessary, the <b>Axis B</b> box(es). 
    In this example, tilt angles are stored in the extended header and so the 
    default <b>Extract tilt angles from data</b> should be used. If you are 
    reconstructing a&nbsp;tilt series that was taken in two directions from zero 
    degrees, you can turn on <STRONG>Series was bidirectional from</STRONG>, and 
    this will take care of setting some appropriate alignment parameters.&nbsp; You 
    can also optionally specify individual projections to exclude from processing 
    steps.&nbsp; The syntax for this exclude list is a comma separated list of 
    ranges (i.e. 1,4-5,60-70).&nbsp; Notice that there is a also a button in this 
    section to open the raw data file for viewing in 3dmod.
  </p>
  <p>It is useful to look at the raw tilt series files in order to make decisions 
    about preprocessing steps or to see if there are any particular views that have 
    poor image quality, and that you want to exclude from the alignment and 
    reconstruction.&nbsp;</p>
  <P>To determine if you have views that have poor image quality (poor focus, 
    etc.), open the raw stack(s) by pressing the <b>View Raw Image Stack</b> button(s). 
    &nbsp;Movie through the raw tilt series images by clicking the middle mouse 
    button.&nbsp; Notice how the images jump around slightly.&nbsp; Make note of 
    any particular views that you want to exclude from the alignment and 
    reconstruction.&nbsp; In this sample data set, there are no images that need to 
    be excluded.
  </P>
  <P>
    &nbsp;</P>
  <div align="center"><img src="etomoImages/setupwindow2.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>
    Details specific for the tutorial sample data set are shown above. For this 
    sample data set, the <B>Dataset name</B> is BBa.st; it is a dual axis set. The 
    pixel size is 2.02 nm, the fiducial diameter is 10 nm and the image rotation is 
    -12.5 degrees. Tilt angles for this data set are stored and extracted from the 
    data file.&nbsp;
  </p>
  <P>
    Press the <B>Create Com Scripts</B>
  button to move on to generating the tomograms.
  <p>&nbsp;</p>
  <H2>III.&nbsp; eTomo Main Window</H2>
  <p>
    If you need to exit eTomo before finishing this tutorial, you can continue 
    where you left off by going to the <code><font size="+1">tutorialData</font></code>
    directory, which now contains your dataset, and typing:
  </p>
  <p>
    &nbsp; &nbsp; &nbsp; &nbsp; <code><font size="+1">etomo BB.edf</font> </code>
  </p>
  <p>The Main Window consists of several areas: on the left is a column of buttons 
    (Process Control Buttons) that allow you to select a particular stage of 
    tomogram computation to work on. On the top is a Process Monitor that informs 
    you of the status of the current process or the last process completed. To the 
    left of the Process Monitor are the Axis Buttons which allow you to move 
    between Axis A and Axis B. The Main Window is currently open to Axis A<br>
    <br>
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/mainwindow.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>
    The Process Control Buttons are arranged in the suggested order of processing 
    from top to bottom.&nbsp; The buttons are color coded to signify the stage of 
    the process, where red indicates that the process has not been started, magenta 
    indicates that the process is currently in progress, and green indicates that 
    the process has been completed.&nbsp; When one of the buttons is selected, the 
    right side of the window will fill in with information and fields associated 
    with a specific process.&nbsp; These forms are referred to as Process 
    Panels.&nbsp; They allow you to modify the necessary parameters and execute 
    specific programs required by that processing step.&nbsp; The parameters and 
    buttons on each Process Panel are typically laid out from top to bottom in the 
    order they should be executed, much like a flow chart.&nbsp; When you execute a 
    process (by pressing a button on one of the Process Panels) the Process Monitor 
    will indicate what the process is doing and when it is complete.
  </p>
  <p>&nbsp;</p>
  <H2>IV.&nbsp; Pre-Processing</H2>
  <P>If images were collected on the microscope using a CCD camera, random x-rays 
    hitting the CCD camera during collection of the initial dark reference or 
    individual images can cause extreme high or low pixel values in your data 
    file.&nbsp; As a result, these extreme values ruin the contrast and can cause 
    artifacts in the reconstruction. &nbsp;The example in this tutorial does not 
    have&nbsp;any extreme pixel values that would cause such problems&nbsp;.&nbsp; 
    However, the procedure for removing these pixel values is outlined here to give 
    you a sense of the steps involved.&nbsp; First, a quick way to determine if 
    your file does have extreme pixel values is to look at the Minimum and Maximum 
    Density values in image header of the raw stack.&nbsp; To do this, go to the 
    command line terminal and type:
  </P>
  <p>
    <code><font size="+1">&nbsp; &nbsp;header BBa.st</font></code>
  </p>
  <p>Notice the minimum, maximum, and mean density values. &nbsp; If the minimum 
    density value is a negative number or 0, then you probably have an extreme 
    black pixel in your data set, caused by an x-ray event during collection of the 
    dark reference. &nbsp; If you have a high maximum density, then you have an 
    extreme white pixel in your data set.&nbsp; If extreme values are lurking 
    somewhere in the data set and a preprocessing step is needed to remove them, 
    then you would press the <B>Pre-processing</B> button to open this panel:</p>
  <p>
    &nbsp;</p>
  <div align="center"><img src="etomoImages/preprocessing.png" title="" alt=""><br>
  </div>
  <p>
    &nbsp;</p>
  <P>The basic steps involved in pre-processing (again, not needed for the tutorial 
    data set) are:</P>
  <UL>
    <LI>
      <p>Press the <b>Show Min/Max for Raw Stack</b> button to run <b>clip stats</b>, a 
        program which displays the minimum and maximum densities for each section, on 
        the raw stack.&nbsp; Windows will open with the text output and with a graph of 
        these densities.</p>
    <LI>
      <p>Press the <b>Create Fixed Stack</b> button to create a second stack with 
        X-rays removed.</p>
    <LI>
      <p>Press the <B>View Fixed Stack</B> button to view that stack, and press the <b>Show 
          Min/Max for Fixed Stack</b> button to run <b>clips stats</b> on the fixed 
        stack. Check to see if the extreme pixel values have been corrected.</p>
    <LI>
      <p>If the contrast appears good in the display without the Black and White 
        sliders in 3dmod being very close together, and the outliers from the raw stack <b>
          clip stats</b> output are gone from the fixed stack output, then press the <b>Use 
          Fixed Stack</b> button.</p>
    </LI>
  </UL>
  <p>
    For details on this operation, refer to the <a href="tomoguide.html#PRE-PROCESSING">
      PRE-PROCESSING: REMOVING X-RAYS</a> section of the Tomography Guide.
  </p>
  <p>&nbsp;</p>
  <H2>V. Coarse alignment</H2>
  <p>
    Press the <B>Coarse Alignment</B> Process Control Button to proceed with 
    creating a coarse-aligned stack.</p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/coarseA1.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/coarseA2.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <p>
    Pressing the <b>Calculate Cross-Correlation</b> button runs the program, 
    Tiltxcorr. The program uses cross-correlation to find an initial translational 
    alignment between successive images of a tilt series (i.e. just shifts in x and 
    y). The output file, BBa.prexf, contains a list of transforms (or recommended 
    shifts) that will be applied to the image data in the next step.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/coarseA3.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <p>
    Pressing the <b>Generate Coarse Aligned Stack </b>button will run 2 programs.<span> &nbsp;</span>
    Xftoxg takes the transforms created by Tiltxcorr to obtain a single consistent, 
    or 'global' set of alignments. These new transforms are then applied to the 
    image data using the program Newstack. The output file created is BBa.preali. 
    One can view the prealigned stack by pressing the <b>View Aligned Stack in 3dmod </b>
    button. Large image shifts can be edited manually using the the interactive 
    program, Midas. This is not an issue with this data set; see the <a href="tomoguide.html/#COARSE ALIGNMENT">
      COARSE ALIGNMENT</a> section of the Tomography Guide for details. The <B>Tilt 
      axis rotation</B> entry is used if Midas is run, because Midas will rotate 
    images so that the tilt axis is vertical.&nbsp; The <B>Fiducialless alignment</B>
    check box can be selected for making a tomogram without a fiducial alignment; 
    see <a href="tomoguide.html#Fiducialless Quick">Making a Quick Tomogram with 
      Correlation Alignment</a> in the Tomography Guide for details.&nbsp; Once you 
    are satisfied with the prealigned stack, press the <b>Done</b> button to 
    proceed to the next step.</p>
  <p>&nbsp;</p>
  <H2>VI.&nbsp; Creating a fiducial model based on the position of gold particles</H2>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/fiducialA1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <P>There are three options available to generate a fiducial model. The most 
    common is to <B>Make seed and track</B> a number of gold fiducial markers, 
    where the starting points can be selected either manually or 
    automatically.&nbsp; These starting points are referred to as a seed model 
    because they are picked on only one section, and the fiducials are tracked from 
    there.&nbsp; The option, <B>Use patch tracking to make fiducial model, </B>can 
    be&nbsp;used&nbsp;if the data set&nbsp;does not contain gold fiducial markers 
    or too few gold fiducials.&nbsp;<B>Run RAPTOR and fix</B> will use a 
    program&nbsp;developed at&nbsp;Stanford to automatically find and track gold 
    fiducial markers through the tilt series. See the <A href="tomoguide.html#GETTING FIDUCIAL">
      FIDUCIAL MODEL GENERATION</A> section of the Tomography Guide for 
    details.&nbsp;We are first going to select&nbsp;seed points 
    automatically,&nbsp;using a&nbsp;new feature&nbsp;in IMOD 4.7.&nbsp; Then we 
    will back up and go through the older method,&nbsp;which is better 
    for&nbsp;illustrating the procedures you would need to follow with more 
    problematic data sets.
  </P>
  <P>Select the <STRONG>Generate seed model automatically</STRONG> radio button to 
    open the automatic seed finding panel, enter 25 for the <STRONG>Total number</STRONG>
    to track, and turn on <STRONG>Select beads on two surfaces</STRONG>.</P>
  <DIV align="left"><STRONG>Press the Generate Seed Model process button.</STRONG></DIV>
  <DIV align="left"><BR>&nbsp; </DIV>
   <DIV align="center"><img src="etomoImages/autofidseed1.png" title="" alt="">&nbsp;
  </DIV>
  <DIV align="center">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">When the operation is complete, the number of beads selected on 
    each surface will be indicated in the&nbsp;Project Log window.&nbsp; Press <B>Open 
    Seed Model</B> to see the points that were selected.&nbsp; You will have to scroll 
    up to the&nbsp;section at 1 degree (number 33) to see the points.&nbsp; The 
    green points mark beads on the bottom surface, the magenta points are on the 
    top surface.&nbsp; The next step uses this model as a seed from which a 
    complete fiducial model is built.</DIV>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
 <div align="center"><img src="etomoImages/autofidseedOutput1.png" title="" alt="">&nbsp;
        <br>
      </div>
  <DIV align="left">&nbsp;</DIV>
<div align="center"><img src="etomoImages/autofidseed4.jpg" title="" alt="">&nbsp;
    <br></div>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
  <p>Select the <b>Track Beads</b> tab.</p>
  <h4>Press the 'Track Seed Model' process button.</h4>
  <p>&nbsp;</p>
  <P align="center">&nbsp;<img src="etomoImages/fiducialA2.png" title="" alt="">
  </P>
  <p>&nbsp;</p>
  <p>This will run the Beadtrack program to find the gold on all other sections. 
    The output file created by tracka.com is BBa.fid, which is the completed 
    fiducial model. This computer-generated model is not perfect, and gaps in the 
    fiducial model can occur. A report of the total points missing will be 
    indicated in the Project log window. If a large number of points are missing, 
    press the <b>Track with Fiducial Model as Seed</b> button, which will rerun the 
    tracking program with the fiducial model as the seed.&nbsp;&nbsp;If points are 
    still missing, the next procedure involves an iterative process to edit this 
    fiducial model.&nbsp; Note,&nbsp;that it is not necessary to fill all the gaps, 
    particularly if there is a good excess of fiducial points, as there is 
    here.&nbsp; However, it is important to make sure that&nbsp;the large 
    majority&nbsp;of the fiducials are tracked all the way to the two ends of the 
    tilt series.</p>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/track1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <h4>Press the 'Fix Fiducial Model' process button.</h4>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/fiducialA3.png" title="" alt="">&nbsp;
  </p>
  <p><br>
    This procedure will open the prealigned stack (BBa.preali) and the fiducial 
    model file (BBa.fid) in 3dmod.
  </p>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/fix1.jpg" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/3dmodmain.png" title="" alt=""> &nbsp;&nbsp;&nbsp; 
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
    &nbsp; &nbsp; <img src="etomoImages/beadfixer.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>
    The Bead Fixer dialog box will come up in <b>Fill gaps</b> mode. The Bead Fixer 
    facilitates editing the fiducial model.</p>
  <p>
    Hit<b> 'Go to Next Gap'</b> by clicking on the button using the left mouse 
    button, or by using the spacebar as a hot key.&nbsp; This will attach to a 
    point (highlighted with a yellow circle) that has a missing model point on an 
    adjacent section. Use the Page Up key (when an up arrow appears above the 
    point) or the Page Down key (when a down arrow appears above the point) to find 
    the section with the missing point and use the middle mouse button to add the 
    point in the center of the gold particle. It is useful to increase the 
    magnification of the image with the '+' key and adjust the contrast on the 
    sections, especially at high tilt.
  </p>
  <div align="center">
  </div>
  <DIV align="center"><img src="etomoImages/fix2.png" title="" alt="">&nbsp;
    <br>
  </DIV>
  <p style="Z-INDEX: 0">Repeat <b>'Go to&nbsp; Next Gap'</b> until the message, '<B>No 
      more gaps found</B>' comes up in the main 3dmod window. Save the model 
    file&nbsp;by going to File -&gt; Save model, or by hitting the hot key 
    's',&nbsp; and press the <B>Done</B> button to advance to the fine alignment 
    step.</p>
  <p>&nbsp;</p>
  <H2>VII.&nbsp; Alignment of serial tilts</H2>
  <p align="left">The <b>Fine Alignment</b> panel is organized with a set of three 
    tabs to solve for various alignment parameters. A general alignment is first 
    done by pressing the <b>Compute alignment</b> button at the bottom of the<b> Fine 
      Alignment</b> box.
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/finealignment1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <P>This command file runs the program, Tiltalign, to solve for the displacements, 
    rotations, tilts and magnification differences in the tilted views. The program 
    uses the position of the gold particles in the fiducial model and a variable 
    metric minimization approach to find the best fit. It creates a log file that 
    gives a synopsis of what was done. A report of the Ratio of total values to all 
    unknowns and the residual error mean and sd is displayed in the Project Log 
    window. To access the full log file, right click the mouse cursor over the 
    window region associated with the process. This will open a menu that is split 
    into three or four sections: the first section will allow you to open the log 
    files associated with the current process; a second section allows you to see 
    graphs of alignment parameters, but is not present on most other panels; the 
    next section will allow you to open up the man pages associated with the 
    current processes, and the final menu section opens the general help guides. 
    &nbsp;Select "Align axis:a log file" to open the log file.&nbsp;<b> </b>This 
    will open a tabbed file that contains the complete log and short sections from 
    this log file. In my example, the first <B>Compute Alignment</B> run gave a 
    Residual error mean of 0.239.
    <br>
  </P>
  <p align="center"><IMG title="" alt="" src="etomoImages/alignlogerrors.png"><BR>
  </p>
  <P></P>
  <p align="center">
  </p>
  <P align="left">This result is too good for illustrating further steps, so now we 
    are going to back up.&nbsp; First, go to the terminal window and remove or 
    rename the seed mode, for example:</P>
  <P align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT size="+1"><code>mv 
        BBa.seed BBa_auto.seed</code></FONT></P>
  <P align="left">Next, in eTomo, press the <STRONG>Fiducial Model Gen.</STRONG> button 
    on the left, select the <STRONG>Seed Model</STRONG> tab, and switch back to <STRONG>
      Make seed model manually</STRONG> so that the screen looks like this:</P>
  <P align="center"><img src="etomoImages/seed1.png" title="" alt=""><br>
  </P>
  <H4 style="Z-INDEX: 0">Press the 'View Seed Model' button.&nbsp;
  </H4>
  <p>(This button was originally labeled <STRONG>'Seed Fiducial Model'</STRONG> before 
    any model was created.) &nbsp;This will open BBa.preali in 3dmod and create an 
    empty model file named BBa.seed. It will also bring up the Bead Fixer dialog 
    box in <b>Make seed</b> mode with <b>Autocenter</b>&nbsp; 
    checked.&nbsp;&nbsp;Check <B>Automatic new contour</B> if it is off; 3dmod will 
    remember this setting from session to seesion.</p>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/beadfixerSeed.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <p>3dmod will open the file to the middle section (section 31&nbsp;in this 
    tutorial stack). You can return to the middle section by pressing the Insert 
    key on your keyboard.</p>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/seedmodel1.jpg" title="" alt=""><br>
  </div>
  <p></p>
  <div align="center">&nbsp;&nbsp; &nbsp;
    <br>
  </div>
  <p>In the Zap (image) window, place a model point in the center of 20-30<span></span>gold 
    particles by centering the cursor in the middle of the gold particle and 
    pressing the middle mouse button. Because <B>Automatic new contour</B> is 
    checked,&nbsp; a new contour for each new gold bead will be created. Because <b>Autocenter</b>
    is checked, 3dmod should make sure that the model point is positioned in the 
    center of the gold bead, so you do not need to be as careful as when filling 
    gaps. &nbsp;In my example (BBa.seed) I selected 25 gold particles; the model 
    contains 1 object, 25 contours, with each contour having 1 point.
    <span>&nbsp;</span>
    Save this seed model.
  </p>
  <P>Next, select the Track Beads tab again.&nbsp; In order to keep the result from 
    being so good this time, turn off <STRONG>Refine center with Sobel filter</STRONG>.</P>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/track2.png" title="" alt="">
  </div>
  <DIV align="center">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">Press <STRONG>Track Seed Model</STRONG> to track your seed 
    points.&nbsp; As before, press <STRONG>Fix Fiducial Model</STRONG> and fill in 
    any gaps.&nbsp; Press <STRONG>Done</STRONG> to&nbsp;go on to&nbsp;the fine 
    alignment step again.</DIV>
  <DIV align="left">&nbsp;</DIV>
  <P align="center"><img src="etomoImages/finealignment2.png" title="" alt=""></P>
  <P align="center">&nbsp;</P>
  <P align="left">Press <STRONG>Compute Alignment</STRONG>.&nbsp; This time the 
    residual error is quite a bit bigger.<br>
  </P>
  <P align="center"><img src="etomoImages/alignlogerrors2.png" title="" alt=""><br>
  </P>
  <p>&nbsp;</p>
  <p>The goal of the fine alignment step is to reduce the residual error mean to 
    0.2- 0.5 for the pixel size of this tutorial data set. Data sets with smaller 
    pixel sizes will have larger&nbsp;residual error means.&nbsp;
    <br>
  </p>
  <p>
    The Tiltalign program also creates two model files that provide useful 
    information about the fiducial model.<span>&nbsp; </span>The first (BBa.3dmod) 
    displays a
    <span style="COLOR: black">3-D model of
the fiducials based on their solved positions. </span>Fiducials that are present on 
    the two surfaces are assigned 2 different colors; pink spheres on one side and 
    green spheres on the other. Examine this model by hitting the <b>View 3D Model</b>
    button on the bottom of the <b>Fine Alignment</b> box:</p>
  <p>&nbsp;</p>
  <p align="center">&nbsp;<img src="etomoImages/3Dmodel1.png" title="" alt=""><img src="etomoImages/3Dmodel2.png" title="" alt="">&nbsp;<span></span></p>
  <p>&nbsp;</p>
  <p>
    You should see a nice distribution of pink and green spheres across the field 
    of view. Rotate the model to view edge-on by holding down the number 8 key on 
    the keypad. You will see the separation of the two surfaces with this view. 
    Avoid using models that have a cluster of fiducials in any one particular 
    region because this will skew the alignment. Close the 3dmodv window.
  </p>
  <p>
    The second model Tiltalign produces is a residual vector model. &nbsp;Press the 
    '<b>View Residual Vectors</b>' button at the bottom of the <b>Fine Alignment</b>
    box. This will open the prealigned stack in 3dmod and display the residual 
    vector model on each section.
  </p>
  <P>&nbsp;</P>
  <p align="center"><img src="etomoImages/residualvector.jpg" title="" alt="">&nbsp;
    <br>
  <p><br>
    The model will show the current model point as the origin of a green arrow, and 
    the position of the residual as the end of the arrow. This residual 
    displacement is expanded by a factor of 10 in order to distinguish it from the 
    actual model point, because displacements are often very small (<u>&lt;</u> 2 
    pixels). In large (&gt;2k x 2k) images the residual model will often show large 
    displacements in one area but not in other areas. In these cases, the residual 
    model helps to make decisions if local alignments are needed. In this example, 
    local alignments are not needed. It is common to have larger residuals at the 
    higher extreme tilts. Leave 3dmod open for the next several steps and press the <B>
      'View/Edit Fiducial Model'</B> button to reload the fiducial model for 
    editing. This will bring up the Bead Fixer dialog box in <b>Fix big residuals</b>
    mode and load the aligna.log file.</p>
  <h4>The following iterative steps involve fixing fiducial points with large 
    residuals.</h4>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/3dmod.png" alt="">&nbsp;&nbsp; 
    &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<img src="etomoImages/beadfixer2.png" title="" alt="">
    &nbsp;</p>
  <p>&nbsp;</p>
  <p>
    Click<span>&nbsp; </span>'<b>Go to Next Big Residual</b>' in the <b>Bead Fixer</b>
    dialog box.</p>
  <p>The model point that had the big residual will have a red arrow pointing in 
    the direction of the recommended move. You'll probably be able to see that the 
    model point is not centered properly on the gold. &nbsp;<span>&nbsp; </span>If 
    you click '<b>Move Point by Residual</b>' in the<b> Bead Fixer</b> dialog box, 
    it will move the model point by the recommended amount. This works most of the 
    time, but if the recommendation looks wrong, you can move it by hand by 
    centering the cursor over the middle of the gold bead and then clicking the 
    right mouse button. The recommendation is the position predicted by a 
    mathematical alignment model fit to all of the fiducial model points and is not 
    based on an analysis of where the bead is actually&nbsp;located in the 
    image.&nbsp; If you have a specimen that is distorted enough so&nbsp;it does 
    not fit the alignment model well, then arrows will often point away from the 
    actual gold positions.
  </p>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/beadfixer4.png" title="" alt="">&nbsp;&nbsp;&nbsp; 
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <img src="etomoImages/beadfixer5.png" title="" alt=""><br>
  </p>
  <p>&nbsp;</p>
  <p>Repeat selecting '<b>Go to Next Big Residual</b>' and '<b>Move Point by Residual</b>' 
    until no residuals are found. The hot key <b>' </b>will cycle to the next 
    residual and the hot key<b> ;</b> will move point by residual. Save the model 
    file and leave the file open.
  </p>
  <p>
    Access the aligna.log file and go to the Surface Angles tab.<br>
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/alignlogsurface.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <p>Note the Total tilt angle change near the bottom (in my example, this value 
    was -0.39). Put this value in the <B>Fine Alignment Volume Position Parameters</B>
    box under <B>Total tilt angle offset</B>. Press the&nbsp; Compute Alignment 
    button again, then select 'Reread log file' in the Bead Fixer dialog window. 
    Proceed in fixing model points with large residuals. Save the model.&nbsp;
  </p>
  <p>
    If your data set has a good distribution of gold on both surfaces, you can 
    solve for distortion. Press the '<B>Global Variables</B>' tab in the <B>Fine 
      Alignment</B> box:&nbsp;</p>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/finealignAglobal.png" title="" alt="">&nbsp;
    <br>
  </p>
  <p>&nbsp;</p>
  <p>Select the&nbsp; '<B>Full solution</B>' &nbsp;option in the <B>Distortion 
      Solution Type</B> area at the bottom of the panel. This will activate solving 
    for two types of distortion: X-axis stretch and Skew. Keep the default group 
    size and hit the '<B>Compute Alignment</B>' button to run the alignment. 3dmod 
    will re-read the log file when <b>Compute Alignment</b> is done.</p>
  <p>
    Return to the 3dmod windows and repeat fixing the new residuals that Tiltalign 
    came up with after solving for distortion. Then press the <B>Save &amp; Run 
      Tiltalign</B> button in the Bead Fixer window to save the model and compute 
    the alignment.&nbsp; You can use this button to avoid having to go back to 
    eTomo, as long as you haven't changed any parameters in eTomo. After a few runs 
    of running the alignment and checking model points in 3dmod, the final mean 
    residual should come down to 0.2-0.4.&nbsp;&nbsp; In my example, the final 
    Residual error mean was 0.326.</p>
  <p>
  <p>&nbsp;</p>
  <P></P>
  <div align="center"><img src="etomoImages/finalAerror.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <h2>VIII.&nbsp; Sampling the data set to create 3 small reconstructions</h2>
  <p>The goal of the next step is to shift and rotate your reconstruction so that 
    it is as flat as possible and will fit into the smallest volume. This is done 
    by sampling three regions of the tomogram, ones computed from near the top, 
    middle, and bottom of the tilt images. (When these samples are not adequate, 
    you can do this instead with a whole, binned down tomogram; see <a href="tomoguide.html/#Whole Tomogram Positioning">
      Positioning with a Whole Tomogram</a> in the Tomography Guide for 
    details.)&nbsp; There are two rotations which can be adjusted: the rotation 
    about the tilt axis, to make the section level when viewed in the X-Z plane; 
    and a rotation about the X axis, to make the section come out at the same Z 
    height throughout the length of the tomogram.<br>
  </p>
  <p>
    Increase the Sample tomogram thickness to 200.&nbsp; This will create a 
    reconstruction that is much thicker than the original section.</p>
  <h4>
    Press Create Sample Tomograms</h4>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/TomopositionA2.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>This command file first extracts and aligns a 60 pixel sliver from the top, 
    middle, and bottom of the image stack. The program then uses these samples to 
    create 10 slices of the reconstruction from the top, middle, and bottom of the 
    aligned stack. These output files are named topa.rec, mida.rec, bota.rec. Press <b>
      Create Boundary Models</b></p>
  <H4>This step involves creating a model to define the top and bottom surfaces of 
    each reconstruction.</H4>
  <p>When the '<B>Create Boundary Models</B>' is pressed, 3dmod will read in all 
    three reconstructions at once, with the topa.rec displayed first and viewed 
    edge on. 3dmod will also start with an empty model, named tomopitcha.mod.
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/TomopositionA4.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>
    The top bar of the Zap window has a feature '4<sup>th</sup> D' and a backward 
    and forward arrow. If you click the forward arrow, you can cycle through to the 
    mida.rec and bota.rec reconstructions, respectively. Start with the topa.rec. 
    Use the contrast sliders to adjust contrast.&nbsp; Notice the material in the 
    center of the volume with a mottled appearance. This is the part of the 
    reconstruction with biological material.&nbsp; Using the middle mouse button, 
    place one model point at the left side of the top surface that defines the 
    region containing the biological material, and a second model point at the 
    right side of the top surface. A line will connect the two points. Model the 
    bottom surface of the section with 2 points on the left and right sides, 
    respectively. Toggle to the mid.rec and bot.rec file by hitting the arrow 
    button to the right of '4<sup>th</sup> D' at the top of the zap window. Repeat 
    modeling the top and bottom surfaces of the other two reconstructions. The 
    final model should have 1 object and 6 contours, and each contour should have 2 
    model points.&nbsp; Save this model file.</p>
  <p>It is generally helpful for the thickness of the final tomogram to be about 10 
    to 20 pixels greater than the actual distance between the lines that you 
    draw.&nbsp; You can adjust the entry in <b>Added border thickness</b> to 
    accomplish this.&nbsp; The default value of 5 will make the tomogram 10 pixels 
    thicker; change it to 10 to make it 20 pixels thicker.</p>
  <h4>Press 'Compute Z Shift and Pitch Angles'</h4>
  <p>Based on these model contours, tomopitch determines parameters to make the 
    reconstruction as flat as possible and to fit in the smallest volume as 
    possible.&nbsp;&nbsp;These offsets are automatically added to the existing <B>Angle 
      offset</B>, <B>Z shift</B> and <B>X axis tilt</B> values. The <B>Final tomogram 
      thickness</B> is also entered by eTomo from the tomopitch log.&nbsp;<BR>
    &nbsp;</p>
  <P align="center">&nbsp;<img src="etomoImages/TomopositionA5.png" title="" alt="">
  </P>
  <p>&nbsp;</p>
  <h2>IX.&nbsp; The final runs to create the full-size tomogram</h2>
  <P>Press the <B>Create Final Alignment</B> button. &nbsp; After the final 
    alignment transforms are created, press the <B>Done</B> button to advance to 
    the next step.
  </P>
  <P>&nbsp;</P>
  <div align="center"><img src="etomoImages/TomopositionA7.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <h3>Press 'Create Full Aligned Stack'</h3>
  <p>This command will apply the alignment transforms to the full-sized image for 
    the final, aligned stack. The output file is named BBa.ali
  </p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/FullAlignedStackA1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>The full aligned stack may be viewed by pressing <B>View Full Aligned Stack</B>, 
    although this is not necessary.&nbsp; There are optional steps for CTF 
    correction, erasing fiducials, and filtering the aligned stack, which are also 
    not needed here.&nbsp; Press the <B>Done</B> button to advance to the next 
    step.</p>
  <p>The default filtering parameters in the <B>Tilt Parameters</B> section are 
    appropriate for many cases, but can be changed, or the aligned stack can be 
    filtered, to reduce noise in the reconstruction (see the <a href="tomoguide.html/#TOMOGRAM GENERATION">
      TOMOGRAM GENERATION</a> section of the Tomography Guide for details).&nbsp;</p>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/TomogenA1.png" title="" alt="">&nbsp;
  </div>
  <p>&nbsp;</p>
  <h3>Press 'Generate Tomogram'</h3>
  <p>When the tomogram is computed, examine it by pressing <B>View Tomogram in 3dmod</B>. 
    You may also choose to <B>Delete Intermediate Image Stacks</B> at this point to 
    save space.
  </p>
  <p>
    Movie through the reconstruction by hitting the middle mouse button to step 
    through serial, tomographic slices from the top surface of the tomogram to the 
    bottom surface.&nbsp;</p>
  <p>&nbsp;</p>
  <H2>X. On to the second axis (Axis B)</H2>
  <p>&nbsp;</p>
  <p>
    <div align="center"><img src="etomoImages/axisButtonsA1.png" title="" alt="">&nbsp;
      <br>
    </div>
  <p>&nbsp;</p>
  <p>
    To see the B Axis, press the <b>Axis B</b> button at the top of the Etomo 
    window. This will bring up another set of process buttons which can be used to 
    perform the operations for aligning the Axis B tilt series and calculating the 
    tomogram. To prevent confusion, Axis A has a blue background and Axis B has a 
    green background.
  </p>
  <p>
    On the right-hand side of the eTomo main window are the process buttons to 
    perform the operations for aligning the <b>Axis B</b> tilt series and 
    calculating the tomogram. Again, the Pre-processing step is not required for 
    this sample data set. Go to the <b>Coarse Alignment</b> steps, as described 
    above for Axis A.<br>
  </p>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/coarseB1.png" title="" alt="">&nbsp;&nbsp; 
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</p>
  <p>&nbsp;</p>
  <p align="center"><img src="etomoImages/coarseB2.png" title="" alt=""> &nbsp;&nbsp; 
    &nbsp;&nbsp;&nbsp;
    <br>
  </p>
  <p>&nbsp;</p>
  <p>After the coarse-aligned stack has been generated, press <B>Done</B> to 
    advance to the next step.
    <br>
    In order to combine both tilt axes at least some (8-10) of the beads that you 
    track must be the same in the two series. To accomplish this, use the program 
    Transferfid.</p>
  <h3>Press 'Transfer Fiducials From Other Axis'</h3>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/transferfid.png" title="" alt="">&nbsp;<br>
  </div>
  <p>&nbsp;</p>
  <p>Pressing the <B>Transfer Fiducials From Other Axis</B> button will run a 
    program, Transferfid, that creates a seed model for the second axis based on 
    the fiducial model from the first axis.&nbsp; The program will search for the 
    pair of views in the two series that correspond the best, then transfer the 
    fiducials from the first series to make the seed model for the second series. 
    At the end, the program will list the fiducial correspondence between the first 
    and second axes and will report this in the Project log window.</p>
  <p>
    Do not worry if a few fiducials failed to transfer. In this example, 21 
    fiducials correspond:</p>
  <P>&nbsp;</P>
  <DIV align="center"><img src="etomoImages/transferfidOutput.png" title="" alt="">&nbsp;</DIV>
  <DIV align="center">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">This is a bit low, and it has happened because the two axes do 
    not match up very well.&nbsp; You can add a few more points manually, but it is 
    also convenient to add some automatically.&nbsp; Simply select <STRONG>Add points 
      to seed model automatically</STRONG> to open the automatic seeding panel.</DIV>
  <DIV align="left"><br>
    &nbsp;</DIV>
  <DIV align="center"><img src="etomoImages/autofidseed2.png" title="" alt="">&nbsp;</DIV>
  <DIV align="center">&nbsp;</DIV>
  <DIV align="left">&nbsp;</DIV>
  <DIV align="left">Notice that <STRONG>Add beads to existing model</STRONG> is 
    selected for you, but you need to fill in the <STRONG>Total number</STRONG> and 
    check <STRONG>Select beads on two surfaces</STRONG> again.</DIV>
  <DIV align="left"><br>
    &nbsp;</DIV>
  <DIV align="center"><img src="etomoImages/autofidseed3.png" title="" alt="">&nbsp;<br>
  </DIV>
  <p>&nbsp;
  </p>
  <P>Press Add Points to Seed Model to add some more points to&nbsp;the 
    seed&nbsp;model produced by Transferfid, which is named BBb.seed. Select the <STRONG>
      Track Beads</STRONG> tab and proceed to <B>Track&nbsp;Seed Model</B> in the 
    Axis B window.
  </P>
  <p>&nbsp;</p>
  <div align="center"><br>
    <img src="etomoImages/trackB.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>This will automatically track the fiducials for the 'B' set. Fix the gaps in 
    the BBb.fid file by pressing the <b>Fix Fiducial Model Using Bead Fixer</b> as 
    outlined above for the A axis. When all gaps are found,&nbsp; press <b>&nbsp;Done</b>
    to proceed to the<b> Fine Alignment</b> and <b>Tomogram</b> calculation steps.</p>
  <p>&nbsp;</p>
  <p>You will now proceed with the same steps following the same procedure as 
    outlined above for the Axis A set. Briefly:</p>
  <h3>Press 'Compute Alignment' for General and Global variable tabs in the Fine 
    Alignment box.</h3>
  <p>At this point, you will start&nbsp; the iterative alignment procedure as you 
    did for the 'A' set by&nbsp; editing model points with large residuals, saving 
    the model, and computing the alignment. When the alignment is complete, press <B>Done</B>
    and proceed with the tomogram generation steps.</p>
  <h4>Proceed with 'Tomogram Positioning' as outlined above for the A Axis.&nbsp;</h4>
  <p><b>Proceed with 'Final Aligned Stack' steps as outlined above for the A Axis.</b></p>
  <p><b>Proceed with 'Tomogram Generation' steps as outlined above for the A Axis.</b></p>
  <p>&nbsp;</p>
  <h2>XI.&nbsp; Combining the two axes</h2>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/axisButtonsB1.png" title="" alt="">&nbsp;
    <br>
  </div>
  <p>&nbsp;</p>
  <p>Go back to the A Axis by pressing the <b>Axis A</b> button.</p>
  <p>To combine the two tomograms press the <b>Tomogram Combination</b> process 
    button.</p>
  <P>&nbsp;</P>
  <div align="center">&nbsp;<img src="etomoImages/combine.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <h3>Tomogram Combination Panel</h3>
  <p>The <B>Tomogram Combination Panel</B> is organized with 3 tabs: <B>Setup</B>, <B>
      Initial Match</B>, and <B>Final Match</B>.
  </p>
  <p>
    The <B>Setup</B> window is where information is given about the particular data 
    set. The first section describes the <B>Tomogram Matching Relationship</B>. It 
    is most common to match the B tomogram to A.
  </p>
  <p>
    The <B>Solvematch Parameters</B> box asks for information on the fiducial 
    marker distribution. In this example, fiducials are on both sides. For this 
    data set, the programs will have no trouble fitting to all of the points at 
    once, so it is not necessary to fill out <b>Starting points to use from A</b>.&nbsp;</p>
  <p>The next section contains information for <B>Patch Parameters for Refining the 
      Alignment</B> using local 3D cross-correlations.&nbsp; Select <b>Small patches</b>.&nbsp; 
    Either <B>Medium patches</B> or <b>Large patches</b> are needed for most data 
    sets, but this data set has been binned to reduce its size, so small patches 
    have plenty of information in them.&nbsp; When specifying the limits of the 
    volume from which the patches will be extracted, it is important to look at the 
    tomogram being matched to. Using the entire Z axis range will almost never 
    work, and even for the X and Y axes it may not be good to use the 
    defaults.&nbsp; To find the limits, press the <B>3dmod Volume A</B> button at 
    the bottom of the panel. &nbsp; This will open BBa.rec in 3dmod. Step through 
    the images and decide what range of the X axis, Y axis and Z axis contains 
    useful information for matching up the volumes. In this example, defaults were 
    kept for the X and Y axis.</p>
  <p>In this example <b>Z axis min</b> and <b>Z axis max</b> where set to the first 
    and last slices where about half the material in the slice is not blurry (15 
    and 66).</p>
  <p>&nbsp;</p>
  <P align="center">&nbsp;<img src="etomoImages/volA1.jpg" title="" alt=""><img src="etomoImages/volA2.jpg" title="" alt="">&nbsp;</P>
  <p>&nbsp;</p>
  <p>
    Sometimes, this will not eliminate "empty" regions well enough to allow the two 
    axes to combine.&nbsp; In that case, you have to make a patch region model. 
    &nbsp;To make a patch region model, check the box "Use patch region model file" 
    and press the <B>Create/Edit Patch Region Model</B> button to open up the axis 
    that is being matched to.&nbsp; In model mode, trace closed contours around the 
    areas that contain biological material. &nbsp;Do this every 10 slices or so in 
    the tomogram.&nbsp; Save the model, which is named patch_region.mod.&nbsp; 
    Creating the patch region model is particularly useful when reconstructing data 
    sets that have large amounts of resin or open areas in the images.&nbsp; This 
    example data set does not need a patch region model.&nbsp;</p>
  <p>
    When the parameters for the <B>Setup panel</B> have been entered, press <B>Create 
      Combine Scripts</B> to create a series of command files that will run various 
    programs in the combine procedure.&nbsp; Ignore the warning message that pops 
    up.&nbsp; Press <B>Start Combine</B> to begin the process of dual-axis tomogram 
    combination.&nbsp; eTomo will automatically advance &nbsp;to the <B>Initial Match </B>
    and finally the <B>Final Match</B> tabs as various programs are being run. 
    &nbsp;
  </p>
  <p>
    After tomogram combination is complete, press <B>Open Combined Volume</B> to 
    view the final tomogram. Press <B>Done</B> to advance to the final steps.
  </p>
  <p>&nbsp;</p>
  <h2>XII. &nbsp;Post-Processing and Clean-up of intermediate files.</h2>
  <P>Post-processing involves a volume trimming and byte scaling step, followed by 
    deletion of intermediate files.&nbsp; There are also options to flatten the 
    volume and to create a squeezed down volume; both of these can be useful when 
    working with very large data sets, and the flattening is particularly helpful 
    when reconstructing serial sections.&nbsp;&nbsp;A description of their use can 
    be found in the <A href="tomoguide.html#POST-PROCESSING">POST-PROCESSING</A> section 
    of the Tomography Guide.&nbsp;</P>
  <p>&nbsp;</p>
  <P align="center"><img src="etomoImages/trim.png" title="" alt="" id="IMG1"></P>
  <p>&nbsp;</p>
  <p>
    The final reconstruction of the two axes combined into one will always be 
    called sum.rec.&nbsp; (If you have a single axis data set, the name of the 
    reconstruction file at this point will be the data set name followed by 
    _full.rec.)&nbsp; Open the sum.rec reconstruction by pressing <b>3dmod Full 
      Volume</b>. Step through the reconstruction and determine the &nbsp;X,Y and Z 
    ranges for the final volume. &nbsp;A convenient way to set the X and Y range is 
    to turn on the rubberband with the dashed rectangle in the toolbar of the Zap 
    window, press the left mouse button over the upper left corner of the desired 
    area, and drag the mouse to the lower right corner. &nbsp;Z can also be set, if 
    desired; press <b>Lo</b> to set the minimum Z and <b>Hi</b> to set the maximum 
    Z. &nbsp;When you press <B>Get XYZ Volume Range from 3dmod,</B> eTomo will 
    retrieve the X and Y values of the rubberband (and Z values if they are set) 
    from 3dmod. &nbsp;In this example, the default ranges for X and Y are used. 
    &nbsp;The Z axis (in the flipped tomogram) range has been set from a Z min of 
    19 to a Z max of 67 to exclude non-cellular material.&nbsp; Finally a scaling 
    range is set to find the range of slices that exclude the gold beads. &nbsp;In 
    this example, the scaling is section based and has a range between slices 24 
    and 70 (see below to enter these numbers using 3dmod).</p>
  <p>Sometimes it is not possible to find a range of slices that contain no 
    gold.&nbsp; For example, the sample used here contains some gold particles on 
    the plastic resin outside the cell that show up in the same slices that we 
    would like to use for scaling.&nbsp; Limiting the X and Y scaling range to 
    exclude any such gold particles will improve the contrast of the final 
    tomogram.&nbsp; Press the <b>3dmod Full Volume</b> button and bring up the ZaP 
    Window.&nbsp; Go to a slice which shows gold particles and put a rubberband 
    around an area that excludes them.&nbsp; To do this, press the rubberband 
    toggle to the left of the Z slider.</p>
  <p>&nbsp;</p>
  <p align="center">&nbsp;<img src="etomoImages/rubberband1.png" title="" alt="">&nbsp;</p>
  <p>&nbsp;</p>
  <p>Press the left mouse button over the upper left corner of the desired area, 
    and drag the mouse to the lower right corner.&nbsp; Then move the Z slider to 
    lower part of the scaling range (24) and press <b>Lo</b>.&nbsp; Move the Z 
    slider to the upper part of the scaling range (70) and press <b>Hi</b>.</p>
  <p>&nbsp;</p>
      <P align="center">&nbsp;<img src="etomoImages/rubberband2.jpg" title="" alt="">&nbsp;</P>
  <p>&nbsp;</p>
  <p>Go to the <b>Scaling</b> box in eTomo and press the <b>Get XYZ Sub-Area From 
      3dmod</b> button. This will cause the eTomo to retrieve X, Y, and Z values 
    you selected.&nbsp; The default reorientation option&nbsp;will rotate the final 
    volume around&nbsp;the&nbsp;X axis so that it can be read in easily by 3dmod 
    and other programs without special options. Press the <b>Trim Volume</b> button 
    to run Trimvol.&nbsp; Trimvol is a single tool for trimming a volume and 
    converting it to bytes.&nbsp; Finally, view the final, trimmed volume (named 
    BB.rec) by pressing <b>3dmod Trimmed Volume</b>.&nbsp; Press <B>Done </B>to 
    proceed to file cleanup.
    <h3>Cleanup of intermediate files:</h3>
  <p>&nbsp;</p>
  <div align="center"><img src="etomoImages/delete.png" title="" alt=""><br>
  </div>
  <p>&nbsp;</p>
  <p>Cleaning up of your files is very important!&nbsp; The tomogram generation 
    process creates many large, intermediate files. &nbsp;The <B>Intermediate file 
      cleanup</B> box lists what we consider intermediate, nonessential files that 
    can be deleted. &nbsp;Once you are satisfied that the final tomogram is truly 
    final, you can select by highlighting the intermediate files and hitting the <B>Delete 
      Selected</B> button.</p>
  <p>The final, dual-axis tomogram is named BB.rec and can be viewed outside of 
    eTomo using the command, 3dmod BB.rec.&nbsp; Refer to the <a href="3dmodguide.html#TOP">
      Introduction to 3dmod</a> for information about modeling the many cellular 
    features in the tomogram.&nbsp; This was an easy data set and you will likely 
    encounter more problems with your own data, so it is best to read through the <a href="tomoguide.html#TOP">
      Tomography Guide</a> as you start working on a real data set.&nbsp; Also, you 
    will be able to use eTomo more effectively if you read&nbsp;<a href="UsingEtomo.html#TOP">Using 
      eTomo</a> , which explains features such as accessing help and setting up 
    parallel processing.</p>
</body>
