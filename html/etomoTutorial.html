<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:w="urn:schemas-microsoft-com:office:word"
 xmlns="http://www.w3.org/TR/REC-html40">
<! DO NOT EDIT THIS FILE IN MOZILLA COMPOSER!  It destroys line endings and
replaces spaces in tags with %20, which fails in some browsers.  OpenOffice
also replaces spaces with %20. 
Also note: Start new paragraphs with  class="MsoNormal"  or they will come out
in a bigger font.  Or get rid of all these.  >
<head>
  <meta name="Title" content="ETomo Tutorial">
  <meta name="Keywords" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=macintosh">
  <meta name="ProgId" content="Word.Document">
  <meta name="Generator" content="Microsoft Word 9">
  <meta name="Originator" content="Microsoft Word 9">
  <link rel="File-List" href="filelist">
  <title>ETomo Tutorial</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>HVEM Lab</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>HVEM Lab</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:LastPrinted>2003-04-16T19:00:00Z</o:LastPrinted>
  <o:Created>2003-04-28T18:29:00Z</o:Created>
  <o:LastSaved>2003-04-28T18:29:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>3497</o:Words>
  <o:Characters>19938</o:Characters>
  <o:Company>University of Colorado</o:Company>
  <o:Lines>166</o:Lines>
  <o:Paragraphs>39</o:Paragraphs>
  <o:CharactersWithSpaces>24485</o:CharactersWithSpaces>
  <o:Version>9.3220</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>150</w:Zoom>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
  <style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Times New Roman";
	panose-1:0 2 2 6 3 5 4 5 2 3;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
@font-face
	{font-family:Charcoal;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Times;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:Times;
	mso-font-kerning:0pt;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Times;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Times;
	color:black;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Courier;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in .75in 1.0in .75in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1328754150;
	mso-list-type:hybrid;
	mso-list-template-ids:-1058926870 -130242826 1639433 1770505 984073 1639433 1770505 984073 1639433 1770505;}
@list l0:level1
	{mso-level-start-at:2;
	mso-level-number-format:roman-upper;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.5in;}
@list l1
	{mso-list-id:2105878558;
	mso-list-type:hybrid;
	mso-list-template-ids:355089164 1073481306 1639433 1770505 984073 1639433 1770505 984073 1639433 1770505;}
@list l1:level1
	{mso-level-start-at:2;
	mso-level-number-format:roman-upper;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.5in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
  </style>
</head>
<body style="" bgcolor="white" lang="EN-US">
<A NAME = "TOP"></A>
<h2 align="center">ETomo Tutorial for IMOD Version 4.3<br>
</h2>
<h3 align="center">Eileen O'Toole</h3>
<h3 align="center">Boulder Laboratory for 3-D Electron Microscopy of
Cells</h3>
<hr>
<div class="Section1">
<p class="MsoNormal"><span style="font-size: 14pt;"><b>
I.<span style="">&nbsp;</span>
Initial set up and viewing the raw tilt series:
<o:p></o:p></b></span></p>
<p class="MsoNormal">&nbsp;<o:p></o:p><br>
This tutorial contains a small, dual-axis sample data set and a
step-by-step guide to eTomo. The tutorial is not meant to be a
replacement for the Tomography Guide. Please refer to the more
comprehensive <a href="tomoguide.html#TOP">Tomography Guide</a> for
additional detail about each step. The sample data set was chosen
because you should get through the entire process with no problems! The
Tomography Guide is a good reference for trouble shooting and learning
more about the many programs that are used for computing dual-axis
tomograms.<br></p>
<p class="MsoNormal"><br></p>
<p class="MsoNormal">
To get started,
<a href="http://bio3d.colorado.edu/imod/files/tutorialData.tar.gz">download</a>
the sample data set from our web site.&nbsp; Unpack the data by typing:</p>
<p class="MsoNormal"><br>
&nbsp; &nbsp; &nbsp; &nbsp; 
<code>tar -xzf tutorialData.tar.gz<br></code>
</p>
<p class="MsoNormal"><br><code></code></p>
<p class="MsoNormal">
This will create a directory, <code>tutorialData</code>, containing
the two raw stacks needed to start the tutorial, named BBa.st and
BBb.st, respectively.&nbsp; There is also a
subdirectory, <b>finalFiles</b>, containing all of the small working
files left after completing the data set, as well a copy of the final
reconstruction.<br><br>
The file names reflect a convention that you will have to follow with
your own data sets:&nbsp; the raw stacks have the extension .st and dual axis
stacks have a common name then end in a.st and b.st.&nbsp; This extension is
just a convention and does not indicate the format of the image file.&nbsp; 
If you have
a data file in the right format but with a different extension (such as .mrc),
you just need to rename the file to have the extension .st instead.<br>
</p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal" style="font-weight: bold;"><font size="+1">II.<span
 style="">&nbsp; eTomo Setup</span></font></p>
<br>
<p class="MsoNormal">To start eTomo, type:</p>
<p class="MsoNormal"><br>
&nbsp; &nbsp; &nbsp; &nbsp; 
<code>etomo<br></code>
</p><br>
<p class="MsoNormal"><span style="color: black;"></span><o:p></o:p></p>
<p class="MsoNormal"></p>
<div style="text-align: center;"><img src="etomoImages/frontPage.png"
 title="" alt="">&nbsp; <br>
</div>
<p class="MsoNormal">When eTomo is first started, a <b>Front Page</b> panel
will come up (shown above), allowing you to select what operation you want to
perform with eTomo.&nbsp; At this point you can either start working on a
new data set by selecting <B>New Tomogram</B>
or open an existing data set under the <b>File</b>
menu.&nbsp;<br>
</p>
<div style="text-align: center;"><img src="etomoImages/setupwindow1.png"
 title="" alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">Press <B>New Tomogram</B> and the <b>Setup Tomogram</b>
panel
will come up (shown above).</p>
<p class="MsoNormal"><br>
To start working on a new data set, the following fields must be filled
out. The <b>Dataset name</b> is the name of the file containing the
raw, tilt series (or the root name if a dual axis data set was
collected).&nbsp; You can enter the <b>Dataset name</b> by clicking
on the yellow file selection associated with the <b>Dataset name</b>
field, or type in the directory path and file name directly in the
field. The <b>Backup directory </b>is an optional field to save small
working files every time you run a procedure.&nbsp; This field can be left
empty if you don't wish to use a backup directory. <br>
</p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal"><br>
Select whether the data set is <b>Single axis</b> or <b>Dual axis.</b>
The <b>Montage</b> option is available for processing montaged tilt
series. <br>
</p>
<p class="MsoNormal"><br>
The next fields specify pixel size (nm), the size of gold fiducials
(nm) and Image rotation (degrees).&nbsp; <b>Pixel size</b> (in
nm) is dependent on the microscope, camera, and magnification. The<b>
Image rotation</b> (tilt axis angle from vertical, in degrees)
will
also vary based on the microscope and magnification. Pressing the <b>Scan
Header</b> button will retrieve the <b>Pixel size</b> and <b>Image
rotation</b> values if these are specified in the MRC file
header.&nbsp; For this tutorial example, press <b>Scan Header</b> to define
the
pixel size for this data set (2.02) and Image rotation (-12.5). You
must
specify the size of the gold <b>Fiducial marker diameter</b> (10 nm). </p>
<p class="MsoNormal"><br>
If the <b>Parallel Processing</b> checkbox is enabled, uncheck it so
that your screen will look the same as the ones shown here. Parallel
processing, which is not covered in this tutorial, allows some
processes to be distributed across multiple computers or to multiple
processors on one computer. 
Leave the <span style="font-weight: bold;">Image distortion field file</span>
entry blank.&nbsp; This feature can be used to correct for nonlinear
image distortions if they have been measured and characterized, which
is particularly useful with data from an energy filter.<br>
</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">Specify the source of the tilt angles for either
one or both axes, as appropriate in the <b>Axis A</b> and, if necessary, the <b>Axis B</b> box(es). In this example, tilt angles are
stored in the extended header and so the default <b>Extract tilt angles from data</b>
should be used. You can also optionally specify individual projections
to exclude from processing steps.&nbsp; The syntax for this exclude
list
is a comma separated list of ranges (i.e. 1,4-5,60-70).&nbsp; Notice
that there is a also a button in this section to open the raw data file
for viewing in 3dmod.<br>
</p><br>
<p class="MsoNormal">It is useful to look at the raw tilt series files
in order to make decisions about preprocessing steps or to see if there
are any particular views <span style="color: black;">that have poor
image quality, and that you want to exclude from </span>the<span
 style="color: black;"> alignment and reconstruction.</span>&nbsp;</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">To determine if you have views that have poor
image quality (poor focus, etc.), open the raw stack(s) by pressing the <b>View
Raw Image Stack</b> button(s).  &nbsp;Movie through the raw tilt series images by
clicking the middle mouse button.&nbsp; Notice how the images jump around
slightly.&nbsp; Make note of any particular views that you want to exclude
from the alignment and reconstruction.&nbsp; In this sample data set, there
are no images that need to be excluded. <br>
<br>
</p>
<p class="MsoNormal"><br>
</p>
<div align="center"><img src="etomoImages/setupwindow2.png" title=""
 alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
Details specific for the tutorial sample data set are shown above. For
this sample data set, the <span style="font-weight: bold;">Dataset name</span>
is BBa.st, it is a dual axis set. The pixel size is 2.02 nm, the
fiducial diameter is 10 nm and the image rotation is -12.5 degrees.
Tilt angles for this data set are stored and extracted from the data
file.&nbsp;<span style=""> </span><br>
</p>
<p class="MsoNormal"><span style="font-size: 14pt;"><b> <o:p></o:p></b></span></p>
<p class="MsoNormal"><br>
Press the <span style="font-weight: bold;">Create Com Scripts</span>
button to move on to generating the tomograms. <br>
<span style="font-size: 14pt;"><b><br>
III. eTomo Main Window</b></span></p>
<p class="MsoNormal">
If you need to exit eTomo before finishing this tutorial, you can continue where
you left off by going to the <b>tutorialData</b> directory, which now contains your
dataset, and typing:
</p>
<p class="MsoNormal"><br>
&nbsp; &nbsp; &nbsp; &nbsp; 
<code>etomo BB.edf<br></code>
</p><br>
<p class="MsoNormal">The Main Window consists of several areas: on the
left is a column of buttons (Process Control Buttons) that allow you to
select a particular stage of tomogram computation to work on. On the
top is a Process Monitor that informs you of the status of the
current process or the last process completed.  To the left of the Process Monitor are the Axis Buttons which allow you to move between Axis A and Axis B.  The Main Window is currently open to Axis A<br>
<br>
</p>
<div align="center"><img src="etomoImages/mainwindow.png" title=""
 alt="">&nbsp; <br>
</div>
<p class="MsoNormal"></p>
<p class="MsoNormal"><br clear="all">
<br>
The Process Control Buttons are arranged in the suggested order of
processing from top to bottom.&nbsp; The buttons are color coded to
signify the stage of the process, where red indicates that the
process has not been started, magenta indicates that the process is
currently in progress, and green indicates that the process has been
completed.&nbsp; When one of the buttons is selected, the right side of the
window will fill in with information and fields associated with a
specific process.&nbsp; These forms are referred to as Process Panels.&nbsp; They allow you to modify the necessary parameters and execute
specific programs required by that processing step.&nbsp; The
parameters
and buttons on each Process Panel are typically laid out from top to
bottom in the order they should be executed, much like a flow chart.&nbsp; When you execute a process (by pressing a button on one of the
Process Panels) the Process Monitor will indicate what the process is
doing and when it is complete. <br>
</p>
<p class="MsoNormal"><span style="font-size: 14pt;"><b><br>
IV. Pre-Processing</b></span></p>
<p class="MsoNormal">If images were collected on the microscope using a
CCD camera, random x-rays hitting the CCD camera during collection of
the initial dark reference or individual images can cause extreme high or low 
pixel
values in your data file.&nbsp; As a result, these extreme values ruin the
contrast and can cause artifacts in the reconstruction. &nbsp;The example in
this tutorial does not have extreme pixel values.&nbsp; 
However, the procedure for removing these pixel values is outlined here to
give you a sense of the steps involved.&nbsp; First, a quick way
to determine if your file does have extreme pixel values is to look at
the Minimum and Maximum Density values in image header of the raw
stack.&nbsp; To do this, go to the command line terminal and type: </p>
<p class="MsoNormal"></p>
<h1><br>
</h1>
<h1 style="font-weight: normal;"><code>&nbsp; &nbsp;header BBa.st</code></h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal">Notice the minimum, maximum, and mean density values.
&nbsp; If the minimum density value is a negative number
or 0, then you probably have an extreme black pixel in your data set,
caused by an x-ray event during collection of the dark reference. &nbsp; If
you
have a high maximum density, then you have an extreme white pixel in
your data set.&nbsp; If extreme values are lurking somewhere in the data
set and a preprocessing step is needed to remove them, then you would press
the <B>Pre-processing</B> button to open this panel:

<div style="text-align: center;"><img src="etomoImages/preprocessing.png"
 title="" alt=""><br>
</div>
<p class="MsoNormal">
The basic steps involved in pre-processing (again, not needed for the tutorial
data set) are:</P>

<UL><LI><p class="MsoNormal">Press the <b>Show Min/Max for Raw Stack</b>
button to run <b>clip stats</b>, a program which displays the minimum and
maximum densities for each section, on the raw stack.</p>
<LI><p class="MsoNormal">Press the <b>Create Fixed Stack</b> button to create a second stack with X-rays removed.</p>
<LI><p class="MsoNormal">Press the <B>View Fixed Stack</B> button to view that
stack, and press the <b>Show Min/Max for Fixed Stack</b> button to run
<b>clips stats</b> on the fixed stack.</p>
<LI><p class="MsoNormal">If the contrast appears good in the display, and the
outliers from the raw stack <b>clip stats</b> output are gone from the fixed
stack output, then press the <b>Use Fixed Stack</b> button.</p>
</UL>
<p class="MsoNormal">
For details on this operation, refer to
the <a href="tomoguide.html#PRE-PROCESSING">Pre-Processing: Removing
X-Rays</a> section of the Tomography Guide. </p>
<span style="font-size: 14pt;"><b><br>
V. Coarse alignment.<o:p></o:p></b></span></p>
<p class="MsoNormal"> Press the <span style="font-weight: bold;">Coarse
Alignment</span> Process
Control Button to
proceed with creating a coarse-aligned stack.</p>
<p class="MsoNormal"><o:p></o:p></p>
<h1 align="center"> </h1>
<h1 align="center">&nbsp; <br>
</h1>
<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<div style="text-align: center;"><img src="etomoImages/coarseA1.png"
 title="" alt=""><br>
<br>
</div>
<h1 align="center">&nbsp; <br>
</h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><br>
</p>
<div style="text-align: center;"><img src="etomoImages/coarseA2.png"
 title="" alt=""><br>
</div>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"> Pressing the <b>Calculate Cross-Correlation</b>
button runs the program, Tiltxcorr. The program uses cross-correlation
to find an initial translational alignment between successive
images of a tilt series (i.e. just shifts in x and y). The output
file, BBa.prexf, contains a list of transforms (or recommended shifts)
that will be applied to the image data in the next step.<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
</p>
<h1 align="center">&nbsp; <br>
</h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><br>
</p>
<div style="text-align: center;"><img
 src="etomoImages/coarseA3.png" title="" alt=""><br>
</div>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"><br>
Pressing the <b>Generate Coarse Aligned Stack </b>button will run 2
programs.<span style=""> &nbsp;</span> Xftoxg takes the transforms
created by Tiltxcorr to obtain a single consistent, or &#8216;global&#8217; set of
alignments. These new transforms are then applied to the image data
using the program Newstack. The output file created is
BBa.preali. One can view the prealigned stack by pressing the <b>View
Aligned Stack in 3dmod </b>button. Large image shifts can be edited
manually using the the interactive program, Midas. This is not an issue
with this data set; see the <a
 href="tomoguide.html/#COARSE ALIGNMENT">COARSE
ALIGNMENT</a> section of the Tomography Guide for details. The <span
 style="font-weight: bold;">Tilt axis rotation</span> entry is used if
Midas is run, because Midas will rotate images so that the tilt axis is
vertical.&nbsp; The <span style="font-weight: bold;">Fiducialless
alignment</span> check box can be selected for making a tomogram
without a fiducial alignment; see <a
 href="tomoguide.html#Fiducialless Quick">Making a Quick Tomogram
with Correlation Alignment</a> in the Tomography Guide for
details.&nbsp; Once you are
satisfied with the prealigned stack, press the <b>Done</b> button to
proceed to the next step.</p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><span style="font-size: 14pt;"><b>&nbsp;<o:p></o:p></b></span></p>
<p class="MsoNormal"><span style="font-size: 14pt;"><b>VI. Creating a
fiducial model based on the position of gold particles.<o:p></o:p></b></span></p>
<h1>&nbsp;<o:p></o:p></h1>
<h1 align="center"><img src="etomoImages/fiducialA1.png" title="" alt="">&nbsp;
<br>
</h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><b>&nbsp;Press the </b><b>'Seed Fiducial Model'
button. </b><br>
<br>
</p>
<p class="MsoNormal">This will open BBa.preali in 3dmod and create an
empty model file named BBa.seed.  It will also bring up the Bead Fixer dialog box in <b>Make seed</b> mode with <b>Autocenter</b> checked.&nbsp;</p>
<div align="center"><img src="etomoImages/beadfixerSeed.png" title=""
 alt=""><br>
</div>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal">Go to section 31 by pressing the Insert key on
your keyboard (this will go directly to the middle section, which is
often the 0&deg; tilt).</p>
<p class="MsoNormal"></p>
<p class="MsoNormal" align="center">&nbsp; <br>
</p>
<div align="center"><img src="etomoImages/seedmodel1.jpg" title=""
 alt=""><br>
</div>
<p class="MsoNormal"></p>
<div align="center">&nbsp;&nbsp; &nbsp; <br>
</div>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal">In the Zap (image) window, place a model point in
the center of 20-40<span style="">&nbsp; </span>gold particles by
centering the cursor in the middle of the gold particle and pressing
the middle mouse button. With each new gold bead selected, hit the
&#8216;n&#8217; key on the keyboard. This creates a new contour for each new gold
bead.  Because <b>Autocenter</b> is checked, 3dmod should make sure that the model
point is positioned in the center of the gold bead.  In my example
(BBa.seed) I selected 25 gold particles; the model contains 1 object,
24 contours, with each contour having 1 point. <span style="">&nbsp;</span>Save
this &#8216;seed&#8217; model by going to File -&gt; Save model, or by hitting
the hot key 's'.  The model is referred to as a &#8216;seed&#8217; because it
contains model points on only one section. The next step uses this
model
as a seed from which a complete fiducial model is built. </p>
<p class="MsoNormal" align="center">&nbsp;<br>
</p>
<p class="MsoNormal"><b>Press the 'Track Seed Model' process
button.</b><br>
<br>
<b></b></p>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/fiducialA2.png" title="" alt=""> <o:p></o:p></p>
<p class="MsoNormal">This will run the Beadtrack program to find the
gold on all other sections. The output file created by tracka.com is
BBa.fid, which is the completed fiducial model. This computer-generated
model is not perfect, and so the next procedure involves an iterative
process to edit this fiducial model.</p>
<p class="MsoNormal" align="center">&nbsp;<br>
</p>
<p class="MsoNormal"><b>Press the 'Fix Fiducial Model' process
button.</h1>
</b><br>
<br>
<b></b></p>
<p class="MsoNormal" align="center"><img
 src="etomoImages/fiducialA3.png" title="" alt="">&nbsp; <o:p></o:p></p>
<p class="MsoNormal"><br>
This procedure will open the prealigned stack (BBa.preali) and the
fiducial model file (BBa.fid) in 3dmod. </p>
<p class="MsoNormal"><br>
<br>
<b></b></p>
<div align="center"><img src="etomoImages/3dmodmain.png" title="" alt="">
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; <img src="etomoImages/beadfixer.png"
 title="" alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
The Bead Fixer dialog box will come up in <b>Fill gaps</b> mode.  The Bead Fixer facilitates
editing the fiducial
model.</p>
<p class="MsoNormal"><br>
Hit<b> &#8216;Go to Next Gap&#8217;</b> by clicking on the button using the left
mouse button, or by using the spacebar as a hot key.&nbsp; This will
attach to a point (highlighted with a yellow circle) that has a missing
model point on an adjacent section. Use the Page Up key (when an up arrow
appears above the point) or the Page Down key (when a down arrow appears above the point) to
find the section with the missing point and use the middle mouse button
to add the point in the center of the gold particle. It is useful to
increase the magnification of the image with the &#8216;+&#8217; key and adjust the
contrast on the sections, especially at high tilt. Repeat <b>&#8216;Go
to&nbsp; Next Gap&#8217;</b> until the message, &#8216;<span
 style="font-weight: bold;">No more gaps found</span>&#8217; comes up in
the main 3dmod window. Save the model file,&nbsp; and hit the <span
 style="font-weight: bold;">Done</span> button to advance to the fine
alignment step.</p>
<h1><span style="font-weight: normal;">&nbsp;<o:p></o:p></span></h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1><span style="font-size: 14pt;">VII.<span style="">&nbsp; </span>Alignment
of serial tilts<o:p></o:p></span></h1>
<h1> <b><o:p></o:p></b></h1>
<h1><br>
</h1>
<p class="MsoNormal" align="left">The <b>Fine Alignment</b> panel is
organized with a set of three tabs to solve for various alignment
parameters. A general alignment is first done by pressing the <b>Compute
alignment</b> button at the bottom of the<b> Fine Alignment</b> box. <br>
<br>
</p>
<div align="center"><img src="etomoImages/finealignment1.png" title=""
 alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
This command file runs the program, Tiltalign, to solve for the
displacements, rotations, tilts and magnification differences in the
tilted views. The program uses the position of the gold particles in
the fiducial model and a variable metric minimization approach to find
the best fit. It creates a log file that gives a synopsis of what was
done. To access this log file, right click the mouse cursor over
the window region associated with the process. This will open a menu
that is split into three sections: the first section will allow you to
open the log files associated with the current process, the second
section will allow you to open up the man pages associated with the
current processes, and the final menu section opens the general help
guides. &nbsp;Select "Align axis:a log file" to open the log file.&nbsp;<b>
<o:p></o:p></b>This
will open a tabbed file that contains the complete log and short
sections from this log file. <br>
The <span style="font-weight: bold;">Errors</span> tab contains a mean
residual error and standard deviation and the ratio of measured values
to total unknowns. <br>
In my example, the first <span style="font-weight: bold;">Compute
Alignment</span> run gave a Residual error mean of 0.375<br>
<br>
</p>
<p class="MsoNormal" style="text-align: center;"><img
 src="etomoImages/alignlogerrors.png" title="" alt=""><br>
</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">The goal of the fine alignment step is to reduce
the Residual error mean to 0.2- 0.5. <br>
</p>
<p class="MsoNormal"><br>
The Tiltalign program also creates two model files that provide useful
information about the fiducial model.<span style="">&nbsp; </span>The
first (BBa.3dmod) displays a <span style="color: black;">3-D model of
the fiducials<o:p></o:p> based on their solved positions. </span>Fiducials
that are present on the two surfaces are assigned 2 different colors;
pink spheres on one side and green spheres on the other. Examine this
model by hitting the <b>View 3D Model</b> button on the bottom of the <b>Fine
Alignment</b> box:</p>
<p class="MsoNormal"><b>&nbsp;<o:p></o:p></b></p>
<h1><br>
</h1>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/3Dmodel1.png" title="" alt=""><img
 src="etomoImages/3Dmodel2.png" title="" alt="">&nbsp;<span style=""> </span><o:p></o:p></p>
<p class="MsoNormal"><br>
You should see a nice distribution of pink and green spheres across the
field of view. Rotate the model to view edge-on by holding down the
number 8 key on the keypad. You will see the separation of the two
surfaces with this view. Avoid using models that have a cluster of
fiducials in any one particular region because this will skew the
alignment. Close the 3dmodv window. <br>
</p>
<p class="MsoNormal"><br>
The second model Tiltalign produces is a residual vector model.
&nbsp;Press the '<b>View Residual Vectors</b>' button at the bottom of
the <b>Fine Alignment</b> box. This will open the prealigned stack in
3dmod and display the residual vector model on each section. </p>
<h1><b><br>
</b></h1>
<h1></h1>
<p class="MsoNormal" align="center"><b> <o:p></o:p></b></p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal" align="center"><img
 src="etomoImages/residualvector.jpg" title="" alt="">&nbsp; <br>
</p>
<p class="MsoNormal"><br>
The model will show the current model point as a red X, and the
position of the residual as a green X. This residual displacement is
expanded by a factor of 10 in order to distinguish it from the actual
model point, because displacements are often very small (<u>&lt;</u> 2
pixels). In large (&gt;2k x 2k) images the residual model will often
show large displacements in one area but not in other areas. In these
cases, the residual model helps to make decisions if local alignments
are needed. In this example, local alignments are not needed. It is
common to have larger residuals at the higher extreme tilts. Leave
3dmod open for the next several steps and press the <span
 style="font-weight: bold;">'View/Edit Fiducial Model'</span> button to
reload the fiducial model for editing.  This will bring up the Bead Fixer dialog box in <b>Fix big residuals</b> mode and load the aligna.log file.</p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><span style="font-weight: bold;">The following
iterative steps involve fixing fiducial points with large residuals.</span>
</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"><br>
<br>
</p>
<p class="MsoNormal" align="center"><img
 src="etomoImages/3dmod.png" alt="" style="">&nbsp;&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<img
 src="etomoImages/beadfixer2.png" title="" alt=""> &nbsp;<o:p></o:p></p>
<p class="MsoNormal"><br>
Click<span style="">&nbsp; </span>&#8216;<b>Go to Next Big Residual</b>&#8217; in
the <b>Bead Fixer</b> dialog box.</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">The model point that had the big residual will
have a red arrow pointing in the direction of the recommended move.
You&#8217;ll probably be able to see that the model point is not centered
properly on the gold. &nbsp;<span style="">&nbsp; </span>If you
click &#8216;<b>Move Point by Residual</b>&#8217; in the<b> Bead Fixer</b> dialog
box,
it will move the model point by the recommended amount. This works
most of the time, but if the recommendation looks wrong, you can move
it
by hand by centering the cursor over the middle of the gold bead and
then clicking the right mouse button.<br>
<br>
</p>
<p class="MsoNormal" style="text-align: center;"><img
 src="etomoImages/beadfixer4.png" title="" alt="">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; <img src="etomoImages/beadfixer5.png" title=""
 alt=""><br>
</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"><br>
<span style=""></span></p>
<p class="MsoNormal">Repeat selecting &#8216;<b>Go to Next Big Residual</b>&#8217;
and &#8216;<b>Move Point by Residual</b>&#8217; until no residuals are found. The
hot key <b>' </b>will cycle to the next residual and the hot key<b> ;</b>
will move point by residual. Save the model file and leave the file
open. <br>
</p>
<p class="MsoNormal"><br>
Access the aligna.log file and go to the Surface Angles tab.<br>
<br>
</p>
<div style="text-align: center;"><img
 src="etomoImages/alignlogsurface.png" title="" alt=""><br>
</div>
<p class="MsoNormal"></p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">Note the Total tilt angle change near the bottom (in
my example,
this value was -0.09). Put this value in the <span
 style="font-weight: bold;">Fine Alignment Volume Position Parameters</span>
box under <span style="font-weight: bold;">Total tilt angle offset</span>.
Press the&nbsp; Compute Alignment button again, then select &#8216;Reread log
file&#8217; in the Bead Fixer dialog window. Proceed in fixing model points
with large residuals. Save the model.&nbsp; <br>
</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"> If your data set has a good distribution of 
gold on both surfaces, you
can solve for distortion. Press the '<span style="font-weight: bold;">Global
Variables</span>' tab in the <span style="font-weight: bold;">Fine
Alignment</span> box:&nbsp;</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal" align="center"><img
 src="etomoImages/finealignAglobal.png" title="" alt="">&nbsp; <br>
</p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal"><br>
<span style=""></span></p>
<p class="MsoNormal"><span style="">Select the </span><span style=""> '<span
 style="font-weight: bold;">Full solution</span>' &nbsp;</span><span
 style="">option
in the <span style="font-weight: bold;">Distortion Solution Type</span>
area at the bottom of the panel. This will activate solving for two
types of distortion: X-axis stretch and Skew. Keep the default group
size and hit the '<span style="font-weight: bold;">Compute Alignment</span>'
button to run the alignment.  3dmod will re-read the log file when <b>Compute Alignment</b> is done.<br>
</span><b><o:p></o:p></b></p>
<p class="MsoNormal"><br>
Return to the 3dmod windows and repeat fixing the new residuals that
Tiltalign
came up with after solving for distortion.  Then press the <span
 style="font-weight: bold;">Save &amp; Run Tiltalign</span> button in
the Bead Fixer window to save the model and compute the
alignment.&nbsp; You can use this button to avoid having to go back to
eTomo, as long as you haven't changed any parameters in eTomo. After a
few runs of running the alignment and
checking model points in 3dmod, the final mean residual should come
down to 0.2-0.4.&nbsp;&nbsp; In my example, the final Residual error
mean was 0.318.</p>
<p class="MsoNormal"><br>
</p>
<div style="text-align: center;"><img src="etomoImages/finalAerror.png"
 title="" alt=""><br>
</div>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h2>VIII.<span style="">&nbsp; </span>Sampling the data set to create
3 small reconstructions</h2>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoBodyText">The goal of the next step is to shift and rotate
your reconstruction so that it is as flat as possible and will fit into
the smallest volume. This is done by sampling three regions of the
tomogram, ones computed from near the top, middle, and bottom of the
tilt images. (When these samples are not adequate, you can do this
instead with a whole, binned down tomogram; see <a
 href="tomoguide.html/#Whole Tomogram Positioning">Positioning with
a Whole Tomogram</a> in the Tomography Guide for details.)&nbsp; There
are two rotations which can be adjusted: the
rotation about the tilt axis, to make the section level when viewed in
the X-Z plane; and a rotation about the X axis, to make the section
come out at the same Z height throughout the length of the tomogram.<br>
</p>
<p class="MsoBodyText"><br>
Increase the Sample tomogram thickness to 200.&nbsp; This will create a
reconstruction that is much thicker than the original section.</p>
<p class="MsoNormal"><b>&nbsp;<o:p></o:p></b><br>
<span style="font-weight: bold;"> Press Create Sample Tomograms</span></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<div align="center"><img src="etomoImages/TomopositionA2.png" title=""
 alt="">&nbsp; <br>
<br>
</div>
<p class="MsoNormal">This command file first extracts and aligns a
60 pixel sliver from the top, middle, and bottom of the image stack.
The
program then uses these samples to create 10 slices of the
reconstruction from the top, middle, and bottom of the aligned stack.
These output files are named topa.rec, mida.rec, bota.rec.  Press <b>Create Boundary Models</b></p>
<p class="MsoNormal"><b>&nbsp;<o:p></o:p></b><br>
<span style="font-weight: bold;">This step involves creating a model to
define the top and bottom surfaces of each reconstruction.</span> </p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal">When&nbsp; the '<span style="font-weight: bold;">Create
Boundary Models</span>' is pressed, 3dmod will read in all three
reconstructions at once, with the topa.rec displayed first and viewed
edge on. 3dmod will also start with an empty model, named
tomopitcha.mod.<br>
<br>
</p>
<div align="center"><img src="etomoImages/TomopositionA4.png" title=""
 alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
The top bar of the Zap window has a feature &#8216;4<sup>th</sup> D&#8217; and a
backward and forward arrow. If you click the forward arrow, you can
cycle through to the mida.rec and bota.rec reconstructions,
respectively. Start with the topa.rec. Use the contrast sliders to
adjust contrast.&nbsp; Notice the material in the center of the volume
with a mottled appearance. This is the part of the reconstruction with
biological material.&nbsp; Using the middle mouse button, place one
model point at the left side of the top surface that defines the region
containing the biological material, and a second model point at the
right side of the top surface. A line will connect the two points. Model the bottom surface of the section with
2 points on the left and right sides, respectively. Toggle to the
mid.rec and bot.rec file by hitting the arrow button to the right of &#8216;4<sup>th</sup>
D&#8217; at the top of the zap window. Repeat modeling the top and bottom
surfaces of the other two reconstructions. The final model should have 1 object and 6
contours, and each contour should have 2 model points.&nbsp; Save this
model file.</p>
<p class="MsoNormal">It is generally helpful for the thickness of the final
tomogram to be about 10 to 20 pixels greater than the actual distance between the lines
that you draw.&nbsp; You can adjust the entry in <b>Added border thickness</b> to
accomplish this.&nbsp; The default value of 5 will make the tomogram 10 pixels
thicker; change it to 10 to make it 20 pixels thicker.</p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1>&nbsp;Press 'Compute Z Shift and Pitch Angles' </h1>
<h1 align="center"><span style="font-weight: normal;"> <o:p></o:p></span></h1>
<h1><span style="font-weight: normal;">Based on these model contours,
tomopitch determines parameters to make the reconstruction as flat as
possible and to fit in the smallest volume as possible.&nbsp; This command
file creates an output file &#8216;tomopitcha.log&#8217;. &nbsp;This log
&nbsp;file will automatically open &nbsp;after the program is finished.
<o:p></o:p></span></h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/TomopositionA5.png" title="" alt=""> <o:p></o:p></p>
<h2>IX. The final runs to create the full-size tomogram</h2>
<p class="MsoNormal"><span style="font-size: 14pt;"><b>&nbsp;<o:p></o:p></b></span><br>
&nbsp;Right click on the <b>Tomogram Positioning</b> dialog and open the <b>Tomopitch log file</b>.  An example of the tomopitcha.log from my example is shown
below: <br>
<br>
</p>
<h1><o:p></o:p></h1>
<h1 align="center"><img src="etomoImages/TomopositionA6.png" title=""
 alt="">&nbsp; <br>
</h1>
<h1><br>
</h1>
<p class="MsoNormal">The bottom of the log file contains information
calculated from all three positions. These offsets are automatically added to the existing <b>Angle offset</b>, <b>Z shift</b> and <b>X axis tilt</b> values.  The <b>Added</b> values correspond to the values mentioned in the fifth paragraph in the tomopitch log ("Pitch betwen samples can be corrected...") and must be added to the existing values and entered by the user if eTomo doesn't enter them (Look for the "added X-axis tilt", "total angle offset", and "added Z shift").  The <b>Final tomogram thickness</b> is also entered by eTomo from the tomopitch log.</p>
<br>
<p class="MsoNormal">Press the <span
 style="font-weight: bold;">Create Final Alignment</span> button.
&nbsp;
After the final alignment transforms are created, press the <span
 style="font-weight: bold;">Done</span> button to advance to the next
step.<br>
<br>
</p>
<h1 align="center"><img src="etomoImages/TomopositionA7.png" title=""
 alt="">&nbsp; <br>
</h1>
<h1><br>
</h1>
<h1><br>
</h1>
<h1><font size="+1"></font></h1>
<h1></h1>
<p class="MsoNormal"> <o:p></o:p></p>
<h1><span style="font-weight: normal;"><o:p></o:p></span></h1>
<p class="MsoNormal"><o:p></o:p></p>
<h1><br>
</h1>
<h1>Press 'Create Full Aligned Stack'</h1>
<p class="MsoNormal"><b></b>This
command will apply the alignment transforms to the full-sized image for
the final, aligned stack. The output file is named BBa.ali <br>
</p>
<h1>&nbsp;<o:p></o:p></h1>
<h1><o:p></o:p></h1>
<h1></h1>
<div align="center"><img src="etomoImages/FullAlignedStackA1.png" title="" alt="">&nbsp;
<br>
</div>
<h1><span style="font-weight: normal;"></span></h1>
<h1><br>
<span style="font-weight: normal;"></span></h1>
<h1><span style="font-weight: normal;">The full aligned stack may be
viewed by pressing <span style="font-weight: bold;">View Full Aligned
Stack</span>, although this is not necessary.&nbsp; There are
optional steps for CTF correction, erasing fiducials, and filtering the
aligned stack, which are also not needed
here.&nbsp; Press the <span
 style="font-weight: bold;">Done</span> button to advance to the next
step.<br>
</h1>
<h1><br>
</h1>
<h1><br>
</h1>
<h1><font size="+1"></font></h1>
<h1></h1>
<p class="MsoNormal">The default filtering parameters in the <span
 style="font-weight: bold;">Tilt Parameters</span> section are
appropriate for many cases, but can be changed, or the aligned stack
can be filtered, to reduce noise in the reconstruction (see the <a
 href="tomoguide.html/#TOMOGRAM GENERATION">TOMOGRAM GENERATION</a>
section of the Tomography Guide for details).&nbsp;</p><br>
</span></h1>
<h1><br>
</h1>
<br>
<h1 style="text-align: center;"><span style="font-weight: normal;"><img
 src="etomoImages/TomogenA1.png" title="" alt="">&nbsp;<o:p></o:p></span></h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1>Press 'Generate Tomogram'</h1>
<p class="MsoNormal">When the tomogram is computed,&nbsp; examine it by
pressing <span style="font-weight: bold;">View Tomogram in 3dmod</span>.
You may also choose to <span style="font-weight: bold;">Delete Intermediate
Image Stacks</span> at this point to save space. <br>
Movie through the reconstruction by hitting the middle mouse button to
step through serial, tomographic slices from the top surface of the
tomogram to the bottom surface.&nbsp;</p>
<h1><o:p></o:p></h1>
<p class="MsoNormal"><b><br>
<font size="+1">X. On to the second axis (Axis B):</font> </b></p>
<p class="MsoNormal"><br>
<div style="text-align: center;"><img src="etomoImages/axisButtonsA1.png"
 title="" alt="">&nbsp; <br>
</div>
<p class="MsoNormal"><br>
To see the B Axis, press the <b>Axis B</b> button at the top of the Etomo window.  This will bring up another set of process buttons which can be used to perform the operations for aligning the Axis B tilt series and calculating the tomogram.  To prevent confusion, Axis A has a blue background and Axis B has a green background.
</p>
<p class="MsoNormal"><br>
On the right-hand side of the eTomo main window are the process buttons
to perform the operations for aligning the <b>Axis B</b> tilt series
and
calculating the tomogram. Again, the Pre-processing step is not
required
for this sample data set. Go to the <b>Coarse Alignment</b> steps, as
described above for Axis A.<br>
</p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1 align="center"><br>
</h1>
<p class="MsoNormal"><b> <o:p></o:p></b></p>
<p class="MsoNormal"><b><o:p></o:p></b></p>
<p class="MsoNormal" style="text-align: center;"><img
 src="etomoImages/coarseB1.png" title="" alt="">&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;</p>
<br>
<p class="MsoNormal" style="text-align: center;"><img src="etomoImages/coarseB2.png" title=""
 alt=""> &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; <br>
</p>
<p class="MsoNormal" align="center"><b> <o:p></o:p></b></p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal"><br>
<br>
<b><span style=""></span></b></p>
<div align="center"><b><span style="">&nbsp; </span></b><br>
<b><span style=""></span></b></div>
<p class="MsoNormal"><b><span style="">&nbsp;</span></b><span
 style="font-weight: normal;">After the coarse-aligned stack has been
generated, press <span style="font-weight: bold;">Done</span> to
advance
to the next step. <br>
In order to combine both tilt axes <span style="color: black;">at
least some (8-10) of the beads that you track must be the same in the
two series. </span>To accomplish this, use the program Transferfid.</span></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1>&nbsp;Press 'Transfer Fiducials From Other Axis'</h1><br>
<div align="center"><span style="color: black;"><img
 src="etomoImages/transferfid.png" title="" alt="">&nbsp; </span><br>
<span style="color: black;"></span></div>
<br><p class="MsoNormal"><span style="color: black;">&nbsp;Pressing the <span
 style="font-weight: bold;">Transfer Fiducials From Other Axis</span>
button will run the shell script, Transferfid, that creates a seed model for the second axis based on the fiducial model from the
first axis.<span style="">&nbsp; </span>The program will search for
the pair of views in the two series that correspond the best, then
transfer the fiducials from the first series to make the seed model for
the second series. At the end, the program indicates how corresponding
fiducials should be specified when setting up to combine the tomograms
and this information is stored in the transferfid.log file. The log
file from my example is:&nbsp;<br>
<br></span></p>
<div align="center"><span style="color: black;"><img
 src="etomoImages/transferfid1.png" title="" alt="">&nbsp; </span><br>
<span style="color: black;"></span></div>
<h1>&nbsp;<o:p></o:p></h1>
<h1><br>
</h1>
<h1><br>
</h1>
<h1><br>
</h1>
<h1><span style="font-weight: normal;">The transferfid log file
will list the fiducial correspondence between the first and second
axes. Do not worry if a few fiducials failed to transfer.
In this example, all 27 fiducials correspond:</span></h1>
<h1><span style="font-weight: normal;"><o:p></o:p></span></h1>
<p class="MsoNormal"></p>
<h1><code style="font-weight: normal;">&nbsp;&nbsp; &nbsp; Points in A:
1-27</code><code><b>&nbsp;</b></code></h1>
<h1><code><b>&nbsp; &nbsp; &nbsp;</b><span style="font-weight: normal;">Points
in B: 1-27</span></code><br>
</h1>
<h1><br>
<span style="font-weight: normal;"></span></h1>
<h1><span style="font-weight: normal;">The output file of transferfid
is the seed model for the second axis. In this example, the model is
named BBb.seed. Proceed to <span style="font-weight: bold;">Track
Fiducial Seed Model</span> in the Axis B window. <br>
</span></h1>
<div align="center"><br>
<img src="etomoImages/trackB.png" title="" alt="">&nbsp; <br>
</div>
<br>
<h1><span style="font-weight: normal;">This will automatically track
the fiducials for the &#8216;B&#8217; set. Fix the gaps in the BBb.fid file by
pressing the <b>Fix Fiducial Model Using Bead Fixer</b> as outlined
above for the A axis. When all gaps are found,&nbsp; press <b>&nbsp;Done</b>
to proceed to the<b> Fine Alignment</b> and <b>Tomogram</b>
calculation
steps.</span></h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal">You will now proceed with the same steps following
the same procedure as outlined above for the Axis A set. Briefly:</p>
<h1>&nbsp;<o:p></o:p></h1>
<h1>&nbsp;Press 'Compute Alignment' for General and Global variable
tabs in the Fine Alignment box.</h1>
<p class="MsoNormal">At this point, you will start&nbsp; the iterative
alignment procedure as you did for the &#8216;A&#8217; set by&nbsp; editing model
points with large residuals, saving the model, and computing the
alignment.<span style=""> When the alignment is complete, press <span
 style="font-weight: bold;">Done</span> and proceed with the tomogram
generation steps. </span></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1>Proceed with 'Tomogram Positioning' as outlined above for the A
Axis.&nbsp;</h1>
<p class="MsoNormal"><b>Proceed with 'Final Aligned Stack' steps as
outlined above for the A Axis.</b></p>
<p class="MsoNormal"><b>Proceed with 'Tomogram Generation' steps as
outlined above for the A Axis.</b></p>
<p class="MsoNormal"><br>
</p>
<h1></h1>
<p class="MsoNormal"><b><o:p></o:p></b></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1><font size="+1">XI. Combining the two axes</font></h1>
<p class="MsoNormal"><br>
<div style="text-align: center;"><img src="etomoImages/axisButtonsB1.png"
 title="" alt="">&nbsp; <br>
</div>
<p class="MsoNormal">Go back to the A Axis by pressing the <b>Axis A</b> button.</p>
<p class="MsoNormal">To combine the two tomograms press the <b>Tomogram Combination</b> process button.</p>
<h1 align="center">&nbsp;<img src="etomoImages/combine.png" title=""
 alt=""> <o:p></o:p></h1>
<h1>Tomogram Combination Panel</h1>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal">The <span style="font-weight: bold;">Tomogram
Combination Panel</span> is organized with 3 tabs: <span
 style="font-weight: bold;">Setup</span>, <span
 style="font-weight: bold;">Initial Match</span>, and <span
 style="font-weight: bold;">Final Match</span>. <br>
</p>
<p class="MsoNormal"><br>
The <span style="font-weight: bold;">Setup</span> window is where
information is given about the particular data set. The first section
describes the <span style="font-weight: bold;">Tomogram Matching
Relationship</span>. It is most common to match the B tomogram to A.<br>
</p>
<p class="MsoNormal"><br>
The <span style="font-weight: bold;">Solvematch Parameters</span>
box asks for information on the fiducial marker distribution. In this
example, fiducials are on both sides. For this data set, the programs
will have no trouble fitting to all of the points at once,
so it is not necessary to fill out <b>Starting points to use from A</b>.&nbsp;</p>
<p class="MsoNormal"><br>
</p>
<p class="MsoNormal">The next section contains information for <span
 style="font-weight: bold;">Patch Parameters for Refining the Alignment</span>
using local 3D cross-correlations.&nbsp; Select <b>Small patches</b>.&nbsp; Either <span
 style="font-weight: bold;">Medium patches</span> or <b>Large patches</b> are needed
for most data sets, but this data set has been binned to reduce its size, so
small patches have plenty of information in them.&nbsp; When specifying the limits
of the volume from which the patches will be extracted, it is important
to look at the tomogram being matched to. Using the entire Z axis range
will almost never work, and even for the X and Y axes it may not be
good
to use the defaults.&nbsp; To find the limits, press the <span
 style="font-weight: bold;">3dmod Volume A</span> button at the bottom
of the panel. &nbsp; This will open BBa.rec in 3dmod. Step through the
images and decide what range of the X axis, Y axis and Z axis contains
useful information for matching up the volumes. In this example,
defaults were kept for the X and Y axis.</p>
<p class="MsoNormal"><o:p></o:p></p><br>
<p class="MsoNormal">In this example <b>Z axis min</b> and <b>Z axis max</b>
where set to the first and last slices where about half the material in the slice
is not blurry (18 and 69).</p><br>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/volA1.jpg" title="" alt=""><img
 src="etomoImages/volA2.jpg" title="" alt="">&nbsp;<span style=""> </span><o:p></o:p></p>
<p class="MsoNormal">
Sometimes, this will not eliminate &#8220;empty&#8221;
regions well enough to allow the two axes to combine.&nbsp; In that case, you have to
make a patch region model. &nbsp;To make a patch region model, check the
box "Use patch region model file" and press the <span
 style="font-weight: bold;">Create/Edit Patch Region Model</span>
button to open up the axis that is being matched to.&nbsp; In model mode,
trace closed contours around the areas that contain biological
material. &nbsp;Do this every 10 slices or so in the tomogram.&nbsp; Save the
model, which is named patch_region.mod.&nbsp; Creating the patch region model
is particularly useful when reconstructing data sets that have large
amounts of resin or open areas in the images.&nbsp; This example
data set does not need a patch region model.&nbsp;</p>
<p class="MsoNormal">&nbsp;<br>
When the parameters for the <span style="font-weight: bold;">Setup
panel</span> have been entered, press <span style="font-weight: bold;">Create
Combine Scripts</span> to create a series of command files that
will run various programs in the combine procedure.&nbsp; Ignore the warning message
that pops up.&nbsp; Press <span
 style="font-weight: bold;">Start Combine</span> to begin the process
of dual-axis tomogram combination.&nbsp; eTomo will automatically
advance &nbsp;to the <span style="font-weight: bold;">Initial Match </span>and
finally the <span style="font-weight: bold;">Final Match</span> tabs
as
various programs are being run. &nbsp;<br>
<o:p></o:p></p>
<p class="MsoNormal"><br>
After tomogram combination is complete, press <span
 style="font-weight: bold;">Open Combined Volume</span> to view the
final tomogram. Press <span style="font-weight: bold;">Done</span> to
advance to the final steps.<br>
</p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1><font size="+1">XII. &nbsp;Post-Processing and Clean-up of
intermediate files.</font></h1>
<br>
<p class="MsoNormal">Post-processing
involves a volume trimming and byte scaling step, followed by deletion
of intermediate files.&nbsp; There are also options to flatten the volume and
to create a squeezed
down volume; both of these can be useful when working with very large data
sets, and the flattening is
particularly helpful when reconstructing serial sections.&nbsp;&nbsp;</p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
<h1 style="text-align: center;"><img src="etomoImages/trim.png" title=""
 alt=""></h1>
<br>
<p class="MsoNormal">
The final reconstruction of the two axes
combined
into one will always be called sum.rec.&nbsp; (If you have a single axis data
set, the name of the reconstruction file at this point will be the data set name
followed by _full.rec.)&nbsp; Open the sum.rec reconstruction
by pressing <b>3dmod Full Volume</b>. <span style="color: black;">Step
through the reconstruction and determine the &nbsp;X,Y and Z ranges
for the final volume. &nbsp;A convenient way to set the X and Y range is to
turn on the rubberband with the dashed rectangle in the toolbar of the
Zap window, press the left mouse button over the upper left corner of
the desired area, and drag the mouse to the lower right corner. &nbsp;Z can
also be set, if desired; press <b>Lo</b> to set the minimum Z and <b>Hi</b>
to set the maximum Z.  &nbsp;When
you press <span style="font-weight: bold;">Get XYZ Volume Range from
3dmod,</span> eTomo will retrieve the X and Y values of the rubberband (and Z values if they are set)
from 3dmod. &nbsp;In this example, the default ranges for X and Y
are used. &nbsp;The Z axis (in the flipped tomogram) range has been set from
a Z min of 19 to a Z max of 67 to exclude non-cellular material.&nbsp;
Finally a scaling range is set to find the range of slices that exclude
the gold beads. &nbsp;In this example, the scaling is section based and has a
range between slices 24 and 70 (see below to enter these numbers using 3dmod).</p>
<br>
<p class="MsoNormal">Sometimes it is not possible to find a range of slices that contain no
gold.&nbsp;  For example, the sample used here contains some gold particles on the
plastic resin outside the cell that show up in the same slices that we would
like to
use for scaling.&nbsp;
Limiting the X and Y scaling range to exclude any such gold particles will
improve the contrast of the final
tomogram.&nbsp;  Press the <b>3dmod Full Volume</b> button and bring up the ZaP
Window.&nbsp; Go to a slice which shows gold particles and put a
rubberband around an area that excludes them.&nbsp; To do this, press
the rubberband toggle to the left of the Z slider.</p><br>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/rubberband1.png" title="" alt="">&nbsp;<span style=""> </span><o:p></o:p></p>
<br><p class="MsoNormal">Press the left mouse button over the upper left corner of
the desired area, and drag the mouse to the lower right corner.&nbsp;  Then
move the Z slider to lower part of the scaling range (24) and press 
<b>Lo</b>.&nbsp;  Move the Z slider to the upper part of the scaling range (70) and press <b>Hi</b>.</p><br>
<p class="MsoNormal" align="center">&nbsp;<img
 src="etomoImages/rubberband2.jpg" title="" alt="">&nbsp;<span style=""> </span><o:p></o:p></p>
<p class="MsoNormal">Go to the <b>Scaling</b> box in eTomo and press the
<b>Get XYZ Sub-Area From 3dmod</b> button.  This will cause the eTomo to retrieve
X, Y, and Z values you selected.&nbsp; Press the <b>Trim Volume</b> button
to run Trimvol.&nbsp; Trimvol is a single tool for trimming a volume and
converting it to bytes.&nbsp; Finally, view the final, trimmed volume
(named BB.rec) by pressing <b>3dmod Trimmed Volume</b>.&nbsp; Press <span
 style="font-weight: bold;">Done </span>to proceed to file cleanup. </span>
<h1><br>
</h1>
<h1>Cleanup of intermediate files:</h1>
<p class="MsoNormal"><o:p></o:p></p>
<p class="MsoNormal" align="center"> &nbsp;<o:p></o:p></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
</div>
<div style="text-align: center;"><img src="etomoImages/delete.png"
 title="" alt=""><br>
</div>
<br>
<p class="MsoNormal">Cleaning up of your files is very important!&nbsp; The tomogram generation
process creates many large, intermediate files. &nbsp;The <span
 style="font-weight: bold;">Intermediate file cleanup</span> box lists
what we consider intermediate, nonessential files that can be
deleted. &nbsp;Once you are satisfied that the final tomogram is truly final,
you can select by highlighting the intermediate files and hitting the <span
 style="font-weight: bold;">Delete Selected</span> button.</p><br>
<br>
<p class="MsoNormal">The final, dual-axis tomogram is named BB.rec and can be viewed outside
of eTomo using the command, 3dmod BB.rec.&nbsp; Refer to the <a
 href="3dmodguide.html#TOP">Introduction to 3dmod</a> for information about
modeling the many cellular features in the tomogram.&nbsp; This was an
easy data set and you will likely encounter more problems with your own
data, so it is best to read through the <a href="tomoguide.html#TOP">Tomography
Guide</a> as you start working on a real data set.&nbsp; Also, you will
be able to use eTomo more effectively if you read&nbsp;<a
 href="UsingEtomo.html#TOP">Using eTomo</a> , which explains features such
as accessing help and setting up parallel processing.</p><br>
<br>
</body>
</html>
