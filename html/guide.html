<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><title>IMOD User's Guide</title></head><body> 
<h1>IMOD Users's Guide for Version 2.7.5</h1>

<hr>
<h3>Table of Contents</h3>

<ul>
<li>Chapter 1 <a href="#Installation">Installation</a>
</li><li>Chapter 2 <a href="#Getting%20Started">Getting Started</a>
</li><li>Chapter 3 <a href="#Aligning%20Images">Aligning Images</a>
</li><li>Chapter 4 <a href="#Building%20Models">Building Models</a>
</li><li>Chapter 5 <a href="#Viewing%20Models">Viewing Models</a>
</li><li>Chapter 6 <a href="#Special">Special Help Topics</a>
</li></ul>
<p>
There is also a <a href="program_listing.html">reference guide</a> 
that gives a
description of each IMOD program and a link to its man page.
</p><hr>

<dl><dt><a name="Installation"><h3>Chapter 1: Installation</h3></a>

</dt><dd>
<h4>Setting Up a PC to Run IMOD.</h4>
The recommended configuration for running the IMOD software is:
<p>
Processor:  Intel Pentium III or 4 or AMD Athlon
<br>
Video Card:  GeForce 2 MX, Geforce2 GTS, Geforce2 GTS 
Ultra, GeForce3, GeForce 4 (64 MB or 128 MB cards preferred)
<br>
Minimum memory size:  256MB
<br>
Minimum disk size:          10 GB
<br>
Operating System:  Red Hat 7.3 or higher Workstation class installation<br>
Nvidia Linux device drivers and OpenGL libraries from
<a href="http://www.nvidia.com">Nvidia</a>, at least version 3123 or higher.
<br>
For Red Hat 7.1 - 7.3, to work with files bigger than 2 GB, version 6.11 or
higher of <code>tcsh</code>.
<br>
</p><p>
The required or recommended steps for each operating system are:
</p><p>
<b>Red Hat 8.0</b>
</p><ul>
<li>Nvidia installation
</li><li>Window manager settings
</li></ul>
<p>
<b>Red Hat 7.3</b>
</p><ul>
<li>Nvidia installation
</li><li>Qt 3.0.5 upgrade
</li><li>Window manager settings
</li><li>tcsh for large files
</li></ul>
<p>
<b>Nvidia installation (all systems).</b> Installing Nvidia drivers has recently become much easier, but here are some
<a href="nvidia_install.txt">instructions</a> that may be helpful.  In addition, here is a sample of
a <a href="XF86Config7.1.txt">/etc/X11/XF86Config-4</a> file from Red Hat
7.1.
</p><p>

    <b>Qt 3.0.5 upgrade (Red Hat 7.3).</b> 3dmod for Red Hat 7.3 was compiled against version 3.0.5 of Qt and will not run on the basic installation of 7.3.  Use <code>rpm -qa | grep qt</code> to check which version is installed. <code></code> To upgrade, download <a href="http://bio3d.colorado.edu/imod/rh7.3/qt-3.0.5-7.14.i386.rpm">Qt 3.0.5</a> and, as root, enter <code>rpm -Uhv qt-3.0.5*.rpm .</code> </p></dd><dd>
    <p><b>Window manager settings (all systems).</b>  To keep 3dmod from bogging down
when it is displaying complex models, the window
manager needs to be set to display only the outline and not the contents of windows when they are moved or resized. 
In Red Hat 7.3, this could be done by selecting "box" rather than "opaque"
in the "Moving and Resizing" panel of the Gnome control center.  In Red Hat 8.0, this
cannot be done under Gnome but it can under KDE, by selecting the menu entry
"Preferences - Look and Feel - Window Behavior" then the "Moving" panel.
 </p>
<p>
<b>tcsh for large files (Red Hat 7.1 - 7.3).</b>  As of IMOD 2.6.0,
programs have been compiled to work with files bigger than 2
GB.  However, the <code>tcsh 6.10</code> distributed with Red Hat 7.1-7.3 has
problems with large files,
and some of the IMOD shell scripts will fail with large files under this tcsh.
For doing
tomography with large files, you need to upgrade to <code>tcsh 6.11</code>,
which is available as an
<a href="http://bio3d.colorado.edu/imod/rh7.3/tcsh-6.11-3mdk.i586.rpm">rpm</a>.
The <code>tcsh 6.12</code> included with Red Hat 8.0 will also work.

</p><h4>Installing IMOD.</h4>
All of the IMOD programs are available via the 
<a href="http://bio3d.colorado.edu/imod/download.html">IMOD Download Page</a>
The distribution is bundled together using the Unix tar program and compressed
using the gzip program.
<p>
The easiest thing to do is to install to our recommended location,
/usr/local/IMOD.  The following steps are used in this case.
</p><ol>
<li> Log in as root or do all of these commands with sudo
</li><li> cd to the directory where you downloaded IMOD, and 
<br><code> mv imod_3.0.8_rh8.0.tar.gz /usr/local</code>
</li><li><code> cd /usr/local</code>
</li><li><code> gunzip imod_3.0.8_rh8.0.tar.gz</code>
</li><li><code> tar xvf imod_3.0.8_rh8.0.tar</code>
</li><li>To see if you already have a /usr/local/IMOD,
<br><code> ls -l</code>
</li><li>If you do have a /usr/local/IMOD and it is a link (e.g., it shows up as
<code> IMOD -&gt; imod_2.7.6</code>), then enter
<br><code> rm IMOD</code>
<br>Otherwise, rename the existing directory, e.g.:
<br><code> mv IMOD oldIMOD</code>
</li><li><code> ln -s IMOD imod_3.0.8</code>
</li><li> (A) Under Linux, enter
<br><code> cp IMOD/IMOD-linux.* /etc/profile.d</code>
<br> (B) On an SGI, insert the text in <code>IMOD/sgi.cshrc</code> into 
<code>/etc/cshrc</code>, specifically the command
<br><code>if (-e /usr/local/IMOD/IMOD-sgi.csh) source /usr/local/IMOD/IMOD-sgi.csh
</code></li></ol>

  </dd>
</dl>
<dl>
  <dd>If you want to install at another location, change <code>/usr/local/IMOD</code> to the name of the top IMOD directory in the relevant <code>IMOD-*.*</code> files and in the source command placed in <code>/etc/cshrc</code> on an SGI.</dd>
</dl>
<dl>
  <dd>If you do not want a system wide installation, instead of step 9 above, then under Linux, place the following in the <code>.cshrc</code> files of individual users of <code>tcsh</code> (where &lt;location of IMOD&gt; is the absolute path to the IMOD directory):</dd>
  <dd><code>setenv IMOD_DIR &lt;location of IMOD&gt;</code></dd>
  <dd><code>if (-e $IMOD_DIR/IMOD-linux.csh) source $IMOD_DIR/IMOD-linux.csh
    </code></dd>
</dl>
<dl>
<dd>or, place the following in the <code>.bashrc</code> of individual users under <code>bash</code>:</dd>
<dd><code>export IMOD_DIR=&lt;location of IMOD&gt;</code></dd>
<dd><code>if [ -e $IMOD_DIR/IMOD-linux.sh ] ; then source $IMOD_DIR/IMOD-linux.sh ; fi</code></dd>
</dl>
<dl>
<dd>or, on an SGI, place the following in the <code>.cshrc</code> files of individual users:</dd>
<dd><code>setenv IMOD_DIR &lt;location of IMOD&gt;</code></dd>
<dd><code>if (-e $IMOD_DIR/IMOD-sgi.csh) source $IMOD_DIR/IMOD-sgi.csh</code></dd>
</dl>
<dl>
<dd>Finally, if you just want to try running the programs in a particular
copy of IMOD, cd to the top IMOD directory and, on Linux under <code>tcsh</code>, enter:</dd>
<dd>  <code>setenv IMOD_DIR `pwd`</code></dd>
<dd><code>source IMOD-linux.csh
  </code></dd>
</dl>
<dl>
<dd>and similarly on the SGI, sourcing <code>IMOD-sgi.sh</code>.  On Linux under <code>bash</code>, enter:</dd>
  <dd><code>export IMOD_DIR=`pwd`</code></dd>
<dd><code>source IMOD-linux.sh</code></dd>
</dl>
<dl>
  <dd>
    <h4>TIFF Library Support.</h4>

The 3dmod program is able to read TIFF files if the library 
<code>libtiff.so</code>
is available.  Versions compiled for IRIX 6.5 and the PC under Linux assume 
that the library is available.
<p>
If you are trying to run a version that is compiled for the library but the 
library is not on your system, <code>3dmod</code> and several other programs 
will not run until
you rename a dummy library, <code>nolibtiff.so</code>, to 
<code>libtiff.so</code>.  From the top IMOD
directory, do the following:
</p><pre>cd lib<br>mv nolibtiff.so libtiff.so<br></pre>
and, on the SGI only, continue with:
<pre>cd ../lib32<br>mv nolibtiff.so libtiff.so<br></pre>
<p>
Conversely, if you have a version that does not assume the library and you do have the library (whose source you 
can obtain from 
<a href="ftp://ftp.sgi.com/graphics/tiff">SGI</a>), then to use the library, you need to
remove or rename the dummy <code>libtiff.so</code> in the 
<code>IMOD/lib</code> directory.



</p><h4>Fast Backprojection Support.</h4>
The Tilt program now contains a fast backprojection algorithm developed by
Gregory Beylkin and Kristian Sandberg at the University of Colorado.  This
method produces reconstructions 1.5-2.5 times faster, depending on the size of
the slice being reconstructed (the larger, the better).  It works when
there is tilt around the X-axis but not with local alignments.  
To take advantage
of the algorithm, you need a license to use the USFFT library, which is
commercial software for doing unequally spaced FFTs.  A license is free for
non-profit organizations.  To obtain a license, contact
<a href="mailto:mast@colorado.edu">
David Mastronarde</a> with a request
and a description of your institution.  Once you have the license, you need
to set environment variable USFFT2_LICENSE_FILE to point to the license file.
This is already done in the startup files suppiled with IMOD.  The
program will use standard backprojection if there is no license.  </dd>
<dt><hr><a name="Getting Started"><h3>Chapter 2: Getting Started.</h3></a>
The initial problem will be getting data into a format usable by
the IMOD programs.  
If you are having problems getting your data
into a format usable by IMOD contact us for help.


</dt><dd> <h4>The Image Data Format.</h4>
All of the IMOD programs use the  
<a href="mrc_format.txt">MRC image file format</a>.
We have utility programs available for converting TIFF files,
SGI rgb files and raw data into the MRC file format.
<p>
Use the program 
<a href="man/tif2mrc.html">tif2mrc</a> to convert a series of TIFF image 
files into a single MRC image file.  The <code>tif2mrc</code> program can
also subtract a background TIFF image if the -b option is used.
The following example will create a MRC file from a list of TIFF files
(cell01.tif, cell02.tif ...) and will subtract the background image
background.tiff from each of the image files.
</p><p><code>
tif2mrc -b background.tif cell??.tif  cell.mrc
</code>
</p><p>See the 
<a href="man/tif2mrc.html">tif2mrc manual page</a>
for more information on how to use 
<code>tif2mrc</code>.

</p><p>
The program 
<a href="man/raw2mrc.html">raw2mrc</a> is used to convert raw image data
into the mrc format.  This program can take a file of 8 or 16 bit integers, or
IEEE float values and convert them into an MRC image file.
In MRC files, the data start in the lower left hand
corner of the image, with the data stored in rows.  If the final MRC
image is upside down use the -f option in the initial
conversion or use the program 
<a href="man/clip.html">clip</a> to flip the
image back.

</p><p>
As of IMOD 2.6.20, our image file format was changed to conform to the
MRC image2000 standard.  Programs now read files in either the new or the old
format and write files in the new format.  Older versions of IMOD will 
interpret these new files as having strange origin values.  If you are running
an older version and you have to work with one of these files (or any MRC file
conforming to the new standard), you can fix the origin values with:
</p><pre>alterheader filename<br>org<br>0,0,0<br>done<br></pre>

</dd><dd> <h4>The Model Format.</h4>
<p>
If you already have a 3-D model and wish to view it within the IMOD
model viewing program, <code>imodv</code>, you will need to convert
the file into the IMOD format.  See the IMOD model file format 
<a href="asciispec.html">ASCII</a> and
<a href="binspec.html">binary specifications</a> 
if you wish to write your own conversion program.

Model files from the HVEM3D program can be converted to the IMOD
model format using the
<a href="man/rec2imod.html">rec2imod</a>
program.

</p><p>
The IMOD model format can be either binary or ASCII.  Currently supported
machines can all read and write binary model files interchangeably, so the
main use of the ASCII format would be to access the data for analysis or
conversion by other programs.
To convert a binary IMOD file (binary.imod) to an ASCII 
IMOD file (ascii.imod) use the 
<a href="man/imodinfo.html">imodinfo</a>
command :
</p><p><code>imodinfo -a binary.imod &gt; ascii.imod</code> <br>or
<br><code>imodinfo -a -f ascii.imod binary.imod</code>
<br>will both create an ASCII model file from the binary.imod model.
</p><p><i>
There exists an older model format which was used on our
VaxStation running the WIMP program.  The programs 
written in Fortran use the WIMP format internally.  They will read 
models in either WIMP or IMOD format and output models in IMOD format.
</i>



</p><p>

</p></dd><dt><hr>
<a name="Aligning Images"><h3>Chapter 3: Aligning Images.</h3></a>
</dt><dd>
Sometimes images in a data set are not in register with one another.
When this happens, a series of transforms will
need to be found that will align the whole stack of images.  
This series of transformations is obtained in
two stages.  First, each successive pair of images is considered
separately, and a transform is found that aligns the images when applied
to the second image in the pair.  This procedure yields a list of
transforms that align each image to the previous image; the programs
consistently refer to this as a list of "f" transforms.  If you think
about it, you will realize that simply applying these f transforms to all
of the images in the stack will not help, because each section would
be aligned to the previous one only if that previous one were not itself
transformed.  A second stage is thus necessary: one must obtain the
transforms for each image that will produce an aligned stack when actually
applied to the images.  This list is consistently referred to as a list of
"g" transforms.  In summary, "f" transforms align each section to the
preceding one; "g" transforms align each section to the whole stack.

<p>There are three general methods for obtaining alignment transforms:
manual adjustment of transformation parameters,
solving for a transform from a set of fiducial points that 
correspond between two sections, and
automated search for the best fit between two images.

</p></dd><dd> <h4>Manual Image Alignment</h4>
The program <a href="man/midas.html">midas</a>
is used for manual alignment or manual
adjustments to automated alignment of images.
<code>Midas</code> can be used to create a transform list or to edit an 
existing list;
it can work with either "f" or "g" transform lists.
To get a "g" transform list from an "f" transform list use the
<a href="man/xftoxg.html">xftoxg</a>
program.  <code>xftoxg</code> has options to 
leave long term trends in the data, which are invoked by default when
you call it with the <code>xf2xg</code> shell script.


</dd><dd> <h4>Image Alignment using Fiducial Markers.</h4>

The program <a href="man/xfmodel.html">xfmodel</a> 
will create a list of xf transforms from
a model containing fiducial points.  
See the chapter on <a href="#Building%20Models">Building Models</a>
to see how to make models.

<p>
Steps and Programs used in fiducial marker alignment.
</p><ul>
	<li><code>imod</code> : Creates a model in which points in each contour
are placed on adjacent sections that mark the same area on 
both sections.  Note that a single contour corresponds to a single fiducial
marker, and the contour contains a point on each of the sections where the
marker appears.  These are contours that pass between sections rather 
than being confined to a single section.
	</li><li><code>xfmodel</code> : Creates a "f" transform list.
	</li><li><code>xftoxg</code> : Creates a "g" transform list, leaving in long
term trends in the data.
	</li><li><code>newstack</code> : Creates an aligned image stack.
</li></ul>


</dd><dd> <h4>Automatic Image Alignment</h4>
Several programs are used for automated image alignment.  The programs
used are 
<a href="man/xfalign.html">xfalign</a>, 
<a href="man/xftoxg.html">xftoxg</a>, 
<a href="man/midas.html">midas</a> and
<a href="man/newstack.html">newstack</a>.  

Xfalign is a csh script that 
generates a
"f" transform list using the <a href="man/xfsimplex.html">xfsimplex</a>
program.  It can prefilter images using the 
<a href="man/enhance.html">enhance</a> program.  
It also has an option to get an initial alignment of the images by
cross-correlation, in case images are not already roughly aligned.
 
<p>Steps and programs used in automatic image alignment:
</p><ul>

<li>Create a "f" transform list by using the xfalign program.<br>
<code>xfalign cell.mrc cell.xf</code><br>
Expect the alignment for each section
to take on the order of a minute to compute.
The file, cell.xf, will contain information on how to align adjacent 
images to one another.

</li><li>The next step is to analyze the the file cell.xf and 
the transforms needed to bring all of the images in alignment with 
on another.  
Use the <code>xf2xg</code> shell script, an interface to the
<a href="man/xftoxg.html">xftoxg</a> program, to
create a global "g" transform list from the "f" transform list:
<p>
<code>
xf2xg cell.xf
</code>
</p><p>
</p></li><li>The output file from that command, cell.xg, should contain all of the
information needed to
make new aligned images from the old unaligned images.
Use the 
<a href="man/newstack.html">newstack</a> program to create the
new aligned images.  The 
<a href="man/newst.html">newst</a> shell script acts as a front end to
the newstack program and allows for easier command line options.
The following example will create
an aligned file newcell.mrc from the old cell.mrc image file.
<p><code>
newst -xform test.xg test.mrc newtest.mrc
</code>
</p><p>
If the automatic alignment is not always correct, it can be adjusted with
the
<a href="man/midas.html">midas</a> program.  Start the program with:
</p><p><code>
midas test.mrc test.xf
</code>
</p><p>A window will open up and you can view the alignment between any given
pair of adjacent images.  After making adjustments for any sections that are
out of alignment, save the transforms and exit the program.  Then rerun
the <code>xf2xg</code> and <code>newst</code> commands shown above.
</p></li></ul>
<p>
For more background and explanation of the topics in the Chapter, see the
<a href="serialalign.txt">guide</a> to serial section alignment.
</p><p>


</p></dd><dt><hr><a name="Building Models"><h3>Chapter 4: Building Models</h3></a>
<p>
Models can be built automatically with the program 
<code><a href="man/imodauto.html">imodauto</a></code>
or can
be built interactively using <code><a href="man/imod.html">imod</a></code>.
Models generated with 
<code><a href="man/imodauto.html">imodauto</a></code>
can be edited with the 
<code><a href="man/imod.html">imod</a></code> 
program.
Only images with a high signal due to 
selective stain are currently candidates for
<code><a href="man/imodauto.html">imodauto</a></code>

Most models will be generated using 
<code><a href="man/imod.html">imod</a></code>.

</p></dt><dd><h4>Model Organization</h4>
It is helpful to understand the model data structure before trying
to create a model.  
A model is basically a collection of points that refer to or mark
interesting locations in an image.
These points can be connected and put into groups that are called contours.
It is common that one would like to be able to mark more than one type
of object in an image. This is facilitated by allowing contours to be
grouped together into separate objects.  Each object is given its own
name and all contours in the object share common attributes such as
color. 

<p>
</p><h5>Model Layout</h5>

<center>
<table border="2">
<tbody><tr>
<td colspan="3" td="" align="left">
<b>Model header:</b><br>
includes image name, pixel size and zscale. </td>
</tr>

<tr>
<td valign="top">
<table border="1">
<tbody><tr><th>Object 1 </th></tr>
<tr><td>Name = blobs<br>
Color = green<br>
Type = scattered points.
</td></tr><tr><td>Contour 1<br>
Point 1<br>
Point 2
</td></tr>
<tr><td>Contour 2<br>
Point 1<br>
Point 2<br>
Point 3
</td></tr>
<tr><td>Contour 3<br>
Point 1<br>
Point 2
</td></tr>
</tbody></table>
</td>

<td valign="top">
<table border="1">
<tbody><tr><th>Object 2 </th></tr>
<tr><td>Name = round thing.<br>
Color = red<br>
Type  = closed.
</td></tr><tr><td>Contour 1<br>
Point 1<br>
Point 2<br>
Point 3<br>
Point 4<br>
Point 5<br>
Point 6
</td></tr>
</tbody></table>
</td>

<td valign="top">
<table border="1">
<tbody><tr><th>Object 3 </th></tr>
<tr><td>Name = stick<br>
Color = white<br>
Type = open.
</td></tr><tr><td>Contour 1<br>
Point 1<br>
Point 2<br>
Point 3<br>
Point 4<br>
Point 5
</td></tr>
<tr><td>Contour 2<br>
Point 1<br>
Point 2<br>
Point 3<br>
Point 4
</td></tr>

</tbody></table>
</td>


</tr>
</tbody></table>
</center>

<p>

</p></dd><dd><h4>Interactive Model Building</h4>
<p>To create a model for a MRC image file called 

<code>example.mrc</code> run the following imod command.
This command will cause a new model to be created, ready to edit.
<br>
<code>imod example.mrc</code>
</p><p>

If a model has already been saved but needs further editing run the
command
<br><code>imod example.mrc example.imod</code>
</p><p>
When this command is run a window similar to the one below will open up.
A secondary window containing the image of the image file and model
file is opened after the data has been loaded.

</p><p> </p><hr> <center> 
<a name="Information Window"> 
<h5>The Imod Information Window</h5></a> 
<img src="infowin.gif" alt="Imod Information Window"> 
</center> 

<p> 
The Imod Information Window above is where information about the
model and current image point are displayed.  The name of the image
file and the name of the current model file are shown near the top of
the window.  The main control menus
for imod are also available from within this window.

</p><p>The model controls are on the left side of the window.
These controls show the current object, contour and point.
The arrow buttons can be used to change the current object, contour
or point.
The current model being edited above has 7 objects; the 7th object
is currently selected.  The 7th object has 46 contours and
the 11th contour is currently selected.  
This contour has 65 points and the 39th point
is the current point.

</p><p>The image position controls are on the right side of the window.
These controls show the the image dimensions are 572 by 378 and that
there are 76 sections.  The current model point is at the location
(286,178) with the origin at the lower left corner of the image.  The
current section is number 21.  The arrow buttons can be used for
fine tuning the location of the current point.

</p><p>There are some additional controls at the bottom of the window.
The "Movie Mode" and "Model Mode" controls allow a user to select one
of the two modes.  When "Movie Mode" is selected then all of the model
edit controls are disabled.  The mouse controls will cause the image
to movie back and forth.  When "Model Mode" is selected the mouse
controls will edit the model.  
The table below gives an overview of the mouse controls with each mode.
<table border="2">
<caption><b> Mouse Controls </b></caption>
<tbody><tr>
<th> Mouse Button </th>
<th colspan="3"> Movie Mode   </th>
<th colspan="3"> Model Mode   </th>
</tr>

<tr>
<td>Left </td>
<td align="left" colspan="3"> Select position or drag mouse to pan image.</td>
<td align="left" colspan="3"> Attach to nearby model point or drag mouse to 
pan image.</td>
</tr>

<tr>
<td> Middle </td>
<td align="left" colspan="3">Movie image forward, or stop movie.</td>
<td align="left" colspan="3">Add new model point
or drag mouse to add several points. </td>
</tr>

<tr>
<td> Right </td>
<td align="left" colspan="3"> Movie image backward, or stop movie.</td>
<td align="left" colspan="3"> Modify the current model point or 
drag mouse to modify several points.</td>
</tr>

</tbody></table>

See the
<a href="man/imod.html">imod</a> 
manual page section on mouse controls for more details.  
</p><p>
The two
sliders reading "107" and "226" are adjustments to the display's black
and white levels.  Moving these sliders will adjust the contrast and
brightness of the displayed image, although on a PC the intensities
won't change while you are dragging the slider, only when you drop it.
If the "Float" control is checked,
the program will adjust the black and white sliders automatically when
you change from one section to another in an attempt to maintain a
constant contrast and brightness.
</p><p>
The bottom panel will contain
additional information and status messages.  You can expand the window
vertically to see more of the information at once.

</p><hr>
<center>
<a name="Zap Window">
<h5>The Imod Zap Window</h5></a>
<img src="zapwin.gif" alt="Imod Zap Window">
</center>
The main image display and model editing window within imod
is the "ZaP" window.  The window name is an acronym for
"Zoom and Pan".
The zoom can be adjusted by either clicking with 
the left mouse button on the arrows in the
upper right hand corner or by selecting the
text field next to the arrows and entering in a
number.  The current zoom level in the image above
is 1.25x.  ( Fractional zooms may be slower on some machines. )
To pan the image press and hold the left mouse
button in the image area of the window and
drag the image.

<p>
Some of the other controls at the top of the Zap window
are the Checkerboard button,
the Lock button, the Centering button, the Insert button and the section
selector.
</p><ul>
<li>The Checkerboard button will toggle between fast and slow 
drawing methods.  
</li><li>The Lock button is used to keep the image from centering on the current
point.  When the lock is closed, the image will not move when the current model
point changes, but it can be moved with the mouse or the PageUp and PageDown
keys.  When the lock is open, the image may automatically pan to the current
point, depending on the setting of the Centering button.  This panning does
not happen when the current point is selected or added by a mouse button.
</li><li>The Centering button toggles between two centering modes.  In one mode,
the image will be centered on the current point only if it falls near the
edge of the window, that is, outside of a central box.  (Thus, the icon shows
one box inside another.)  In the other mode, the
image will be recentered on the current point each time you change the 
current point.  (The icon shows a point inside the outer box.  Sorry, this
button does not appear in the example shown above.)
</li><li>The Insert, or Modeling Direction, button toggles between inserting 
points before and inserting points after the current model point.
</li><li>The section selector shows the value of the current section
being viewed in the Zap window.
You can change sections by selecting this field and entering a 
section number.
</li></ul>
<p>
<i>Editing the model in the Zap Window</i>
The left mouse button can be used to select a point for editing.
The middle mouse button is used to insert model points.
The right mouse button is used to alter the position of
the current model point.

</p><p>

</p></dd><dd><h4>Automated Model Building</h4>
<p>
imod has controls for automatically creating 
contours.  The Auto Contour Window can be opened
up by selecting the Edit-&gt;Contour-&gt;Auto menu
item in the 
<a href="#Information%20Window">Information Window</a>
</p><p>
</p><center>
<h5>The Auto Contour Window</h5>
<img src="autocont.gif" alt="Imod Auto Contour Window">
</center>
To build a contour automatically, first select the
<b>High Contrast</b> button and then adjust the <b>Threshold</b>
until you can see a feature that you wish to model
outlined in the Zap window.  When the <b>Regular Contrast</b>
button is selected no change of the image in the Zap window
will be seen.  Next select the <b>Alt mouse</b> button
to enable the auto contour mouse functions in the Zap window.
In the Zap window, select the area you would like to 
create a contour around with the
<b>Left mouse button</b>.  You should see a red highlight
around the area that the contour will enclose.
If the area looks rough you can smooth it with the 
<b>Smooth</b> button.
If you don't like the area that is highlighted select the
<b>Clear</b> button to erase the highlighted area.
To build a contour around the selected area use the <b>Build</b>
button.
To return to manual editing in the Zap window, de-select the
<b>Alt mouse</b> button.
Select the <b>Help</b> button for a more detailed explanation of all
of the controls.
</dd><p>
<i>See also</i>: Manual pages for 
<code><a href="man/imod.html">imod</a></code> and
<code><a href="man/imodauto.html">imodauto</a></code>.


</p><dt><hr><a name="Viewing Models"><h3>Chapter 5: Viewing Models</h3></a>
Once a model has been made one can get
quantitative information about the objects and contours within the model
using the
<a href="man/imodinfo.html">imodinfo</a> program.

One can also view the model in an interactive renderer using
<a href="man/imodv.html">imodv</a>.

It is also possible to use a conversion program to convert
the IMOD model into other formats for use in other 3rd party programs,
such as photo-realistic renderers or web browsers.


</dt><dd> <h4>Interactive Viewing</h4>
The main interactive viewing program for IMOD model files is the
<a href="man/imodv.html">imodv</a> program.  The viewer can also
be run within the <a href="man/imod.html">imod</a> image visualization
and modeling program by selecting the "Model View" item from the Image
menu in the Imod <a href="#Information%20Window">Information Window</a>.


</dd><dd> <h4>Putting a skin on model data.</h4>

Skinning is the name used for calculating a three-dimensional 
surface from contour data.  This surface, once calculated, is represented by
a mesh of triangles that can be stored within each object.
If any contour points within that object are edited then the mesh
for that object must be recalculated in order for it to match
the contour data.
The <a href="man/imodmesh.html">imodmesh</a> program must be used
to calculate the mesh from the contour data within a model
since the skinning calculation cannot be done in real time with
current computer processing.

<p>
Here are some example uses of imodmesh, assuming that the model file is titled
cell.imod.
</p><p>
All meshes by default have a hole at the top and bottom of the data;
the program cannot know a priori if the hole should be there or not.
The -C in the command below tells imodmesh to fill in the holes at
the ends or "Cap" them off.
<br><code>imodmesh -C cell.imod</code>
</p><p>
Sometimes the mesh data structure can get so large that interactive
viewing is very slow.  The -r or -R options can be used to make a mesh
with a lower resolution.  In the example here, points on the mesh
will be no less than 20 pixels apart.
<br><code>imodmesh -C -r 20 cell.imod</code>
</p><p>
The -R option can give a more faithful rendition of a complex object because it
removes only points that are within a certain distance of the remaining line 
segments, thus preserving the shape of curves.  In this example, points will
be removed, but the surface defined by the mesh will always be within 0.75
pixel of the original data.
<br><code>imodmesh -C -R 0.75 cell.imod</code>
</p><p>If you make a mistake, don't worry, a backup file called
cell.imod~ was made.  You can also erase all of the mesh data by
using this last example.
<br><code>imodmesh -e cell.imod</code>


</p></dd><dd> <h4>Quantitative Information.</h4>
In order to get accurate information the fields in the model header
have to be set properly.  To adjust the fields in the model header
select the Model Header menu item from Edit menu in the
Imod <a href="#Information%20Window">Information Window</a>.
The model edit dialog will pop up.  The "Z-Scale" and the
"Pixel Size" fields will be used for calculating length, surface area
or volume from object, contour or mesh data.

The Pixel Size field should contain the value that describes the
dimensions used in digitizing an image along with the units.
Units can be one of the following; nm, um, mm, m, km.  For example,
you could enter "0.015 um" or "15 nm".
The Z-Scale is the ratio of the thickness between successive images
to the Pixel Size.

<p>
Selecting the Edit-&gt;Object-&gt;Info or Edit-&gt;Contour-&gt;Info menu item from
the Imod <a href="#Information%20Window">Information Window</a> will
cause the quantitative information to be printed out in the bottom
panel of the Imod <a href="#Information%20Window">Information Window</a>.

</p><p>
Use the 
<a href="man/imodinfo.html">imodinfo</a> command to get basic information
from a model and print it out to a terminal or file.
<br><code>
imodinfo cell.imod
</code>
</p><pre># MODEL cell.imod<br># NAME  A little cell<br># PIX SCALE:  x = 1<br>#             y = 1<br>#             z = 9.17<br># PIX SIZE      = 0.00654<br># UNITS: um<br><br>OBJECT 1<br>NAME:  spindle pole<br>       5 contours<br>       object uses closed contours.<br>       color (red, green, blue) = (0, 1, 1)<br><br>       	CONTOUR #1,2,0  16 points, length = 0.464513,  area = 0.0134249<br>        CONTOUR #2,2,0  14 points, length = 0.458311,  area = 0.0125642<br>        CONTOUR #3,2,0  8 points,  length = 0.200755,  area = 0.00277481<br>        CONTOUR #4,2,0  13 points, length = 0.313501,  area = 0.00664029<br>        CONTOUR #5,2,0  9 points,  length = 0.232374,  area = 0.00272134<br><br>        Total volume = 0.00228646<br>        Total contour cylinder surface area = 0.10012.<br>        Total mesh surface area = 0.0349499.<br></pre>
</dd><p>

</p><dd> <h4>Output to other model formats.</h4>
IMOD models can be converted to a few other 3rd party formats.
The formats and the programs used to convert to them are
listed below.
<ul>

<li><a href="man/imod2vrml.html">imod2vrml</a> converts to the 
Virtual Reality Modeling Language 1.0, see the
<a href="http://www.web3d.org/vrml/vrml.htm">VRML Repository</a> for more information.
This is the format used in many web browsers for viewing 3D models.

</li><li><a href="man/imod2rib.html">imod2rib</a> converts to the RIB format used by Renderman. There is a set of public domain
rendering tools at the 
<a href="http://www.bmrt.org">
Blue Moon Rendering Tools</a> Home Page.
<br><i>The Renderman (R) Interface Procedures and RIB Protocol are:
Copyright 1988,1989, Pixar.
All rights reserved.
RenderMan (R) is a registered trademark of Pixar.</i>

</li><li><a href="man/imod.html">imod</a> can write files in the SYNU 
format used by the synuview program available from the 
<a href="http://www-ncmir.ucsd.edu/">
National Center for Microscopy and Imaging Research</a> (NCMIR).
See the <a href="http://www-sdmir.ucsd.edu/SYNU.html">Synuview FAQ</a>

</li><li><a href="man/imod.html">imod</a> can write files in the NFF format
used by 
<a href="http://www.scri.fsu.edu/%7Elyons/scian/Description.html">scian</a>.

</li><li><a href="man/imod2meta.html">imod2meta</a> is supposed to be able
to write files in the Quick Draw 3D Metafile format, but was recently reported
as not working.  This is the standard
for Macintosh computers.
See the <a href="http://www.apple.com/quicktime">
Quick Draw 3D</a> Home Page for more information.
</li></ul>

</dd>
</dl>


<p>
<i>See also</i>: Manual pages for 
<code><a href="man/imodv.html">imodv</a></code>,
<code><a href="man/imodmesh.html">imodmesh</a></code>,
<code><a href="man/imodcmopp.html">imodcmopp</a></code> and
<code><a href="man/imodinfo.html">imodinfo</a></code>.

</p><hr>
<ul><a name="Special"><h3>Chapter 6: Special Help Topics</h3></a>
<li> <a href="tomoguide.html"> Tomography guide.</a>
</li><li> <a href="tomojoin.html"> Guide for joining tomograms from serial sections.</a>
</li><li> <a href="serialalign.txt">Guide to serial section alignment.</a>
<hr>
<i>Last updated: November 5, 2002</i>
[<a href="../index.html">IMOD Home Page</a>] 
[<a href="../../index.html">BL3DFS Home Page</a>]
</li></ul><br>
</body></html>
