<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>IMOD User's Guide</title>
</head>
<body>
<h1 align="center">IMOD User's Guide for Version 3.1.0 </h1>
<h3 align="center">Boulder Laboratory for 3-D Electron Microscopy of
Cells</h3>
<hr>
<h3>Table of Contents</h3>
<ul>
  <li><a href="#Installation">Installation</a> </li>
  <ul>
    <li><a href="#SettingUpLinux">Setting Up a Linux PC to Run IMOD.</a> </li>
    <li><a href="#InstallingLinuxSGI">Installing IMOD on a Linux PC or
an SGI</a> </li>
    <li><a href="#InstallingJavaLinux">Installing  Java on Linux PC or
SGI</a> </li>
    <li><a href="#InstallingMac">Installing IMOD on a Macintosh running
OS X</a> </li>
    <li><a href="#SettingUpWindows">Setting Up a Windows PC to Run IMOD</a> </li>
    <li><a href="#InstallingWindows">Installing IMOD on a Windows PC</a> </li>
    <li><a href="#TIFFLibrary"> TIFF Library Support</a> </li>
    <li><a href="#FastBackprojection"> Fast Backprojection Support</a> </li>
  </ul>
  <li><a href="#Getting%20Started">Getting Started</a> </li>
  <li><a href="#Aligning%20Images">Aligning Images</a> </li>
  <ul>
    <li><a href="#ManualAlignment">Manual Image Alignment</a> </li>
    <li><a href="#AutomaticAlignment">Automatic Image Alignment</a> </li>
    <li><a href="#FiducialAlignment">Image Alignment using Fiducial
Markers.</a> </li>
  </ul>
  <li><a href="#Quantitative%20Information">Getting Quantitative
Information</a> </li>
  <li><a href="#Other%20Output">Output to Other Model Formats</a> </li>
  <li><a href="#Special">Special Help Topics</a> </li>
</ul>
<p> An <a href="3dmodguide.html">introduction to 3dmod</a>, the image
display and modeling program in IMOD, is now a separate document. </p>
<p> There is also a <a href="program_listing.html">reference guide</a>
that gives a description of each IMOD program and a link to its man
page. </p>
<hr>
<dl>
  <dt><a name="Installation">
    <h3>Installation</h3>
    </a> </dt>
All of the IMOD programs are available via the <a
 href="http://bio3d.colorado.edu/imod/download.html">IMOD Download Page</a>.
&nbsp;The distribution is bundled together using the Unix tar program
and compressed using the gzip program. <dd> <a name="SettingUpLinux"> </a>
    <p> <a name="SettingUpLinux"> </a></p>
    <h4><a name="SettingUpLinux">Setting Up a Linux PC to Run IMOD.</a></h4>
    <a name="SettingUpLinux"> </a> The recommended configuration for
running the IMOD software is:
    <p> Processor:  Intel Pentium III or 4 or AMD Athlon <br>
Video Card:  GeForce 2 MX, Geforce2 GTS, Geforce2 GTS  Ultra, GeForce3,
GeForce 4 (64 MB or 128 MB cards preferred) <br>
Minimum memory size:  256MB <br>
Minimum disk size:          10 GB <br>
Operating System:  Red Hat 7.3 or higher Workstation class installation<br>
Nvidia Linux device drivers and OpenGL libraries from <a
 href="http://www.nvidia.com">Nvidia</a>, at least version 3123 or
higher. <br>
For Red Hat 7.1 - 7.3, to work with files bigger than 2 GB, version
6.11 or higher of <code>tcsh</code>. <br>
    </p>
    <p> The required or recommended steps for each operating system are:</p>
    <p> <b>Red Hat 8.0 - 9.0</b> </p>
    <ul>
      <li>Nvidia installation </li>
      <li>Window manager settings </li>
    </ul>
    <p> <b>Red Hat 7.3</b> </p>
    <ul>
      <li>Nvidia installation </li>
      <li>Qt 3.0.5 upgrade </li>
      <li>Window manager settings </li>
      <li>tcsh for large files </li>
    </ul>
    <p> <b>Nvidia installation (all systems).</b> Installing Nvidia
drivers has recently become much easier, but here are some <a
 href="nvidia_install.txt">instructions</a> that may be helpful.  In
addition, here is a sample of a <a href="XF86Config9.0.txt">/etc/X11/XF86Config</a>
file from Red Hat 9.0, set up to use a 24-inch Sony monitor. </p>
    <p> <b>Qt 3.0.5 upgrade (Red Hat 7.3).</b> 3dmod for Red Hat 7.3 was
compiled against version 3.0.5 of Qt and will not run on the basic
installation of 7.3.  Use <code>rpm -q qt</code> to check which version
is installed. <code></code> To upgrade, download <a
 href="http://bio3d.colorado.edu/imod/rh7.3/qt-3.0.5-7.14.i386.rpm">Qt
3.0.5</a> and, as root, enter <code>rpm -Uhv qt-3.0.5*.rpm .</code> </p>
  </dd>
  <dd>
    <p><b>Window manager settings (all systems).</b> To keep 3dmod from
bogging down when it is displaying complex models, the window manager
needs to be set to display only the outline and not the contents of
windows when they are moved or resized.  In Red Hat 7.3, this could be
done by selecting "box" rather than "opaque" in the "Moving and
Resizing" panel of the Gnome control center.  In Red Hat 8.0 or 9.0,
this cannot be done under Gnome but it can under KDE, by opening up the
Control Center and selecting "Look and Feel" or "Desktop" (depending on
KDE version), then "Window Behavior" then the "Moving" panel. </p>
    <p> <b>tcsh for large files (Red Hat 7.1 - 7.3).</b> As of IMOD
2.6.0, programs have been compiled to work with files bigger than 2 GB.
However, the <code>tcsh 6.10</code> distributed with Red Hat 7.1-7.3 has
problems with large files, and some of the IMOD shell scripts will fail
with large      files under this tcsh. For doing tomography with large
files, you need   to   upgrade to <code>tcsh 6.11</code>, which is
available as an <a
 href="http://bio3d.colorado.edu/imod/rh7.3/tcsh-6.11-3mdk.i586.rpm">rpm</a>.</p>
    <a name="InstallingLinuxSGI">
    <h4>Installing IMOD on a Linux PC or an SGI</h4>
    </a>
    <p> The easiest thing to do is to install to our recommended
location, /usr/local/IMOD.  The following steps are used in this case.
The specific       file names are used as an example; your copy may have
higher version  numbers. </p>
    <ol>
      <li> Log in as root or do all of these commands with sudo </li>
      <li> cd to the directory where you downloaded IMOD, and <br>
        <code> mv imod_3.1.0_rh8.0.tar.gz /usr/local</code> </li>
      <li><code> cd /usr/local</code> </li>
      <li><code> gunzip imod_3.1.0_rh8.0.tar.gz</code> </li>
      <li><code> tar xvf imod_3.1.0_rh8.0.tar</code> </li>
      <li>To see if you already have a /usr/local/IMOD, <br>
        <code> ls -l</code> </li>
      <li>If you do have a /usr/local/IMOD and it is a link (e.g., it
shows up as <code> IMOD -&gt; imod_2.7.6</code>), then enter <br>
        <code> rm IMOD</code> <br>
Otherwise, rename the existing directory, e.g.: <br>
        <code> mv IMOD oldIMOD</code> </li>
      <li><code> ln -s imod_3.1.0 IMOD</code> </li>
      <li> (A) Under Linux, enter <br>
        <code> cp IMOD/IMOD-linux.* /etc/profile.d</code> <br>
(B) On an SGI, insert the text in <code>IMOD/sgi.cshrc</code> into <code>/etc/cshrc</code>,
specifically the command <br>
        <code>if (-e /usr/local/IMOD/IMOD-sgi.csh) source
/usr/local/IMOD/IMOD-sgi.csh </code></li>
    </ol>
  </dd>
</dl>
<dl>
  <dd>You will have to open a new window, or possibly even log out and
log back in, for these changes to take effect.<br>
  </dd>
  <dd><br>
  </dd>
  <dd>If you are upgrading IMOD using the above procedures, and your
previous installation used another method for setting the environment
variables for   users, be sure to remove whatever commands were used
before. &nbsp;These      might have been placed in <code>/etc/cshrc</code>,<code>/usr/local/etc/cshrc</code>,
or users' <code>.cshrc</code>, <code>.bashrc</code>, or <code>.profile</code>
files. &nbsp;The advantage of the new procedure is that future upgrades
will be easier, especially if the startup files change.</dd>
  <dd><br>
  </dd>
  <dd>If you want to install at another location, change <code>/usr/local/IMOD</code>
to the name of the top IMOD directory in the relevant <code>IMOD-*.*</code>
files and in the source command placed in <code>/etc/cshrc</code> on  an
SGI.</dd>
</dl>
<dl>
  <dd>If you do not want a system wide installation, instead of step 9
above, then under Linux, place the following in the <code>.cshrc</code>
files of   individual users of <code>tcsh</code> (where &lt;location of
IMOD&gt; is  the absolute path to the IMOD directory):</dd>
  <dd><code>setenv IMOD_DIR &lt;location of IMOD&gt;</code></dd>
  <dd><code>if (-e $IMOD_DIR/IMOD-linux.csh) source
$IMOD_DIR/IMOD-linux.csh </code></dd>
</dl>
<dl>
  <dd>or, place the following in the <code>.bashrc</code> of individual
users under <code>bash</code>:</dd>
  <dd><code>export IMOD_DIR=&lt;location of IMOD&gt;</code></dd>
  <dd><code>if [ -e $IMOD_DIR/IMOD-linux.sh ] ; then source
$IMOD_DIR/IMOD-linux.sh ; fi</code></dd>
</dl>
<dl>
  <dd>or, on an SGI, place the following in the <code>.cshrc</code>
files of individual users:</dd>
  <dd><code>setenv IMOD_DIR &lt;location of IMOD&gt;</code></dd>
  <dd><code>if (-e $IMOD_DIR/IMOD-sgi.csh) source $IMOD_DIR/IMOD-sgi.csh</code></dd>
</dl>
<dl>
  <dd>Finally, if you just want to try running the programs in a
particular copy of IMOD, cd to the top IMOD directory and, on Linux
under <code>tcsh</code>,       enter:</dd>
  <dd> <code>setenv IMOD_DIR `pwd`</code></dd>
  <dd><code>source IMOD-linux.csh </code></dd>
</dl>
<dl>
  <dd>and similarly on the SGI, sourcing <code>IMOD-sgi.csh</code>. On
Linux under <code>bash</code>, enter:</dd>
  <dd><code>export IMOD_DIR=`pwd`</code></dd>
  <dd><code>source IMOD-linux.sh<br>
    <br>
    </code>Under Linux, <code>3dmod</code> may fail to run if another
installed package has placed an incompatible Qt or OpenGL library on
your library load path. &nbsp;The sign of a problem with the Qt library
is an error message about an undefined symbol, usually a very long
string containing "QGLWidget". &nbsp;The top IMOD directory contains two
files, <code>IMOD-qtconflict.sh</code> and <code>IMOD-qtconflict.csh</code>,
that can be used to solve this problem. &nbsp;Try sourcing the
appropriate file, then try following the directions in the file and
sourcing it again. &nbsp;If this solves the problem, make any needed
changes to both files and copy them to <code>/etc/profile.d</code>.<code><br>
    </code></dd>
</dl>
<dl>
  <dd> <a name="InstallingJavaLinux">
    <h4>Installing  Java on Linux PC or SGI</h4>
    </a> Etomo is a Java 2 application and thus requires a Java runtime
environment (JRE) with a version of 1.4 or better to be installed.  We
recommend using the 1.4.0 or 1.4.2 series since we have encountered bugs
in version 1.4.1 Sun's Java runtime. &nbsp;The startup scripts for IMOD
3.1.0 under Linux assume that Sun's JRE version 1.4.2_2 is installed;
this is available <a
 href="http://bio3d.colorado.edu/imod/java/j2re-1_4_2_02-linux-i586.bin">here</a>
for Linux. <br>
    <br>
    <span style="font-family: monospace;"><code></code></span>To
install the JRE for Linux first move the&nbsp;<code><span
 style="font-family: monospace;">j2re-1_4_2_02-linux-i586.bin</span></code>
file to <code>/usr/local</code>
    <p class="western"><code><span style="font-family: monospace;">mv </span></code><span
 style="font-family: monospace;"><code><span
 style="font-family: monospace;">j2re-1_4_2_02-linux-i586.bin /usr/local</span></code><br>
    </span></p>
    <p class="western">Next change your working directory to <code>/usr/local</code>
and&nbsp; execute the bin by entering</p>
    <p class="western"><span style="font-family: monospace;"><code>cd
/usr/local</code><br>
    </span><span style="font-family: monospace;"></span></p>
    <p class="western"><span style="font-family: monospace;"><code>sh
j2re-1_4_2_02-linux-i586.bin</code><br>
    </span></p>
    <p class="western">on the command line. &nbsp;</p>
    <span style="font-family: monospace;"></span>
    <p class="western">This will install the JRE in <code>/usr/local/j2re1.4.2_0</code>2,
which is the recommended place to install the JRE, and is the default
location the Etomo startup script looks for the JRE. &nbsp;If you wish
to install the JRE in a different location or use a different JRE you
must edit the <code>IMOD-linux.sh</code> and <code>IMOD-linux.csh</code>
scripts in <code>/etc/profile.d</code> and define the variable
IMOD_JAVADIR to specify the directory where the JRE you wish to use is
installed.<br>
    </p>
  </dd>
  <dd>For an SGI, we recommend using version 1.4.0 of the Java runtime
environment, available <a
 href="http://bio3d.colorado.edu/imod/java/SGI-Java2v14-EA-eoe.tardist">here</a>
. &nbsp;If it loses its extension in the download, make sure it ends in
"tardist". For example, <br>
    <code><br>
mv SGI-Java-2v14-EA-eoe.tar SGI-Java-2v14-EA-eoe.tardist</code><br>
    <br>
Then install it with <br>
    <br>
    <code>swmgr -f &nbsp;SGI-Java-2v14-EA-eoe.tardi</code>st &nbsp;
&nbsp;<br>
&nbsp;</dd>
  <dd><br>
  </dd>
  <dd> <a name="InstallingMac">
    <h4>Installing IMOD on a Macintosh running OS X</h4>
    </a> </dd>
  <dd>The recommended location for this installation is in
/Applications. &nbsp;For the following command-line oriented approach,
you will need to be able to use sudo. &nbsp;Open a terminal window and
do the following:</dd>
</dl>
<blockquote>
  <ol>
    <li> cd to the directory where you downloaded IMOD, and <br>
      <code>sudo mv imod_3.1.0_osx.tar.gz /Applications</code></li>
    <li><code>cd /Applications</code></li>
    <li><code>sudo tar xvzf imod_3.1.0_osx.0.tar</code></li>
    <li>To see if you already have a /Applications/IMOD, <br>
      <code> ls -l</code> </li>
    <li>If you do have a /Applications/IMOD and it is a link (e.g., it
shows up as <code> IMOD -&gt; imod_3.0.9</code>), then enter <br>
      <code>sudo rm IMOD</code> <br>
Otherwise, rename the existing directory, e.g.: <br>
      <code>sudo mv IMOD oldIMOD</code> </li>
    <li><code> sudo ln -s imod_3.1.0 IMOD</code></li>
    <li><code></code><code></code>If this is the first time IMOD is
being installed, you will need to edit <code>/etc/csh.cshrc</code>,
using sudo to invoke <code>emacs</code> or <code>pico</code>.
&nbsp;Copy the text in <code>IMOD/mac.cshrc</code> to the end of <code>/etc/csh.login</code>,
specifically the command <br>
      <code>if (-e /Applications/IMOD/IMOD-mac.csh) source
/Applications/IMOD/IMOD-mac.csh</code><br>
    </li>
  </ol>
If you are on a single user-machine or have administrative privileges
from the desktop, you can use the following alternative approach:
  <ol>
    <li>Click on the downloaded file to unpack it with Stuffit Expander
and create the IMOD folder, e.g. <code>imod_3.1.0</code></li>
    <li>Drag this folder into the /Applications folder.</li>
    <li>If you already have an IMOD folder in /Applications, rename it
or move it elsewhere.</li>
    <li>Rename the new distribution to IMOD.</li>
    <li>If this is the first time IMOD is being installed, you will
need to edit <code>/etc/csh.cshrc</code>, using sudo to invoke <code>emacs</code>
or <code>pico</code>. &nbsp;Copy the text in <code>IMOD/mac.cshrc</code>
to the end of <code>/etc/csh.login</code>,    specifically the command <br>
      <code>if (-e /Applications/IMOD/IMOD-mac.csh) source
/Applications/IMOD/IMOD-mac.csh</code><br>
    </li>
  </ol>
Whichever approach you use, you will need to log out and log back in
for these changes to take effect, or you can just <code>source
/etc/csh.login</code>.<br>
  <br>
If you want to install at another location, change <code>/Applications/IMOD</code>
to the name of the top IMOD directory in <code>IMOD-mac.csh</code> and
in the source command placed in <code>/etc/csh.login.<br>
  </code></blockquote>
<blockquote> Once you have verified that IMOD programs  run after
installing them, you can make some links in <code><font
 face="Helvetica, Arial, sans-serif">/usr/lib</font></code> to libraries
in the IMOD directories that will allow you to start 3dmod by clicking
on its icon. &nbsp;Run the <code>linklibs-mac </code>script by
entering:<br>
  <code>sudo $IMOD_DIR/linklibs-mac -i</code><br>
If this creates problems, such as conflicts with other programs that
supply their own Qt libraries, you can remove the links with:<br>
  <code>sudo $IMOD_DIR/linklibs-mac -u</code><br>
  <br>
See the above instructions for PC and SGI for other variations on
installation procedures.<br>
  <br>
  <br>
  <a name="SettingUpWindows">
  <h4>Setting Up a Windows PC to Run IMOD</h4>
  </a> To use most of the programs in IMOD, you could simply use <a
 href="http://www.winzip.com">Winzip</a> to unpack it somewhere, (e.g., <code>C:\Program
Files</code>), rename the top directory to IMOD, and add the IMOD\bin
directory (e.g., C:\Program Files\IMOD\bin) to your path in Windows, as
described below. &nbsp;However, for complete functionality, including
the ability to run shell scripts and to build tomograms, you need to
install a Unix-like environment called <a href="http://www.cygwin.com">Cygwin</a>
. &nbsp;We have provided a <a
 href="http://bio3d.colorado.edu/imod/windows/cygwinForIMOD.exe">Cygwin
package</a> to make this process simpler and more predictable.
&nbsp;This installation will occupy 57 MB, all located under a single
directory that can be removed easily. &nbsp;The installation will also
create icons on the desktop and in the Start Menu, and make several
simple entries to the Windows registry.<br>
  <br>
Cygwin installation will work best if you are logged in as a user with
Administrative privileges.  You can do it as Administrator, but you will
not get a home directory unless you log in as an another user.<br>
  <br>
To install Cygwin from the package in <code>cygwinForIMOD.exe</code>:<br>
  <br>
  <ol>
    <li>Click on the package to extract it.  Press "Browse" and select
a folder to unzip to that is conveniently accessed (the Desktop will
do). &nbsp;You will get the <code>setup.exe</code> program and a <code>cygwinMaster</code>
folder with all the packages.</li>
    <li>Click on <code>setup.exe</code></li>
    <li>Select install from a Local Directory</li>
    <li>Set the root drive to <code>C:\cygwin</code> unless you want it
on a different disk.  Do not install under a directory with spaces in
its name.  In the rest of this document, C:\ is used in the examples,
and you need to substitute your location if it is different.<br>
Take the defaults for the other two selections: install for all users
and Unix line endings.</li>
    <li>Select the cygwinMaster folder as the Local Package Directory</li>
    <li>On the Select Packages page, click on the circular double arrow
next to "All" to switch from "Default" to "Install"</li>
    <li>Proceed with the installation, and take the defaults to create
icons on the desktop and start menu.</li>
  </ol>
  <br>
The installation will create a Unix-like directory tree under <code>C:\cygwin</code>,
including a <code>/home</code> with a home directory for you the
installing user. &nbsp;After installation you will get an icon that will
start up a shell under bash. <br>
  <br>
If you want to customize your Cygwin installation instead of using our
package, go to <a href="http://www.cygwin.com">www.cygwin.com</a> ,
click on "Setup", and follow the installation procedures. &nbsp;In
addition to the default installation, it is essential that you select <code>tcsh</code>
from the Shells category. &nbsp;In November 2003, it was also necessary
to add libbz2-1 and libpcre0 from the Libs category.<br>
  <br>
  <a name="InstallingWindows">
  <h4>Installing IMOD on a Windows PC</h4>
  </a> To install IMOD: <br>
  <br>
  <ol>
    <li> Start a Cygwin terminal window.  You can adjust the font,
length, and background color of this window and make it the default for
Cygwin terminals.</li>
    <li> Move your copy of the IMOD distribution to <code>/usr/local</code>
either from the command line or from an Explorer window, where the
location will appear as <code>C:\cygwin\usr\local</code>.</li>
    <li>&nbsp;Unpack the tar file and rename it to IMOD: <br>
      <code>cd /usr/local </code><br>
      <code>tar -xvzf imod_3.1.0.tar.gz </code><br>
      <code>mv imod_3.1.0 IMOD </code><br>
      <code>cp IMOD/IMOD-cygwin.* /etc/profile.d</code></li>
    <li> For IMOD's man pages to work, <code>/etc/man.config</code>
needs to not have the option "<code>NOCACHE</code>". Just copy the file <code>man.config</code>
from the <code>cygwinMaster</code> folder to <code>/etc</code> (<code>C:\cygwin\etc</code>).<br>
    </li>
  </ol>
You will have to open a new Cygwin window for these changes to take
effect. &nbsp;You can use Winzip instead to unpack IMOD, but first you
must turn off "Tar file smart CR/LF conversion" under
Options-Configuration-Miscellaneous, since most of the complicated shell
scripts will not work if they get converted to DOS line endings.<br>
  <br>
After these steps, everything but eTomo can be run from a Cygwin
window. &nbsp;In order to run eTomo, you also need to install Java and
define some environment variables inside Windows:<br>
  <br>
  <ol>
    <li> To install Java, get the latest Java Run-time Environment from <a
 href="http://www.sun.com">Sun</a> or use the version provided <a
 href="http://bio3d.colorado.edu/imod/java/j2re-1_4_2_02-windows-i586-p.exe">here</a>
.</li>
    <li> Click on the file and take the defaults to install Java.  When
you are done, you can delete any Java icons from your desktop.</li>
    <li> To define environment variables, right click My Computer,
select Properties, Advanced, Environment Variables. Define all of these
paths in Windows format.  Press "New" to define a variable.</li>
    <li>Under "System variables", define &nbsp;<code>IMOD_DIR</code>
&nbsp;to be &nbsp;<code>C:\cygwin\usr\local\IMOD</code></li>
    <li>Under "User variables for username", define <code>&nbsp;HOME</code>
&nbsp; to be &nbsp; <code>C:\cygwin\home\username</code></li>
    <li> You also need to add the Cygwin bin to the systen path, e.g.,
under "System variables", select <code>PATH</code>, press "Edit", and
add <code>C:\cygwin\bin; </code>to the front of the path (the ";" is a
separator).</li>
  </ol>
  <br>
Here are some optional steps:<br>
  <br>
You can add <code>C:\cygwin\usr\local\IMOD\bin</code> to the Windows
path, in which case you will be able to run everything but shell scripts
from a DOS window.<br>
  <br>
To get some command files with DOS line endings you can define an
environment variable <code>CYGWIN</code> to be&nbsp; <code>nobinmode</code>.
This will make command files from <code>Setupcombine</code>, but not
those from <code>Copytomocoms</code>, have DOS line endings.  If there
is demand for this, <code>Copytomocoms</code> will be changed to produce
DOS line<br>
endings too.<br>
  <br>
If you want to use <code>tcsh</code> instead of <code>bash</code>,
make a copy of <code>C:\cygwin\cygwin.bat</code> named <code>cygwin-tcsh.bat</code>,
edit it to say <br>
  <code>&nbsp; tcsh -l<br>
  </code>instead of<br>
&nbsp;&nbsp; &nbsp;<code>bash --login -i</code><br>
and change the target of your Cygwin shortcut to be this file instead
of <code>cygwin.bat</code>. <code>Tcsh</code> has the disadvantage that
it fails to preserve entries on your Windows path that have spaces in
them, but it does filename completion of Windows filenames (starting
with C:/) better than <code>bash</code> does.<br>
  <br>
If you want to be able to display and print Postscript graphs from the
Fortran graphics programs (e.g., <code>nda, mtk, mtoverlap</code>), you
can install <a
 href="http://bio3d.colorado.edu/imod/windows/gs811w32.exe">ghostscript</a>
and <a href="http://bio3d.colorado.edu/imod/windows/gsv45w32.exe">gsview</a>
for Windows.<br>
  <code>&nbsp;</code><br>
</blockquote>
<dl>
  <dd> <a name="TIFFLibrary">
    <h4>TIFF Library Support</h4>
    </a> The 3dmod program is able to read TIFF files on the PC or Mac,
and will be able to read them on an SGI if the library <code>libtiff.so</code>
is available.  Versions compiled for IRIX 6.5 assume     that the
library is available.
    <p> If you are trying to run a version that is compiled for the
library but the  library is not on your system, <code>3dmod</code> and
several other   programs  will not run until you rename a dummy library, <code>nolibtiff.so</code>,
to <code>libtiff.so</code>. From the top IMOD directory, do the
following: </p>
    <pre>cd lib<br>mv nolibtiff.so libtiff.so<br></pre>
and, on the SGI only, continue with:
    <pre>cd ../lib32<br>mv nolibtiff.so libtiff.so<br></pre>
    <p> Conversely, if you have a version that does not assume the
library and you do have the library (whose source you  can obtain from <a
 href="ftp://ftp.sgi.com/graphics/tiff">SGI</a>), then to use the
library, you need to remove or rename the dummy <code>libtiff.so</code>
in the <code>IMOD/lib</code> directory. </p>
    <a name="FastBackprojection">
    <h4>Fast Backprojection Support</h4>
    </a> The Tilt program now contains a fast backprojection algorithm
developed by Gregory Beylkin and Kristian Sandberg at the University of
Colorado. This method produces reconstructions 1.5-2.5 times faster,
depending on   the computer architecture and the size of the slice being
reconstructed (the larger, the  better).  It works    when there is tilt
around the X-axis but not with local alignments. Unfortunately, the
advantage is very small on Pentium 4 machines with our current
distribution, compiled with gnu compilers. To take advantage of the
algorithm, you need a license to  use the USFFT library, which is
commercial software for doing unequally  spaced FFTs. A license  is free
for non-profit organizations, but the licensing mechanism currently
works only .  To obtain  a license, contact <a
 href="mailto:mast@colorado.edu"> David Mastronarde</a> with a request
and a description of your institution.  Once you have  the license, you
need to  set the environment variable USFFT2_LICENSE_FILE  to point to
the license   file.  This is already done in the startup files supplied
with IMOD.  The   program  will use standard backprojection if there is
no license. </dd>
  <dt>
    <hr><a name="Getting Started">
    <h3>Getting Started</h3>
    </a></dt>
  <dt>You will want to go through the <a href="3dmodguide.html">Introduction
to 3dmod</a> because <code>3dmod</code> is the central graphical tool of
the IMOD package.  Beyond this,  your initial problem may be getting
data into a format usable by  the IMOD programs.   If you are having
problems getting your data into a  format usable by IMOD contact us for
help. </dt>
  <dd>
    <h4>The Image Data Format and File Conversion</h4>
All of the IMOD programs use the <a href="mrc_format.txt">MRC   image
file format</a>. We have utility programs available for converting TIFF
files, SGI rgb files and raw data into the MRC file format.
    <p> Use the program <a href="man/tif2mrc.html">tif2mrc</a> to
convert a series of TIFF image  files into a single MRC image file.  The <code>tif2mrc</code>
program has an option for converting 24-bit color to 8-bit grayscale
images, and options for dealing with unsigned 16 bit images, which are a
potential problem because the MRC format supports only signed 16-bit
images. The  following example will create a MRC file from a list of
TIFF files (cell01.tif, cell02.tif  ...). </p>
    <p><code> tif2mrc cell??.tif  cell.mrc </code> </p>
    <p>See the <a href="man/tif2mrc.html">tif2mrc manual page</a> for
more information on how to use <code>tif2mrc</code>.</p>
  </dd>
  <dd>If you already have a series of MRC files, with one image per
file, you can combine them into a single stack easily with the program
&nbsp;<a href="man/newst.html">newst</a> . &nbsp;For example, enter</dd>
  <dd><br>
  </dd>
  <dd><code>newst cell*.mrc cell.st&nbsp;</code></dd>
  <dd><br>
  </dd>
  <dd>The program <a href="man/raw2mrc.html">raw2mrc</a> is used to
convert raw image data into the mrc format.  This program can take a
file of  8  or   16 bit integers, IEEE float values, or 24-bit RGB
triplets and convert    them  into an MRC image file. In MRC files, the
data start in the lower  left  hand  corner of the image, with the data
stored in rows.  To use <code>raw2mrc</code>,     you need to know the
size of the images, the type of data, and the size   of  any header
information preceding the image. &nbsp;For example, if you have  a set
of files (cell01.em, cell02.em, ...) with 1024 x 1024 images  of signed
16-bit integers, and a header of 512 bytes, use:</dd>
  <dd><br>
  </dd>
  <dd><code>raw2mrc -t short -x 1024 -y 1024 -o 512 cell*.em cell.mrc</code><br>
  </dd>
  <dd>
    <p>If the data need to have their bytes swapped because they come a
machine with the opposite byte ordering (e.g. SGI versus PC), use the -s
option. &nbsp;If you do not know the something about the image, such as
the header    size or whether the data are unsigned or need swapping,
you may be able  to  figure it just by trying different options for data
types and swapping.  &nbsp;If   you do not know the header size, convert
one file without the -o option,  load it into 3dmod, and try to see
where the image data start. If the final  MRC image is upside down use
the -f option in the initial conversion  or use the program <a
 href="man/clip.html">clip</a> to flip the image back. </p>
    <p> As of IMOD 2.6.20, our image file format was changed to conform
to the MRC image2000 standard.  Programs now read files in either the
new or   the old format and write files in the new format. Older
versions of   IMOD   will  interpret these new files as having strange
origin values.   If you  are running an older version and you have to
work with one of these   files  (or any MRC file conforming to the new
standard), you can fix the  origin values with: </p>
    <pre>alterheader filename<br>org<br>0,0,0<br>done<br></pre>
  </dd>
  <dd>
    <h4>The Model Format</h4>
    <p> If you already have a 3-D model and wish to view it within
theIMOD model viewing program, <code>3dmodv</code>, you will need to
convert the    file into the IMOD format.  See the IMOD model file
format <a href="asciispec.html">ASCII</a> and <a href="binspec.html">binary
specifications</a> if you wish to write your own conversion program.
Model files from  the    HVEM3D program can be converted to the IMOD
model format using the <a href="man/rec2imod.html">rec2imod</a> program. </p>
    <p> The IMOD model format can be either binary or ASCII.  Currently
supported machines can all read and write binary model files
interchangeably, so   the   main use of the ASCII format would be to
access the data for analysis    or  conversion by other programs. To
convert a binary IMOD file (binary.imod)      to an ASCII  IMOD file
(ascii.imod) use the <a href="man/imodinfo.html">imodinfo</a> command : </p>
    <p><code>imodinfo -a binary.imod &gt; ascii.imod</code> <br>
or <br>
    <code>imodinfo -a -f ascii.imod binary.imod</code> <br>
will both create an ASCII model file from the binary.imod model. </p>
    <p><i> There exists an older model format which was used on our
VaxStation running the WIMP program.  The programs  written in Fortran
use the WIMP     format internally.  They will read  models in either
WIMP or IMOD format    and output models in IMOD format. </i> </p>
    <p> </p>
  </dd>
  <dt>
    <hr> <a name="Aligning Images">
    <h3>Aligning Images</h3>
    </a> </dt>
</dl>
Sometimes images in a data set are not in register with one another.
When this happens, a series of transforms will need to be found that
will align the whole stack of images.   This series of transformations
is obtained    in two stages.  First, each successive pair of images is
considered separately,    and a transform is found that aligns the
images when applied  to the second    image in the pair. This procedure
yields a list of transforms  that align each image to the previous
image; the programs consistently  refer to this as a list of "f"
transforms. If you think about it, you  will realize that simply
applying these f transforms to all of the images in the stack will not
help, because each section would be aligned to the previous one only if
that previous one were not itself transformed. A second stage is thus
necessary: one must obtain the transforms for each image that will
produce an aligned stack when actually applied to the images. This list
is consistently   referred to as a list of "g" transforms. In summary,
"f" transforms align each section to the preceding one; "g" transforms
align each section to the  whole stack.
<p>There are three general methods for obtaining alignment transforms:
manual adjustment of transformation parameters, solving for a transform
from a set of fiducial points that correspond between two sections, and
automated search for the best fit between two images. </p>
<dl>
  <dd> <br>
  </dd>
  <dd> <a name="ManualAlignment">
    <h4>Manual Image Alignment</h4>
    </a> The program <a href="man/midas.html">midas</a> is used for
manual alignment or manual adjustments to automated alignment of images. <code>Midas</code>
can be used to create a transform list or to edit an  existing list;  it
can work with either "f" or "g" transform lists. To get a "g" transform
list from an "f" transform list use the <a href="man/xftoxg.html">xftoxg</a>
program. <code>xftoxg</code> has options to  leave long term trends in
the data, which are invoked by default when you call it with the <code>xf2xg</code>
shell script. </dd>
  <dd> <a name="FiducialAlignment"> </a>
    <h4><a name="FiducialAlignment">Image Alignment using Fiducial
Markers.</a></h4>
    <a name="FiducialAlignment"> </a> The program <a
 href="man/xfmodel.html">xfmodel</a> will create a list of xf transforms
from a model containing fiducial points.   See the <a
 href="3dmodguide.html">Introduction to 3dmod</a> to see  how to make
models.
    <p> Steps and Programs used in fiducial marker alignment. </p>
    <ul>
	<li><code>imod</code> : Creates a model in which points in each contour
are placed on adjacent sections that mark the same area on both
sections. Note that a single contour corresponds to a single fiducial
marker, and   the contour contains a point on each of the sections where
the marker appears.     These are contours that pass between sections
rather than being confined    to a single section. 	</li>
      <li><code>xfmodel</code> : Creates a "f" transform list.  	</li>
      <li><code>xftoxg</code> : Creates a "g" transform list, leaving in
long term trends in the data. 	</li>
      <li><code>newstack</code> : Creates an aligned image stack. </li>
    </ul>
  </dd>
  <dd> <a name="AutomaticAlignment"> </a>
    <h4><a name="AutomaticAlignment">Automatic Image Alignment</a></h4>
    <a name="AutomaticAlignment"> </a> Several programs are used for
automated image alignment.  The programs used are <a
 href="man/xfalign.html">xfalign</a>, <a href="man/xftoxg.html">xftoxg</a>,<a
 href="man/midas.html">midas</a> and <a href="man/newstack.html">newstack</a>.
Xfalign is a csh script that  generates a "f" transform list using the <a
 href="man/xfsimplex.html">xfsimplex</a> program.  It can prefilter
images using the <a href="man/enhance.html">enhance</a> program. It also
has an option to get an initial alignment of the images by
cross-correlation, in case images are not already roughly aligned.
    <p>Steps and programs used in automatic image alignment: </p>
    <ul>
      <li>Create a "f" transform list by using the xfalign program.<br>
        <code>xfalign cell.mrc cell.xf</code><br>
Expect the alignment for each section to take on the order of  a minute
to compute. The file, cell.xf, will contain information on how to align
adjacent images to one another. </li>
      <li>The next step is to analyze the the file cell.xf and   the
transforms needed to bring all of the images in alignment with  on
another. Use the <code>xf2xg</code> shell script, an interface  to the <a
 href="man/xftoxg.html">xftoxg</a> program, to create a  global "g"
transform list from the "f" transform list:
        <p> <code> xf2xg cell.xf </code> </p>
        <p> </p>
      </li>
      <li>The output file from that command, cell.xg, should contain
all of the information needed to make new aligned images from the old
unaligned images. Use the <a href="man/newstack.html">newstack</a>
program to create    the new aligned images.  The <a
 href="man/newst.html">newst</a> shell script   acts as a front end to
the newstack program and allows for   easier command   line options. The
following example will create an aligned   file newcell.mrc   from the
old cell.mrc image file.
        <p><code> newst -xform test.xg test.mrc newtest.mrc </code> </p>
        <p> If the automatic alignment is not always correct, it can be
adjusted with the <a href="man/midas.html">midas</a> program. Start the
program with: </p>
        <p><code> midas test.mrc test.xf </code> </p>
        <p>A window will open up and you can view the alignment between
any given pair of adjacent images.  After making adjustments for any
sections that are out of alignment, save the transforms and exit the
program. Then    rerun the <code>xf2xg</code> and <code>newst</code>
commands shown   above. </p>
      </li>
    </ul>
    <p> For more background and explanation of the topics in this
section, see the <a href="serialalign.txt">guide</a> to serial section
alignment. </p>
    <p> </p>
  </dd>
  <dt> <br>
  </dt>
  <hr><a name="Quantitative Information">
  <h3>Getting Quantitative Information</h3>
  </a>In order to get accurate information the fields in the model
header have to be set properly.  See the <a href="3dmodguide.html">Introduction
to 3dmod</a>&nbsp;for an explanation of how to do this. Selecting the
Edit-&gt;Object-&gt;Info or Edit-&gt;Contour-&gt;Info   menu item from
the 3dmod Information Window      will cause the quantitative
information to be printed out in the bottom    panel  of the window.
  <p> Use the <a href="man/imodinfo.html">imodinfo</a> command to get
basic information from a model and print it out to a terminal or file.
For example:</p>
  <p> <code> imodinfo cell.imod </code> </p>
  <pre># MODEL cell.imod<br># NAME  A little cell<br># PIX SCALE:  x = 1<br>#             y = 1<br>#             z = 9.17<br># PIX SIZE      = 0.00654<br># UNITS: um<br><br>OBJECT 1<br>NAME:  spindle pole<br>       5 contours<br>       object uses closed contours.<br>       color (red, green, blue) = (0, 1, 1)<br><br>       	CONTOUR #1,2,0  16 points, length = 0.464513,  area = 0.0134249<br>        CONTOUR #2,2,0  14 points, length = 0.458311,  area = 0.0125642<br>        CONTOUR #3,2,0  8 points,  length = 0.200755,  area = 0.00277481<br>        CONTOUR #4,2,0  13 points, length = 0.313501,  area = 0.00664029<br>        CONTOUR #5,2,0  9 points,  length = 0.232374,  area = 0.00272134<br><br>        Total volume = 0.00228646<br>        Total contour cylinder surface area = 0.10012.<br>        Total mesh surface area = 0.0349499.<br></pre>
  <p> </p>
  <hr><a name="Other Output">
  <h3>Output to Other Model Formats</h3>
  </a>IMOD models can be converted to a few other 3rd party formats.
The formats     and the programs used to convert to them are listed
below.
  <ul>
    <li><a href="man/imod2vrml.html">imod2vrml</a> converts to the
Virtual Reality Modeling Language 1.0, see the <a
 href="http://www.web3d.org/vrml/vrml.htm">VRML Repository</a> for more
information. This is the format used in many web browsers for viewing 3D
models. </li>
    <li><a href="man/imod2rib.html">imod2rib</a> converts to  the   RIB
format used by Renderman. There is a set of public domain rendering
tools at the <a href="http://www.bmrt.org"> Blue Moon Rendering Tools</a>
Home Page. <br>
      <i>The Renderman (R) Interface Procedures and RIB Protocol are:
Copyright 1988,1989, Pixar. All rights reserved. RenderMan (R) is a
registered trademark of Pixar.</i> </li>
    <li><a href="man/imod.html">3dmod</a> can write files in  the   SYNU
format used by the synuview program available from the <a
 href="http://www-ncmir.ucsd.edu/"> National Center for Microscopy and
Imaging Research</a> (NCMIR). See the <a
 href="http://www-sdmir.ucsd.edu/SYNU.html">Synuview FAQ</a> </li>
    <li><a href="man/imod.html">3dmod</a> can write files in  the   NFF
format used by <a
 href="http://www.scri.fsu.edu/%7Elyons/scian/Description.html">scian</a>.</li>
  </ul>
  <p><i>See also</i>: Manual pages for <code><a href="man/imodv.html">3dmodv</a></code>,<code><a
 href="man/imodmesh.html">imodmesh</a></code>, and <code><a
 href="man/imodinfo.html">imodinfo</a></code>. </p>
  <a name="Special">
  <hr>
  <h3>Special Help Topics</h3>
  </a>
  <ul>
    <li><a href="3dmodguide.html">Introduction to 3dmod.</a> </li>
    <li> <a href="tomoguide.html"> Tomography guide.</a></li>
    <li><a href="UsingEtomo.html">Using Etomo</a>.<br>
    </li>
    <li> A <a href="etomoTutorial.html">tutorial</a> on building
tomograms with eTomo, including a sample data set.</li>
    <li> <a href="tomojoin.html"> Guide for joining tomograms from
serial sections.</a> </li>
    <li> <a href="serialalign.txt">Guide to serial section alignment.</a> </li>
    <br>
    <br>
  </ul>
</dl>
<br>
<br>
<hr><i>Last updated: November 7, 2003</i> [<a
 href="http://bio3d.colorado.edu/imod/index.html">IMOD Home Page</a>] [<a
 href="http://bio3d.colorado.edu/index.html">BL3DEMC Home Page</a>] <br>
<br>
<br>
</body>
</html>
