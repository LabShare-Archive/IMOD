<html><head><title>
IMOD Model ASCII File Format.
</title>

<body>
<H1>Imod ASCII File Format Version 1.0</H1>
<HR>
The imod ASCII file format holds a subset of the binary data.
Its main use is to simplify creating or transferring an IMOD model file.
The format hasn't been upgraded from the original Version 1.0.
<p>
Comment lines begin with a '#' charactor; blank lines are skipped.
Data lines begin with a word directive followed by data.  Some directives
will assume data on new lines.
<p>
The first data line must begin with the word 'imod' followed by the
number of objects in the model on the same line.
<p>
<code><b>imod</b> (<i>Number of Objects</i>)</code>

<H4>Optional model directives.</H4>
The following directives are optional. They can be in any order 
anywhere in the file, except in the middle of data.
Each of these directives have three data values for x, y and z.
The offsets and angles directive should be set to zero.
The x and y scale values should be set to 1.0 and the z value
should be set to compensate for the thickness of the image slices
used to create the model.
The max directive is set to the values of the image size used to
make the model.

<p>
<code>
<b>offsets</b> (<i>x</i>) (<i>y</i>) (<i>z</i>)
<br>
<b>max</b> (<i>x</i>) (<i>y</i>) (<i>z</i>)
<br>
<b>scale</b> (<i>x</i>) (<i>y</i>) (<i>z</i>)
<br>
<b>angle</b> (<i>x</i>) (<i>y</i>) (<i>z</i>)
<HR>
<H3>The object directive.</H3>
Initialize and select the current object.
object (index) (number of contours in object) (number of meshes in object)

<H4>optional object directives</H4>
<code>
<b>color</b> (<i>red</i>) (<i>green</i>) (<i>blue</i>) (<i>trans</i>)
</code>
<p>
The following are flags.
<code>
<br>
<b>open</b>
<br>
<b>closed</b>
<br>
<b>scattered</b>
<br>
<b>wild</b>
<br>
<b>fill</b>
<br>
<B>nodraw</b>
</code>

<HR>
<H3>The contour directive.</H3>
The contour directive is used for each contour in current object.
Three data variables are expected, the index to the contour that
is being defined, a surface value, and the number of points in the contour.
Point data follows on the next line, one line for each point.
<code>
<br><br>
<b>contour</b> (<i>index</i>) (<i>surface</i>) 
(<i>number of points in contour</i>)
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>)
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>) </code> ... for each point.

<HR>
<H3>The mesh directive.</H3>
An object can have more than one mesh.  A mesh is organized into polygons,
which are strips of triangles connecting two Z-levels of the object.
The mesh data consist of a single list of
unique vertices, with a normal at each vertex, plus a list of indices
into the vertex/normal list describing how the polygons are drawn.
Each mesh starts with a 
mesh directive followed by the data for that mesh.  The vertex list in 
principle could consist of just vertices, but currently files contain just
vertex/normal pairs as indicated below:
<p>
<code>
<b>mesh</b> (<i>index</i>)
(<i># of vertices + # of normals</i>) (<i>index list size</i>)
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>)</code>     vertex
<code>
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>)</code>     normal
<code>
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>)</code>     vertex
<code>
<br>
(<i>x</i>) (<i>y</i>) (<i>z</i>)</code>     normal   ... for each vertex
<code>
<br>
(<i>index</i>)
<br>
(<i>index</i>) </code>  ... for each list index
<p>	
negative index values give the following drawing instructions.
<pre>
	-1   end of list array                
	-20  next item on list is normal vector.
	-21  begin concave polygon
        -22  end polygon
	-23  begin vertex,normal polygon pairs.
	-24  begin large convex polygon with normals.

</pre>
Currently, meshes in model files consist only of polygons with vertex, normal
pairs, starting with -23 and ending with -22.  In these polygons, each set
of 6 indices describes a triangle as follows:
<pre>
<i>index to normal 1</i>
<i>index to vertex 1</i>
<i>index to normal 2</i>
<i>index to vertex 2</i>
<i>index to normal 3</i>
<i>index to vertex 3</i>
</pre>
</body></html>
