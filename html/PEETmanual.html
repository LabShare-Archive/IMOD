<html>

<head>
<title>Particle Estimation for Electron Tomography (PEET) Manual</title>

</head>

<BODY>

<h2 ALIGN=CENTER>Particle Estimation for Electron Tomography (PEET) Manual</h2>

<h3 ALIGN=CENTER>Boulder Laboratory for 3-D Electron Microscopy of Cells</h3>

<hr />

<h3>Table of Contents</h3>

<br /><a HREF="#Introdution to PEET">1. Introdution to PEET</a>
<br /><a HREF="#The Setup Tab">2. The Setup Tab</a>
<br /><a HREF="#Root Name for Output Field">2.1. Root Name for Output Field</a>
<br /><a HREF="#Directory Field">2.2. Directory Field</a>
<br /><a HREF="#Import an Existing Project Button">2.3.Import an Existing Project Button</a>
<br /><a HREF="#Copy Parameters Button">2.4. Copy Parameters Button</a>
<br /><a HREF="#Volume Table">2.5. Volume Table</a>
<br /><a HREF="#Using Relative Orientations">2.6. Using Relative Orientations</a>
<br /><a HREF="#Action Buttons">2.7. Action Buttons</a>
<br /><a HREF="#Reference Group">2.8. Reference Group</a>
<br /><a HREF="#Missing Wedge Compensation Group">2.9. Missing Wedge Compensation Group</a>
<br /><a HREF="#Masking Group">2.10. Masking Group</a>
<br /><a HREF="#Initial Motive List Group">2.11. Initial Motive List Group</a>
<br /><a HREF="#Y Axis Type Group">2.12. Y Axis Type Group</a>
<br /><a HREF="#The Run Tab">3. The Run Tab</a>
<br /><a HREF="#Iteration Table">3.1. Iteration Table</a>
<br /><a HREF="#Spherical Sampling for Theta and Psi Group">3.2. Spherical Sampling for Theta and Psi Group</a>
<br /><a HREF="#Particle Volume Fields">3.3. Particle Volume Fields</a> 
<br /><a HREF="#Use Equal Numbers of Particles Checkboxes">3.4. Use Equal Numbers of Particles Checkboxes</a>
<br /><a HREF="#Number of Particles in Averages Group">3.5. Number of Particles in Averages Group</a>
<br /><a HREF="#Particles per CPU">3.6. Particles per CPU</a>
<br /><a HREF="#3.7. Action Buttons">3.7. Action Buttons</SPAN></a>
<br /><br />

<hr />

<h3><a NAME="Introdution to PEET"></a>1. Introdution to PEET</h3>

<p>PEET is a set of programs to align and average particles extracted
from 3D volumes.&nbsp;  It finds the optimal alignment of each
particle with a reference volume through several iterations.&nbsp;
Subsequent iterations refine the optimal alignment found in the
previous iteration by aligning to a new reference generated from some
of the particles aligned on the previous iteration.&nbsp;  It has a
graphical user interface that helps users to set up options (working
directory, tomogram file name, searching parameters, etc.) and to
control the execution of the process.&nbsp;  This manual will explain
each option in the interface.</p>

<p>The interface can be accessed by starting eTomo and pressing the
<b>PEET</b> button, or by selecting <b>New PEET</b> in the File
menu.&nbsp;  Its PEET panel has 2 tabs, the Setup tab and the Run
tab.&nbsp;  The <b>Setup</b> tab has options for defining the data to
be worked on and setting up initial conditions and other features of
the search.&nbsp;  The <b>Run</b> tab has a table for entering
parameters to control each iteration of the search and options for
the final averaging operation.</p>

<H3><A NAME="The Setup Tab"></A>2. The Setup Tab</H3>

<H4><A NAME="Root Name for Output Field"></A>2.1. Root Name for Output Field </H4>

<p>Specify the base name that PEET will use to name the files it
creates.&nbsp;  To make this manual concrete, we assume the user
inputs <q>myRun</q> for the field. 
</p>

<H4><A NAME="Directory Field"></A>2.2. Directory Field </H4>

<p>Push the open file icon to pick or create a working directory.&nbsp;
PEET will store temporary files and final average volumes in this
directory.&nbsp;  A new directory is required for each separate PEET
run because a large number of files can be created.&nbsp;  Note that
tomograms and models do not need to be copied to the data directory.</p>

<p>Assuming the root name is <q>myRun</q>, the important text files in
this directory are (#k and #m stand for integer numbers):</p>

<TABLE WIDTH=639 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
<COL WIDTH=252>
<COL WIDTH=357>
<TR>

<TD WIDTH=252>
<P ALIGN=CENTER>myRun.epe</p>
</TD>

<TD WIDTH=357>
<p>Stores etomo status and options appearing on the screen but not
stored in the PEET parameter file</p>
</TD>

</TR>
<TR>

<TD WIDTH=252>
<P ALIGN=CENTER>myRun.prm</p>
</TD>

<TD WIDTH=357>
<p>Stores PEET options.&nbsp;  It has Matlab syntax and is documented in the
PEET man page.</p>
</TD>

</TR>
<TR>

<TD WIDTH=252>
<P ALIGN=CENTER>myRun*.com</p>
</TD>

<TD WIDTH=357>
<p>Stores shell commands that will be run on computers selected
by the user.</p>
</TD>

</TR>
<TR>

<TD WIDTH=252>
<P ALIGN=CENTER>myRun_MOTL_Tom#k_Iter#m.csv</p>
</TD>

<TD WIDTH=357>
<p>Optimal alignments found for particles in tomogram #k on
iteration #m - 1.&nbsp;  PEET will use them during iteration #m to
refine the alignments.&nbsp;  Fields are separated by commas.&nbsp;
Users can load these files in a spreadsheet program like Excel or
OpenOffice Calc and edit their fields.&nbsp;  MOTL stands for
motive list, a set of rotations, translations, and some other
information about each particle, including the correlation
coefficient from the alignment with the reference.</p>
</TD>

</TR>
<TR>

<TD WIDTH=252>
<P ALIGN=CENTER>myRun*.log</p>
</TD>

<TD WIDTH=357>
<p>Logs created by the shell commands.&nbsp;  Each .com file
creates one log file.</p>
</TD>

</TR>
</TABLE>
<br>

<p>Files with .mrc extension in this folder are reference volumes and
final average volumes created by PEET.&nbsp;  For example,
myRun_Ref#m.mrc is the reference volume created for alignment during
iteration #m.myRun_AvgVol_#mP#n.mrc is the average volume after #m
iterations and is the result of averaging #n particles.</p>

<p>Once you have defined the root name and the working directory, you
can begin to enter data into the volume table.&nbsp;  In addition,
before you have any data, you have a chance to bring parameter
entries into this new project in three different ways, described
next.</p>

<H4><A NAME="Import an Existing Project Button"></A>2.3. Import an Existing Project Button</H4>

<p>Use contents of a .prm file or an .epe file to fill in the
interface, including the volume table.&nbsp;  The main uses for
importing a .prm file are 1) if you have processed data with PEET
outside of eTomo and want to make it a project in eTomo; or 2) if you
have a master parameter file that you want to copy settings from.&nbsp;
Importing an .epe file also imports its corresponding .prm file and
creates an exact copy of the imported dataset.&nbsp;  The main use for
importing an .epe is to try a different set of parameters or an
additional iteration on an existing data set.</p>

<H4><A NAME="Copy Parameters Button"></A>2.4. Copy Parameters Button</H4>

<p>Use contents of a .prm or a .epe file to fill in a subset of the
fields in the interface, including the searching parameters but not
the volume table. 
</p>

<H4><A NAME="Volume Table"></A>2.5. Volume Table</H4>

<p>The Volume Table can have multiple rows, each with 5 entries.&nbsp;
Each row can be selected by clicking <b>=&gt;</b> at the beginning.&nbsp;
The entries are explained in the following table.</p>

<TABLE WIDTH=639 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
<COL WIDTH=148>
<COL WIDTH=461>
<TR>

<TD WIDTH=148>
<P ALIGN=CENTER>Volume</p>
</TD>

<TD WIDTH=461 VALIGN=TOP>
<p>File name of a tomogram.&nbsp;  The file should be in MRC format
and should be oriented so that X/Y planes are in the plane of the
specimen.&nbsp;  The same volume can be entered more than once.</p>
</TD>

</TR>
<TR>

<TD WIDTH=148>
<P ALIGN=CENTER>Model</p>
</TD>

<TD WIDTH=461 VALIGN=TOP>
<p>File name of an IMOD model.&nbsp;  All points in the first
object of the model will be used.&nbsp;  They specify the center
position of particles that will be averaged.&nbsp;  Points in other
objects of the model will be ignored.&nbsp;  Typically you would
make the object type be scattered points, unless your particles
are along filaments, where an open contour object would be more
useful.</p>
</TD>

</TR>
<TR>

<TD WIDTH=148>
<P ALIGN=CENTER>Initial MOTL</p>
</TD>

<TD WIDTH=461 VALIGN=TOP>
<p>File name of an initial motive list file, which specifies how
to approximately align each particle with the reference so that
PEET only needs to search over small angular ranges to find the
optimal alignment.&nbsp;  This file is used only if the <b>Use
files</b> option is selected in the <q>Initial Motive List</q>
group box (see below); the entry is disabled unless this option is
selected</p>
</TD>

</TR>
<TR>

<TD WIDTH=148>
<P ALIGN=CENTER>Tilt Range</p>
</TD>

<TD WIDTH=461 VALIGN=TOP>
<p>The tilt range used to collect the tomogram, which is needed to
compensate correlation coefficients for the effects of the missing
wedge.&nbsp;  This entry is disabled by default.&nbsp;  To enable
it, check <b>Use tilt range in averaging</b> in the <q>Missing
Wedge Compensation</q> checkbox group.&nbsp;  You can find out the
range used by pressing the <b>Read Tilt File</b> button if you
have .tlt file.&nbsp;  If you want to use missing wedge
compensation, the range has to be specified.</p>
</TD>

</TR>
<TR>

<TD WIDTH=148>
<P ALIGN=CENTER>Rel. Orient.</p>
</TD>

<TD WIDTH=461 VALIGN=TOP>
<p>Abbreviation for relative orientation.&nbsp;  These angles
represent a rotation that will be applied to all particles from a
tomogram to bring them to approximately the same orientation as
the reference.&nbsp;  This rotation is combined with the angles for
each particle in the initial MOTL file, if any.&nbsp;  The angles
are 3dmod slicer X, Y, and Z angles in degrees, which are applied
in the order Z, Y, X.&nbsp;  The use of this feature is described
below.</p>
</TD>

</TR>
</TABLE>
<BR>

<H4><A NAME="Using Relative Orientations"></A>2.6. Using Relative Orientations</H4>

<p>The most common use of relative orientations is when combining
data from multiple tomograms for which you have already run PEET
separately.&nbsp;  Here, you might pick the average from one of the
tomograms as the reference for further alignment.&nbsp;  Use the final
MOTL files from the previous runs and the initial MOTL files for each
volume.&nbsp;  Open the average from each of the other tomograms in
3dmod and rotate it in Slicer until it approximately matches the
orientation of the reference average.&nbsp;  One way to do this is to
open all of the averages together in 3dmod and use Edit-Angles to
open the Slicer Angles dialog.&nbsp;  After you turn on <q>Auto</q> in
the toolbar that appears in the Slicer, angles are continuously saved
in the Angles table as you change them in the Slicer, and when you
switch between different volumes (times) the saved angles will be
restored for the volume that you switch to.&nbsp;  In this way, you
can adjust angles and toggle between volumes to assess the alignment.</p>

<p>Another possible use of this feature would be to indicate relative
orientations between the structures in multiple tomograms where no
initial averaging has been done.&nbsp;  In this case, the reference
could be a particle from one of the tomograms or a file with a
reference volume.&nbsp;  The slicer angles should be found that bring
the structures in a given tomogram into approximately the same
orientation as this reference.&nbsp;  As indicated in the table above,
any rotations in an initial MOTL file will be applied after the
rotation from the relative orientation.&nbsp;  Also, if you have
structures along fibers in multiple tomograms, you can use the
options described below to initialize the Z axis or the X and Z axis
in the motive list, and then these relative orientations are both
unneeded and counterproductive.</p>

<H4><A NAME="Action Buttons"></A>2.7. Action Buttons</H4>

<p>Press <b>Add Volume and Model</b> to add a row to the table.&nbsp;
File choosers will open to allow you to pick the reconstruction file
and model file.&nbsp;  To add a volume and model which requires the
same settings as a volume and model in another row, highlight the
other row with <b>=&gt;</b> and press <b>Add with Copied Data</b>.</p>
<p>After you highlight an existing row in the table with <b>=&gt;</b>,
other buttons become available.&nbsp;  You can use <b>Change Model</b>
to change just the model file on that row.&nbsp;  Press <b>Set Initial
Motive List File</b> to open a file chooser and pick an initial MOTL
file.&nbsp;  After turning on missing wedge compensation, you can
press <b>Read Tilt File</b> to read the minimum and maximum tilt
angles from a .tlt file.&nbsp;  Press <b>Move Up</b> or <b>Move Down</b>
to change the location of the highlighted row in the table.&nbsp;
Press <b>Delete Row</b> to delete the current row from the table.&nbsp;
Press <b>Open in 3dmod</b> to open the volume and model files in
3dmod.&nbsp;  You can right click this button to open the volume
binned by 2 or to open 3dmod with the startup window in order to pick
other options.</p>

<H4><A NAME="Reference Group"></A>2.8. Reference Group</H4>

<p>Check the <b>Volume</b> radio button to use a particle of a
tomogram as the reference; input the tomogram number in the spin box
and the particle number in the field with the heading <b>Particle
#:</b>.&nbsp;  Particles are numbered sequentially as if all the
contours were combined into one; e.g., if the first contour has 100
particles, then the 20th particle of the second contour is
number 120.</p>

<p>Check the <b>Reference file</b> radio button to use a separate
volume as the reference and input the file name of the stack in the
field or use the file chooser to find it.</p>

<H4><A NAME="Missing Wedge Compensation Group"></A>2.9. Missing Wedge Compensation Group</H4>

<p>Check <b>Use tilt range in averaging</b> to use PEET’s missing
wedge compensation for averaging.&nbsp;  Instead of forming a sum in
real space of all of the aligned particles, it forms a sum of their
Fourier transforms and divides each voxel component of the FFT by the
number of particles contributing data outside the missing wedge to
that voxel.</p>

<p>If the first option is selected, you can also check <b>Use tilt
range in alignment</b> to use PEET’s missing wedge compensation of
correlation coefficients during alignment.&nbsp;  This compensation
involves boosting up the correlation coefficients when there is less
overlap between non-missing wedge regions of the particle and the
reference.&nbsp;  Specifically, the correlation coefficient is
multiplied by the ratio between the maximum fraction of Fourier space
volume that has data from non-missing wedge regions and the actual
fraction of overlapping volume with data for the particular particle
and set of rotation angles.&nbsp;  This kind of compensation is
relevant only when the reference is a particle with a missing wedge,
rather than an average.</p>

<p>If <b>Use tilt range in alignment</b> is checked, another option
is available for performing a second kind of compensation for the
missing wedge when selecting particles to be averaged on the first
round.&nbsp;  After optimal alignment is computed for each particle,
the particles can be divided into groups based on how much a
particle’s non-missing area overlaps with that of the reference in
Fourier space.&nbsp;  After grouping, particles’ correlation scores
are scaled so that each group has about the same median score.&nbsp;
The adjusted scores are then used to select particles to form the
reference for the second iteration, and the averages if the user
chooses to output them for the second iteration.&nbsp;  The result is
that nearly equal numbers of particles from each of the orientation
groups are included in the reference, thus minimizing a missing wedge
bias in that reference that would be reinforced on the second
iteration.&nbsp;  To use this option, turn on <b># of weight groups
fro equalizing CCCs</b> and select the desired number.&nbsp;  The
number of groups to pick depends on the number of particles.&nbsp;  It
is probably best to have at least 20 particles per group, but there
is little to be gained from having more than 10 groups even if there
are many particles.&nbsp;  This option is most effective if particles
assume a variety of original orientations.&nbsp;  If particles all
have about the same orientation, for example, particles from a
non-twisting microtubule sitting in the X-Y plane, you may not want
to use the option.</p>

<p>The <b>Edge shift</b> entry specifies the number of pixels in from
the edge of the missing wedge to include when averaging with missing
wedge compensation.&nbsp;  Some useful information seems to spread
into the missing wedge during backprojection.&nbsp;  A value of 1-2
pixels is appropriate.</p>

<H4><A NAME="Masking Group"></A>2.10. Masking Group </H4>

<p>Users can mask out an area of the reference that they want to
exclude from being used for cross-correlation.&nbsp;  The default is
no masking.&nbsp;  However, the user can choose a volume, a sphere, or
a cylinder as the mask by checking the corresponding radio button.&nbsp;
For example, when averaging a virus, you might use a spherical mask
to align only on the capsid and mask out the interior of the virus,
or vice versa.&nbsp;  A cylindrical mask could be used when aligning
subunits of a microtubule to exclude variable material outside the
microtubule, such as a neighboring microtubule.</p>

<p>If the mask is a volume, the user has to input the file name of
that volume.&nbsp;  A voxel of the reference volume is masked out if
the value of its corresponding voxel in the mask volume is zero.&nbsp;
The dimensions of the mask volume can be smaller than the dimensions
of the reference volume.&nbsp;  In this case, the mask volume is
centered inside the reference (TRUE?) and voxel values outside the
mask volume are determined by the value of the majority of 8 corner
voxels of the mask volume.&nbsp;  A convenient way to generate a mask
volume is to use the IMOD program imodmop, which can be used to
retain pixels inside of spheres and cylinders as well as inside of
closed contours.&nbsp;  For this purpose, it does not matter that this
program leaves original density values rather than 1’s in the
region that is retained.</p>

<p>If the mask is a sphere or a cylinder, the user has to specify the
inner radius and the outer radius.&nbsp;  The center of the sphere is
the center of the reference volume.&nbsp;  The reference voxels inside
the inner radius and outside the outer radius will be masked out.</p>
<p>The orientation of a cylinder is determined by a line passing
through one specified particle and the next particle in sequence.&nbsp;
In the most general case, you can specify the particle by setting the
model number and particle number in the <q>Cylinder Orientation</q>
box.&nbsp;  When the reference is a particle, already specified by
such a pair of integers, the <b>Set cylinder orientation from
reference particle</b> check box is enabled.&nbsp;  If the box is
checked, the orientation of the cylinder is along the line passing
through the reference particle and the next particle.</p>

<H4><A NAME="Initial Motive List Group"></A>2.11. Initial Motive List Group</H4>

<P>These controls
provide three different options for setting up an initial motive list
with starting orientations for all particles.&nbsp;  Such initial
orientations can allow the angular search to be done over a limited
range, even when the particles have significantly different
orientations.&nbsp;  The first two options involve deriving an
orientation from the line between one particle and the next in the
IMOD model.&nbsp;  In these cases, the reference has to be specified
by a particle number, not a separate file, so that the orientation at
a given particle can be compared with the orientation of the
reference.&nbsp;  If you are modeling particles along more than one
filament, you should start a new contour for each filament so that
PEET will not base any orientations on the lines from the end of one
filament to the start of the next.</p>

<H5>2.11.1. Initialize Z Axis</H5>

<P>Use this option if
each particle can be aligned approximately with the reference by
rotating it only around the Z axis.&nbsp;  PEET will compute the
rotations needed based on trajectories between successive points in
the IMOD model.&nbsp;  We find the option is most useful when all
particles have about the same Z coordinate, for example, when
particles are from a bending, non-twisting microtubule sitting in the
X-Y plane.</p>

<H5>2.11.2. Initialize X and Z Axis</H5>

<P>If the trajectory
between particles does not lie in the X-Y plane, then this option can
be used instead to compute a more general rotation that aligns the
trajectory at a particle with the trajectory at the reference.</p>

<H5>2.11.3. Use files</H5>

<p>Use this option if you have a text file in .csv format specifying
the approximate rotation for each particle.&nbsp;  Such a file can be
obtained from a previous run of PEET or from an auxiliary program
that computes initial orientations from a model for a particular
situation.&nbsp;  There are several such programs in PEET; for
example, there is one to generate such a file if particles are from a
bending, twisting microtubule assuming a general 3D orientation.</p>

<H4><A NAME="Y Axis Type Group"></A>2.12. Y Axis Type Group</H4>

<p>These options define the first rotation axis that PEET uses for
angular search, the one referred to as Phi in the iteration table.&nbsp;
The default is the original Y axis of the tomogram.&nbsp;  In this
case, Phi corresponds to the Y axis, Theta to the Z axis, and Psi to
the X axis.&nbsp;  However, the user can define their own first
rotation axis and PEET will deduce the second and third rotation axis
assuming a right-handed Cartesian coordinate system.&nbsp;  This
option is useful when running searches with restricted ranges if you
want to provide a different range or increment for the different
axes.&nbsp;  It can be used when the reference is a file as well as
when it is a particle.</p>

<p>If <b>Particle model points</b> is selected, the first rotation
axis will vary from particle to particle and will be the vector
connecting 2 consecutive model points in the IMOD model contour.&nbsp;
With this option, Phi represents twisting around the contour axis;
Theta represents bending or turning in the X-Y plane, and Psi
represents dipping in Z.&nbsp;  This option is most useful when
particles sit along contours, for example, when particles are along a
microtubule.&nbsp;  When using this option, be sure to model separate
filaments in separate contours.</p>

<p>If <b>End points of contour</b> is selected, an arbitrary vector
can be used as the first rotation axis by taking the vector
connecting the two end points of a contour in one of the particle
models.&nbsp;  The contour is specified by three integers: the model
(tomogram) number, the IMOD object number, and the contour number.</p>

<H3><A NAME="The Run Tab"></A>3. The Run Tab</H3>

<H4><A NAME="Iteration Table"></A>3.1. Iteration Table</H4>

<p>Each row of this table specifies options for a single iteration
and has four types of entries entries.</p>

<p>The <b>Angular Search Range</b> entries set search ranges and
increments (step size) in degrees for the 3 rotations (Phi, Theta,
and Psi, referring to rotations around Y, Z, and X axes).&nbsp;  For
example, if <b>Max</b> and <b>Incr</b> fields of Phi are set to 4 and
2 respectively, Phi will have a range of -4 to +4 and will assume 5
values (-4, -2, 0, 2, 4).&nbsp;  The general rule is that earlier
iterations should have a bigger range and increments.&nbsp;  After a
coarse alignment has been found, subsequent iterations can have a
smaller range and increments.&nbsp;  If you want to avoid searching
around an axis, set the <b>Max</b> to 0 and either leave <b>Incr</b>
blank or set it to 1.</p>

<p>The <b>Search Radius</b> entry can be either a single number or
three numbers, and it sets the amount of translation allowed in the
X, Y, and Z directions.&nbsp;  For example, setting it to 2 will limit
the translation to between -2 and +2 in each of the 3 directions.&nbsp;
These directions are in the coordinate system of the tomogram, i.e.,
of the unrotated particle, so using three different limits would be
useful only if particles all had similar orientations with respect to
at least one axis.&nbsp;  This entry does not affect execution time,
but small values can make the alignment more reliable by preventing
spurious correlation peaks at higher translations from being picked.&nbsp;
Also, before correlation, regions as wide as the search radius at
each edge of the particle volume are set to zero to keep the
correlation from being affected by data that wraps around in the
FFT’s.&nbsp;  Thus, the larger the search radius, the fewer voxels
are actually included in the correlation and the lower the
signal-to-noise ratio of the correlation.</p>

<p>The <b>High-Freq. Filter</b> entry sets the parameters for
filtering out high frequencies.&nbsp;  As in IMOD, frequencies are in
reciprocal pixels, 0.5 is the Nyquist frequency, and 0.86 corresponds
to the highest frequency in the corners of 3D FFTs.&nbsp;  The <b>Cutoff</b>
field sets the cutoff frequency, where Gaussian Frequencies higher
than the cutoff will be filtered out by a Gaussian that starts at 1
at the cutoff and falls of with the value in the <b>Sigma</b> field.&nbsp;
Both the reference and the particle are filtered separately, so the
correlation is essentially filtered twice.&nbsp;  One way to see what
a reference or particle looks like with a particular filter is apply
the same filter to a file with the IMOD program mtffilter, e.g., with
the command <q>mtffilter -3d -low cutoff,sigma input_file output_file</q>.&nbsp;
You can do this with the reference particle
extracted by PEET, or you can extract a particle from the tomogram in
3dmod using the rubber band in the Zap window and the Extract entry
in the File menu.</p>

<p>The <b>Reference Threshold</b> field controls how many particles
are used to form the reference for the next iteration.&nbsp;  If it is
a number bigger than one, it specifies the number of particles with
the highest correlation coefficients.&nbsp;  A rule of thumb is to use
two thirds of the total number of particles; however, in some cases
you might want to include all particles on a first round to minimize
any missing wedge bias in the new reference.&nbsp;  If this entry is a
number smaller than one, it specifies a correlation coefficient to
use as an absolute threshold.&nbsp;  We have not found this way of
specifying the threshold very useful.</p>

<H4><A NAME="Spherical Sampling for Theta and Psi Group"></A>3.2.Spherical Sampling for Theta and Psi Group</H4>

<p>This option is designed to make full angular searching on the
first iteration more efficient by sampling orientation space at
relatively uniform intervals.&nbsp;  It is referred to as spherical
sampling because the second and third search angles (Theta and Psi)
correspond to a point on a sphere (Phi corresponds to rotation around
the axis from the center of the sphere to that point).&nbsp;  Simply
varying both angles at regular increments results in oversampling
near the north and south poles.&nbsp;  With spherical sampling, PEET
will avoid this oversampling.&nbsp;  If <b>Full sphere</b> is checked,
PEET will sample the whole sphere.&nbsp;  If <b>Half sphere</b> is
checked, PEET will only sample one half of the sphere.&nbsp;  The
<b>Sample interval</b> field specifies the interval in degrees.&nbsp;
Typically, you would enter a <q>max</q> of 180 for For a unit sample
sphere, sample points are placed on latitude lines separated by the
sample interval, and the points along each latitude line are
separated by 2*Pi*sampleInterval/360 along.&nbsp;  This means there
are the most sample points on the equator; the higher the latitude
is, the fewer sample points there will be.&nbsp;  At the poles, there
will be only one sample point.&nbsp;  For a full angular search, enter
a <b>Max</b> of 180 and an appropriate increment for <b>Phi</b>, and
enter the same increment as the sample interval.</p>

<H4><A NAME="Particle Volume Fields"></A>3.3. Particle Volume Fields</H4>

<p>These fields set the X, Y, and Z dimensions of the particles.&nbsp;
For example, if X, Y, and Z are all set to 64, particle volumes will
have dimensions of 64x64x64.&nbsp;  The center of a particle volume is
the X, Y, and Z position of the particle in an IMOD model.</p>

<p>Due to a restriction of IMOD FFT routines, the biggest prime
factor in any dimension cannot be greater than 19; eTomo will check
the values that you enter to make sure they meet this restriction.</p>

<H4><A NAME="Use Equal Numbers of Particles Checkboxes">3.4. Use Equal Numbers of Particles Checkboxes</H4>

<p>The checkboxes <b>Use equal numbers of particles from all tomograms
for new reference</b> and <b>Use equal numbers of particles from
all tomograms for averages</b> provide another tool for
reducing bias when combining data
from multiple tomograms and using a particle or average from one as a
reference.&nbsp;  If checked, PEET will use equal numbers of particles
from each tomogram to form the references or averages.&nbsp;
Otherwise it will use the particles with the best correlation scores
among all particles of all tomograms.</p>

<H4><A NAME="Number of Particles in Averages Group"></A>3.5. Number of Particles in Averages Group</H4>

<p>Specify how many particles to use to form averages.&nbsp;  For
example, if <b>Start</b> is set to 50, <b>Incr</b> is set to 50, <b>End</b>
is set to 150, and <b>Additional numbers</b> is set to 165; there
will be 4 final averages, based on 50, 100, 150 and 165 particles.&nbsp;
If <b>End</b> is not bigger than <b>Start</b> by a multiple of the
increment (e.g., 160), the last number in the sequence will be the
one smaller than <b>End</b> (e.g., 150).</p>

<p>The biggest number entered in these fields cannot be bigger than
the total number of particles in all tomograms.&nbsp;  The <b>Additional
numbers</b> should be in order and all larger than <b>End</b>.</p>

<H4><A NAME="Particles per CPU"></A>3.6. Particles per CPU</H4>

<p>Specify how many particles each CPU should process in one chunk.&nbsp;
The fewer the particles, the more command and log files will be
created.&nbsp;  Having more particles per chunk can make the parallel
processing less flexible in case you need to kill or pause and resume
the processing.&nbsp;  The default of 5 is good for most purposes.</p>

<H4><A NAME="3.7. Action Buttons"></A>3.7. Action Buttons</H4>

<p>After you select computers and/or processors in the parallel
processing table, press <b>Run</b> to start the processing.&nbsp;
eTomo writes the .prm file and runs the PEET program prmParser to
produce a series of numbered command files to be run by
processchunks.&nbsp;  The first command file initializes the motive
lists and prepares the reference particle.&nbsp;  This can take some
time, because the program needs to figure out how big to make the
reference.&nbsp;  Command files for aligning the particles are run
next, with a <q>-sync.com</q> file run at the end of each iteration to
combine the results from the different chunks and compute a reference
for the next iteration.</p>

<p>When the processing is done, press <b>Open Averaged Volumes in
3dmod</b> to see all of the computed averages together in one 3dmod.&nbsp;
The Isosurface window will be opened automatically.&nbsp;  Note that
the isosurface threshold can be adjusted independently for each time
(average).&nbsp;  You can also press <b>Open Reference Files in 3dmod</b>
to see the references generated on each round.&nbsp;  The reference
will be larger than the averages.</p>

</body>

</html>