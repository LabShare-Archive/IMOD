3dmod(1)                                                              3dmod(1)



NNAAMMEE
       3dmod - Make a model from a 3-D image stack.

SSYYNNOOPPSSIISS
       3dmod [options] [image filenames]  [model filename]

DDEESSCCRRIIPPTTIIOONN
       3dmod is typically invoked with one image file, but multiple image
       filenames can also be given.  The model filename is optional; if 3dmod
       is called without a model file it will create a new model.  The user
       can load new model files using a menu selection once 3dmod is running.
       If the model file does not already exist, 3dmod will create a new model
       under that name.  The image files may also be omitted, in which case
       3dmod will draw the model on top of blank images.  A file containing a
       list of image files can be used in place of the image file names on the
       command line.  If multiple files of different sizes are loaded, then
       the size of the display in each dimension will be limited to the mini-
       mum size of the various files.  If 3dmod is invoked with options but no
       filenames, then a dialog window will open to allow selection of an
       image file.  If 3dmod is invoked with no options or filenames, or with
       the --OO option, then a startup dialog will open to allow options to be
       set.


       The model must be in the IMOD model format.  Images can be in the MRC
       image format; in the TIFF format, if the appropriate TIFF library is
       available; in any of the formats supported by the Qt image-reading
       function, which include JPEG, PNG, PPM, and BMP; or in a raw format
       where data are packed sequentially as in MRC files.  MRC files of
       almost any mode can be read in: byte, 16-bit integer, real, complex
       real, complex integer, or color (RGB).  TIFF files may be byte, 16-bit
       integer, or color; they may be organized in strips or in tiles.  TIFF
       files with various kinds of compression can be read, depending on the
       capabilities of the libraries on the system.  Raw files can be read if
       their dimensions, data type, and header size are defined.  This infor-
       mation can be provided with the options --rr,, --tt,, and --HH or through a
       dialog box that is brought up when a file is encountered that cannot be
       read by other means.

       When multiple files are read in, they do not need to be the same mode
       or even the same format (except that if any file is an RGB file, all
       files must be.)  Images are loaded into an image cache under certain
       circumstances: whenever more than one file is specified, when montaged
       data are loaded, or when you enter the --CC option to limit the size of
       the cache.  By default, the cache will be fully loaded upon program
       startup and the program will behave the same as with regular data load-
       ing.  However, if you limit the size of the cache, images are loaded
       only when needed.  This has various implications that are mentioned
       below.  Starting a movie through the images will eventually load as
       much data as will fit into the cache.  In addition, there is a dialog
       box to fill the cache in various ways, available through the Edit-
       Image-Cache Filler menu entry.  Several other restrictions on image
       files exist.  If any files other than MRC-type (MRC or raw) are loaded
       and the cache is used, the image volume cannot be flipped (Y and Z
       exchanged) unless it is fully loaded into the cache.  The Pixel View
       window, high-resolution mode in the Graph window, and the f and F hot
       keys for finding pixel values will all give zeros for a non-MRC type
       file.  If RGB files are loaded, only the Zap and Model View windows can
       be opened.

       Two windows will open upon startup: the Information Window and an image
       window.  The Information Window is the main control window; it has a
       menu bar and has indicators that give information about the selected
       model point and the selected graphics voxel.  The bottom of the infor-
       mation window also has a status box that shows the progress of certain
       operations while using 3dmod.  While the image is loading, the Informa-
       tion Window will report the status of the image load.  Selecting the
       Quit menu item from the File menu will cancel the image load.  If the
       image cache feature is used, the image window will open up after the
       first image section is loaded; otherwise, the image window won’t open
       until the entire image has been loaded.

       The ZaP Window is the default image display window used by 3dmod.  It
       allows one to view an image at any magnification and to pan the image
       around inside a resizable window.  Most manual model editing is done
       within the ZaP Window.

       Additional windows that may be opened via menu selection are the
       Slicer, XYZ, Tumbler, Graph, Pixel View, and Model View windows.
          The Slicer Window allows one to view slices through the 3-D image
       data.  If the image cache is turned on, only images in the cache will
       be displayed in views that contain data from multiple Z sections.
          The XYZ Image Window displays slices of the 3-D image in planes per-
       pendicular to the X,Y and Z axis.
          The Tumbler Window allows one to view a small projected view of the
       area around the current point.
          The Graph Window graphs intensity along a given axis or along a
       given contour.
          The Pixel View Window shows the actual pixel values from the image
       file around a given point.
          The Model View Window views the model in a 3D rendering while it’s
       being built.


   OOppttiioonnss
       3dmod will accept some Qt options (such as -style) along with the fol-
       lowing options:

       --xx <<mmiinn,,mmaaxx>>
       --yy <<mmiinn,,mmaaxx>>
       --zz <<mmiinn[[,,mmaaxx]]>>
              The --xx,, --yy and --zz options can be used to load in a sub-area of
              the original image.  The offsets are saved in the model so if a
              different area is loaded the model is automatically transformed
              to match the new sub area.

       --BB <<vvaalluuee>>
              Bin images by the given amount in all three dimensions.  For
              binning by 2, 3dmod averages 8 pixels to produce one display
              pixel.  Models built on unbinned images will be displayed prop-
              erly on binned images and, when saved again, will display prop-
              erly on unbinned images again.  RGB images and multiple single
              image files being displayed as sections may not be binned.

       --bb <<nnxxyy[[,,nnzz]]>>
              Bin images by nnxxyy in X and Y and by nnzz in Z.  Omit nnzz for no
              binning in Z.

       --ss <<mmiinn,,mmaaxx>>
              The --ss option will scale image intensities linearly so that the
              min and max values will be displayed as black (0) and white
              (255) on the screen.  Without this option, intensities are
              scaled between the minimum and maximum intensities in the image
              file.  Images can be rescaled after 3dmod is running using the
              menu entry Edit-Image-Reload.  If raw image files are being
              read, entering this option will set the scaling limits for these
              files and prevent them from being scanned for their minimum and
              maximum values.

       --xxyyzz   This option causes the default image window to be the XYZ window
              instead of the ZaP window.

       --SS     This option causes a slicer window instead of the ZaP window to
              be opened when the program starts.

       --VV     This option causes a model view window instead of the ZaP window
              to be opened when the program starts.

       --ZZ     This option causes a ZaP window to be opened even if one of
              --xxyyzz,, --SS,, or --VV is entered.  These 4 options can all be used
              together to open a selected set of windows.

       --YY     This option causes the image data to be flipped after it has
              been loaded.  This allows one to model image planes that are
              normal to the Y-axis.  The default is to model planes normal to
              the Z-axis.  It is possible to flip back and forth between these
              two modeling orientations using the _E_d_i_t _I_m_a_g_e menu item _F_l_i_p_.
              Certain cached data can not be flipped unless they are entirely
              loaded into memory: TIFF files, montaged images, images loaded
              with different binning in Z than in X and Y, and multiple sin-
              gle-image files.

       --hh --hheellpp
              Print some quick help for 3dmod’s command line options to the
              terminal.

       --OO     Open the startup dialog box for setting program options and
              selecting files.  The box will be filled in with any other argu-
              ments included in the command line.

       --CC <<vvaalluuee>>
              The --CC option controls the image cache used by 3dmod.  By
              default, 3dmod will try to load the entire image into an ordered
              array in memory.  This option can force a given number of images
              to be loaded into a more flexible memory cache.  Alternatively,
              one can limit the size of the cache in megabytes by entering a
              value with m or M on the end.  For example, --CC 220000MM will limit
              the cache to 200 megabytes.  The reason for using this option is
              either to decrease start up time or to view large data sets that
              can’t fit into main memory.  This features works best with the
              ZaP Window, which always loads the image that it needs into the
              cache.  Other image windows will only be able to access image
              data that are already within the cache.  As a special case,
              entering --CC 00 will set up a cache that is large enough to hold
              all image data but will load images only when needed.

       --FF     Fill the image cache upon program startup, before displaying any
              images.  This option is useful if you will be using the Slicer
              or XYZ windows, to avoid seeing incomplete slices.  This flag is
              not needed unless you define the size of the cache with the --CC
              option.

       --pp <<ffiilleennaammee>>
              Load a file containing a piece list for the input image.  This
              allows one to montage image sections together or to view images
              that are either missing sections or have sections out of order.
              The piece list is an ASCII text file with the following format.
              There are as many lines as the input image has frames (the z
              dimension of the image file).  Each line contains three values
              <X> <Y> and <Z> which represent the starting location of each
              frame in the input image stack.  Using the piece list option
              will also turn on the image cache with a default size equal to
              the total number of image z-planes that contain data.  The image
              cache can’t be turned off, but the size can be changed with the
              --CC option.

       --PP <<nnxx,,nnyy>>
              Create an internal piece list to display images from the file in
              a montage of _n_x by _n_y pieces.  If an external piece list file is
              entered with the --pp option, then this option is ignored; with
              this option, montage information in the file header is ignored.

       --oo <<nnxx,,nnyy>>
              When creating an internal piece list with the --pp option, set the
              overlap between pieces to _n_x in the X direction and _n_y in the Y
              direction.  Enter negative numbers to get space (gutters)
              between the pieces.

       --rr <<nnxx,,nnyy,,nnzz>>
              Set the size for raw image files to _n_x in X, _n_y in Y, and _n_z in
              Z.  This entry will be applied to all raw files and will prevent
              the Raw Image Description dialog from being brought up for any
              raw files.

       --tt <<vvaalluuee>>
              Specify the type of raw files using a value corresponding to an
              MRC mode: 0 for unsigned bytes, 1 for signed 16-bit integers, 2
              for 32-bit floating point, 4 for complex (pairs of floating
              point numbers), or 16 for color files stored as R-G-B triplets
              of bytes.

       --HH <<vvaalluuee>>
              Set the size of the header to be skipped, in bytes, for raw
              image files.

       --ww     Swap bytes when reading raw image files.

       --ff     Load file as individual frames, overriding montage information
              in the image file header.  It is possible for an image file to
              have piece coordinates stored in its header rather than in a
              separate piece list file.  3dmod will automatically load such a
              file as a montage, so this option is available to override this
              behavior and force loading as individual frames.

       --mm     This option overrides the model transformation behavior and
              causes the model to be loaded without any transformations.  This
              option is useful for loading an existing model onto a data stack
              after it has been flipped in Y and Z or after the pixel size or
              origin has been changed in the image file header.

       --TT     Load multiple single-image files as files at different times
              (the behavior before IMOD 3.2.3).  By default, such files will
              now become multiple sections in Z instead.

       --MM     Load Fourier transform files without mirroring the data around
              the origin.  By default, a complex mode input file whose X
              dimension is odd will be loaded with replication of the data on
              the left side of the Y axis, to make it easier to visualize.
              This option can be used override that behavior if it is inappro-
              priate for the input file or if there is not enough memory to
              show the redundant data.

       --ccii    Display images in color index mode using a color table, rather
              than in 24-bit color mode.  Color index mode only has 8 bits and
              works rather poorly under Qt.

       --GG     Display an RGB-mode MRC file in gray-scale rather than in color.
              If the list of files being loaded includes a color TIFF file,
              all files will be displayed in color regardless of this option.

       --vviieeww --mmooddvv
              Either option will run 3dmod in model view mode, the same as
              using the command 3dmodv to start the program.  Only 3dmodv(1)
              options are allowed in this case.

       --EE <<kkeeyyss>>
              Open the windows specified by the key letters: t for Object
              Type, l for Object Color, h for Model Header, o for Model Off-
              set, s for Surf/Cont/Point, v for Contour Move, c for Contour
              Copy, a for Auto Contour, b for Contour Break, j for contour
              Join, p for Image Process, r for Image Reload, f for Image Cache
              Filler, u for Tumbler, x for Pixel View.  If the --VV option is
              given, then model view dialog boxes can also be opened with key
              letters the same as their hot keys (m, O, C, L, B, M, V, I), or
              with D for depth cue and S for stereo.

       --WW     Output the window ID of the 3dmod Information Window and do not
              put 3dmod in the background automatically.

       --DD     Run in debug mode with diagnostic output and without becoming a
              background process.  Key letters can be added after the D (but
              with no intervening spaces) to turn on specific debugging out-
              put; e.g., u for undo, z for zap, c for control, k for
              keystrikes.


UUsseerr IInntteerrffaaccee FFeeaattuurreess
       A large number of dialog boxes can be opened from the menus of the
       Information Window and the Model View Window.  Nearly all of these are
       tool windows that can be left open while doing other tasks in the pro-
       gram.  These tool windows pass hot keys on to image windows, so that
       one can use hot keys to perform actions in an image window without hav-
       ing to make that window have the keyboard focus.  Tool windows opened
       from the Information Window menu will pass keystrokes on to the most
       recently active image display window.  Tool windows opened from the
       Model View Window menu (i.e., 3dmodv dialog boxes) will pass keystrokes
       on to the Model View Window.

       Preferences for some aspects of the appearance and behavior of 3dmod
       can be set and saved between sessions of the program, using the 3dmod
       Preferences dialog box available through the Edit-Options menu entry.
       Among other features, the font size and type and the style of the
       interface may be changed, the size and color of marker points can be
       adjusted, and custom zoom values can be defined.  On Unix systems,
       preferences are saved to the file $HOME/.qt/3dmodrc.  Only those prop-
       erties that the user has changed are saved to and restored from this
       file, while properties that have never been changed will be set to the
       current program defaults.

       The 3dmod Preferences dialog also allows the function of the three
       mouse buttons to be remapped in any desired way.  Because of this flex-
       ibility, mouse functions are described here and in the help windows of
       3dmod in terms of the first, second, and third buttons.  By default,
       these correspond to the left, middle, and right buttons.

       By default, the sliders in 3dmod are continuously active, or hot, which
       means that the program will attempt to update the display as a slider
       is dragged.  If the program can not keep up well enough, the continuous
       update can be stopped by pressing the Ctrl key while dragging the
       slider.  In the Preferences dialog, a different key can be selected to
       control this behavior, and the behavior can be inverted so that sliders
       are hot only when the control key is pressed.

       Nearly all controls in 3dmod have tooltips that will appear when the
       mouse pointer is left over a control for about half a second.  These
       tooltips can be disabled in the Preferences dialog.

       Snapshots can be taken of image and model view windows with hot keys.
       A TIFF snapshot can be taken with Ctrl-S.  Snapshots in other formats
       such as JPEG, PNG, and SGI RGB can be taken with S.  The format of
       these non-TIFF snapshots can be selected in the Preferences dialog.

       The Escape key can be used to close all windows except the Information
       Window, or the 3dmodv window when running 3dmodv.


IInnffoorrmmaattiioonn WWiinnddooww
       The Information Window is 3dmod’s main control window and it is open at
       all times while 3dmod is running.  All other windows can be opened and
       closed without restarting 3dmod.

       _W_i_n_d_o_w _C_o_n_t_r_o_l _B_u_t_t_o_n_s
              The toolbutton with the pushpin can be used to keep the Informa-
              tion Window on top of all other windows, including windows from
              other programs.  The toolbutton with two up arrows can be used
              to raise all of the windows of the current 3dmod above windows
              from other programs.

       _U_n_d_o_/_R_e_d_o _B_u_t_t_o_n_s
              The toolbuttons with the backward and forward arrows can be used
              to undo modeling actions and to redo actions that were undone,
              respectively.  The traditional hot keys, Ctrl-Z and Ctrl-Y, can
              also be used for this purpose.  Virtually every model change can
              be undone.

       _T_h_e _M_o_d_e_l _S_e_l_e_c_t_i_o_n _D_i_s_p_l_a_y _C_o_n_t_r_o_l_s_.
              The current _O_b_j_e_c_t_, _C_o_n_t_o_u_r and _P_o_i_n_t are displayed and can be
              changed using the arrow buttons or by typing numbers into the
              text boxes.  Models are a collection of objects, and each object
              has its own display color, drawing style and list of contours.
              Each contour in turn contains a list of points.  When drawing
              the current contour the beginning point is green, the end point
              is red and the current point is yellow.  One can also move
              between the current Object, Contour and Point using hot keys.
              pp//oo - Go to the next/previous Object.
              CC//cc - Go to the next/previous Contour.
              ]]//[[ - Go to the next/previous Point.

       _T_h_e _S_h_o_w _C_h_e_c_k_b_o_x
              This checkbox controls whether the new current model point will
              be displayed in image windows when the object, contour, or point
              is changed using the spin boxes just described.  By default,
              image windows will show the current model point, changing sec-
              tion if necessary.  Turn off this checkbox to prevent this
              action.

       _T_h_e _I_m_a_g_e _P_o_s_i_t_i_o_n _D_i_s_p_l_a_y _C_o_n_t_r_o_l_s_.
              The current image size and position is displayed, and the cur-
              rent image point can be changed using the arrow buttons or the
              text boxes.  The arrow keys on the keyboard can also be used to
              move the current image point. The current Z coordinate can be
              moved with the PPaaggee UUpp and PPaaggee DDoowwnn keys.

       _I_m_a_g_e _l_e_v_e_l _S_l_i_d_e_r_s_.
              The Black and White sliders can be used to adjust the contrast
              and brightness of the input image for all the image windows.  A
              linear intensity ramp is made from the black level to the white
              level.  The Function keys also can be used to control the image
              level, with changes having a default step size of 3.
              F1, F2  Controls the Black slider level.
              F3, F4  Controls the White slider level.
              F5, F6  Controls the image contrast by moving the
                        Black and White sliders either apart or closer.
              F7, F8  Controls the image brightness by moving the
                        Black and White sliders in tandem.
              F9      Select Color map ramp # 1.
              F10     Cycle through Color map ramps, 1 - 2 - 3 - 4 - 1.
              F11     Toggle the reversed colormap.
              F12     Toggle False Color.
              A       Autocontrast (see
              _A_u_t_o _B_u_t_t_o_n
              below.)

       _T_h_e _F_l_o_a_t _C_h_e_c_k_b_o_x_.
              When this box is checked, 3dmod will attempt to maintain compa-
              rable image contrast when going from one section to the next.
              It automatically adjusts the sliders when one changes sections,
              based on the mean and standard deviation of image intensity in
              the sections.

       _T_h_e _A_u_t_o _B_u_t_t_o_n
              This button is for setting contrast automatically.  When you
              press it, the program will attempt to adjust the black and white
              sliders so that the displayed image has a defined mean and stan-
              dard deviation.  The settings for the target mean and standard
              deviation can be changed in the 3dmod Preferences dialog box,
              available from the Edit-Options menu entry.  Increase the target
              mean to make images brighter when you press the button, or
              reduce the standard deviation to make images have less contrast.

       _T_h_e _S_u_b_a_r_e_a _C_h_e_c_k_b_o_x
              When this box is checked, both the float operation when going
              between sections and the autocontrast operation will be based
              only on the image area displayed in the most recently active Zap
              window.  If there is a rubberband in the active Zap window, the
              area inside the rubberband is used instead.  When this box is
              not checked, these operations are based on the entire section.


       _T_h_e _M_o_d_e _T_o_g_g_l_e _B_u_t_t_o_n_s_.
              One can toggle between _M_o_v_i_e _m_o_d_e and _M_o_d_e_l _m_o_d_e_.  The model
              can’t be edited with keys and mouse buttons while in movie mode.
              When 3dmod first opens a new model it switches to movie mode.


TThhee MMeennuu bbaarr
       Menu items for 3dmod are selected from the menu at the top of the
       information window, or at the top of the screen on a Macintosh.  Some
       menus have keyboard shortcuts (hot keys, shown in parentheses).  Menu
       entries with ... open a dialog box, control window, or display window.

       _F_i_l_e _M_e_n_u
       New Model         Create a new model.
       Open Model...     Load a model from disk.
       Save Model        Save model.  (s)
       Save Model as...  Save model with new name.
       Write Model as    Write model as Imod, wimp, NFF or Synu files.
       Memory to TIFF... Write the whole section of a raw color image
                           stored inside 3dmod to a TIFF file, in order
                           to turn a montaged image bigger than the
                           screen into a single large image.
       Quit              Quit 3dmod.

       _E_d_i_t _M_e_n_u
       Model
          Header...   Set the model’s Z-Scale for viewing, its pixel
                         size, resolution (spacing between points during
                         contour drawing), and whether the model is drawn
                         or not.
          Offsets...  Offset the model data in X, Y and Z.
          Clean       Delete all objects that contain no points (i.e.,
                         that have no contours, or only contours with no
                         points).

       Object
          New        Create a new object.  Opens Object Type dialog box.
          Delete     Delete current object.
          Type...    Edit Object type.
          Color...   Open requester for changing object color.
          Move...    Move all contours from current object to another
                        object.
          Info       Calculate volume and surface area of current object.
          Clean      Delete empty contours in the current object.
          Break by Z Break every contour in the object at every change in
                        Z, creating as many contours as necessary so that
                        each lies in a single Z plane.  The program will
                        ask you to confirm the operation.

       Surface
          New       Create a new contour with a new surface number.  (N)
          Go To...  Select a different surface in the Surf/Cont/Point
                       window.
          Move...   Move contours in a surface to a different object or
                       a different surface using the Contour Move window.
          Delete    Delete the current surface, i.e. all contours with the
                       same surface number as current contour.

       Contour
          New        Create a new contour.  (n)
          Delete     Deletes the current contour.  (D)
          Move...    Move current contour to a different object or
                       surface.
          Copy...    Copy contours to a different object, Z-level, or
                        time.
          Sort       Sort contours in the object by their Z values and by
                        their time values.
          Break...   Break contour into two contours.  Closed contours
                        can have two break points.
          Join...    Join two contours together.  Closed contours will be
                        joined at the nearest point; open contours will
                        be joined such that the joined contour will have
                        points up to the first selected point from the
                        first contour and from the second selected point
                        to the last point from the second contour.
          Break by Z Break a closed contour at every change in Z,
                        creating as many contours as necessary so that
                        each lies in a single Z plane.
          Fill In Z  For an open contour that traverses through Z, add
                        points by interpolation to fill in any gaps where
                        the contour skips one or more sections.
          Loopback   Add points to the end of a contour so that it loops
                        back from its current end to its start along the
                        same path.  Such a contour can be used to make a
                        complex cap over an elongated, oddly shaped
                        contour.
          Invert     Invert the order of points in the current contour.
          Info       Print area and/or length of contour.
          Auto...    Make new contours using threshold.
          Type...    Edit contour internal data, such as
                        surface #, time index and labels.

       Point
          Delete        Delete Current point.  (Delete)
          Size...       Set size of individual points.
          Distance      Show distance between current and last model
                           points.
          Value         Show current voxel value from image file.
          Sort by Z     Sort points in a contour by Z value.
          Sort by dist  Sort points in a contour by interpoint distance.

       Image
          Flip            Exchange Y and Z dimensions of the image data.
          Process...      Process images by filtering.
          Reload...       Open the image scale reload requester.
          Fill Cache      Fill the cache if there is one.
          Cache Filler... Open a dialog box to control cache filling and
                             select autofilling.

       Movies...    Open window to control movie limits in X, Y, Z and
                        time.

       _I_m_a_g_e _M_e_n_u
          ZaP         Open a ZaP window.  (Z)
          XYZ         Open the XYZ window.
          Slicer      Open an image Slicer window.  (\)
          Model View  Open a 3dmod model view window.  (v)
          Pixel View  Open window displaying pixel values.
          Graph       Open an image Graph window.  (G)
          Tumbler     Open a 3-D Tumbler window.

       _S_p_e_c_i_a_l _m_e_n_u
       This menu provides access to plugins found by 3dmod when it starts, as
       well as internal modules that provide special features.  The latter
       include the Bead Fixer to assist with correcting models of fiducial
       markers for aligning tilt series, and the Line Tracker, which performs
       semi-automated modeling of linear features such as membranes.

       _H_e_l_p _M_e_n_u
       This menu provides help for controls used in 3dmod.  Topics include _M_a_n
       _P_a_g_e_, _M_e_n_u_s_, and _H_o_t _K_e_y_s_.


ZZaaPP WWiinnddooww
       The ZaP window allows one to zoom and pan inside of a model window that
       shows image sections perpendicular to the Z-axis.  Multiple ZaP windows
       can be opened.

       To Zoom press the - and = keys.  To pan, press the first mouse button
       and drag the mouse.  Alternatively, use the keyboard arrow keys: the
       ones on the numeric keypad in movie mode, or the set of 4 arrow keys in
       model mode.

       There is a toolbar at the top of the ZaP window that controls addi-
       tional behavior.  Press the help button on the toolbar for help.  The
       toolbar may be detached from the window to get the maximum vertical
       extent of window area.

       The mouse buttons are assigned different functions in movie and model
       modes.  The keyboard mm key toggles between movie and model modes.
       Other sub modes can further change the mouse controls.

       First mouse button
              One can drag the image in the ZaP Window by moving the mouse
              while holding down the first mouse button.  If the rubber band
              is on and the button is held down while the pointer is near the
              band, one can drag a corner or edge of the band to adjust its
              size.  When the button is clicked in movie mode, the current
              image position is selected.  In model mode, the nearest modeling
              point is selected and highlighted with a yellow circle.  If no
              points are in proximity to the cursor, then no model point is
              selected and just the current image point is set.  If the Ctrl
              key is held down in model mode, this button can be used to
              select multiple contours, which will be highlighted with a dis-
              tinct line thickness.  Clicking again on a selected contour des-
              elects it, and clicking without the Ctrl key cancels the multi-
              ple selection.

       Second mouse button
              In movie mode, this button starts the movie through sections in
              the forward direction.  In model mode, this button creates a
              point after the current model point (or before, if the modeling
              direction is set with ii or the toolbar button.)  Holding down
              the second mouse button will create additional points as the
              mouse moves.  If the rubber band is on and the button is held
              down while the pointer is near the band, one can drag the whole
              band to a new position.

       Third mouse button
              In movie mode, this button starts the movie through sections in
              the reverse direction.  In model mode, the selected point is
              modified to be at the current location.  Holding down the third
              mouse button will cause additional points to be moved, until the
              end of the contour is reached.  If the Ctrl key is held down,
              then this mouse button can be used to delete points under the
              cursor.  Clicking the button will delete the point(s) at the
              current mouse position; holding the button down and moving the
              mouse will delete all of the points that the cursor sweeps over
              inthe current contour.


       Keyboard Controls
              Most controls that edit models are disabled in movie mode.  Key-
              pad keys work regardless of whether NumLock is on.

                      Modeling and display control keys
                      ---------------------------------
              o  -  Go to previous object
              p  -  Go to next object
              ]  -  Go to previous point
              [  -  Go to next point
              C  -  Go to next contour
              c  -  Go to previous contour
              5  -  Go to previous contour in current surface
              6  -  Go to next contour in current surface
              7  -  Go to previous surface in current object
              8  -  Go to next surface in current object
              e  -  Unselect current point
              E  -  Unselect current contour
              {  -  Go to first point in contour
              }  -  Go to last point in contour
              n  -  Create a new contour
              N  -  Create a new contour with a new surface number
              0  -  Create a new object
              Delete - Delete current model point
              D  -  Delete current contour
              M  -  Move contour to selected object
              J  -  Join two selected contours
              Ctrl-Z - Undo a change in the model
              Ctrl-Y - Redo a change that was undone
              m  -  Toggle model edit mode and movie mode
              t  -  Toggle model drawing on/off
              T  -  Toggle current point marker on/off
              g  -  Toggle previous contour ghost draw mode
              s  -  Save Model File
              f  -  Print current pixel value in information window
              F  -  Find the maximum pixel within 10 pixels and report its value
              ,  -  Decrease movie speed
              -  -  Decrease Zoom
              =  -  Increase Zoom
              3  -  Start or stop a movie through time in the forward direction
              4  -  Start or stop a movie through time in the backward direction

                      Other keys active in the ZaP window only
                      ----------------------------------------
              S  -  Snapshot image in window to file with current non-TIFF format
              Ctrl-S - Snapshot image in window to TIFF file
              Ctrl-A - Select all contours in current object on section or
                         within the rubberband
              b  -  Build a contour while in auto contour mode
              a  -  Advance to and fill next section when auto contouring
              u  -  Smooth a filled area when auto contouring
              i  -  Toggle the modeling direction
              Z  -  Toggle auto section advance on and off
              B  -  Toggle rubber band on and off
              I  -  Print information about window, image size, and offsets,
                       also bring the Information Window to the front
              R  -  Resize window to size of image or rubber band
              P  -  Activate moving current contour with first mouse button
              Keypad Ins - Add point(s) in model mode, like second mouse button
              Esc - Close ZaP window

                      Keys to control position or move current viewing point
                      ------------------------------------------------------
              Page Up       -  Increase Z
              Page Down     -  Decrease Z
              Up Arrow      -  Increase Y
              Down Arrow    -  Decrease Y
              Right Arrow   -  Increase X
              Left Arrow    -  Decrease X
              End           -  Go to Z = 1
              Home          -  Go to Z = max
              Insert        -  Go to middle Z of stack
              1,2           -  Previous,Next Time Index

              Keypad Arrows -  Move current model point in model mode,
                            -  Pan in ZaP window in movie mode.
              Arrows        -  Pan in ZaP window in model mode

                      Window control keys
                      -----------------------------------------
              \  -  Open Slicer Window
              v  -  Open Model View Window
              G  -  Open Graph window
              z  -  Open ZaP window


SSlliicceerr WWiinnddooww
       Multiple Slicer Windows can be opened.  Each Slicer Window shows a dif-
       ferent slice through a 3-D volume.  The Slicer window has two movable
       toolbars.  The large toolbar contains three sliders that are used to
       select the orientation of the slice by setting the angles of rotation
       of the data volume around the X, Y and Z axes.  A small display next to
       the sliders gives a visual cue to the slice location.  This toolbar
       also has two spin boxes, one to select the thickness of the slice being
       displayed, the other to select the thickness of model that will be pro-
       jected onto the slice.

       The narrow toolbar at the top of the Slicer has the following buttons,
       from left to right.
          The Up and Down arrows adjust the magnification in the slicer dis-
       play window.
          The text box shows the zoom and allows one to type in an arbitrary
       zoom factor.
          The checkerboard button toggles between nearest neighbor and slower,
       cubic interpolation.
          The Lock button will keep the Slicer from changing its current posi-
       tion when locked.
          The Show Slice button will draw where the slice intersects the X- Y-
       and Z-planes in the XYZ window, and the Z-plane in the ZaP window.
          The Z-Scale control determines whether the model’s Z-scale will be
       applied to stretch the volume in the Z dimension and compensate for
       thinning.
          The Help button opens up on-line help.

       One can model in the Slicer Window, using the first mouse button to
       select the current point, the second mouse button to insert a point
       after the current point, or the third button to modify the current
       point.  In movie mode, the first button selects the current point, and
       the second or third buttons start movies forward or backward through
       the data, in a direction perpendicular to the slice.


       _H_o_t _K_e_y_s _i_n _t_h_e _S_l_i_c_e_r
              -/=  -  Decrease/Increase zoom
              _/+  -  Decrease/Increase displayed image thickness
              9/0  -  Decrease/Increase displayed model thickness
              s    -  Show slice in ZaP and XYZ windows
              S    -  Snapshot to file with current non-TIFF format
              Ctrl-S - Snapshot to TIFF file
              x/y/z  - Align current and last model points along X, Y or Z axis
              X/Y/Z  - Align first and last points of current contour along
                          X, Y or Z axis

              Numeric Keypad:
              4/6  -  (Left/Right) Decrease/Increase last adjusted angle by 0.1
              2/8  -  (Down/Up) Decrease/Increase last adjusted angle by 0.5
              1/3  -  (End/PgDn) Decrease/Increase last adjusted angle by 15.0
              0    -  (Insert) Set last adjusted angle to 0


XXYYZZ WWiinnddooww
       The XYZ window displays three slices: through an XY plane in the lower
       left, through a YZ plane in the lower right, and through an XZ plane in
       the upper left.  The intersection of the model with these planes will
       be drawn.  Marker lines and crosses indicate the position of the cur-
       rent point and of the slices within the volume.  Like the ZaP window,
       the XYZ window can be resized, and the image can be zoomed with hot
       keys and panned with the left mouse button.  Basic modeling capability
       is available in the XY plane.  One can movie through one or more of the
       planes simultaneously.  In addition, the marker lines have handles that
       can be dragged with the mouse to riffle through images in a plane.
       Each marker line’s color matches the color of the border around the
       plane that is controlled by its handle.


       _H_o_t _K_e_y_s _i_n _t_h_e _X_Y_Z _W_i_n_d_o_w
              -/=  -  Decrease/Increase zoom
              r    -  Toggle between low and high resolution display modes
              P    -  Toggle on or off showing a projection of the current
                        contour in the XZ and YZ planes, and of a current
                        contour that is open in the XY plane
              S    -  Snapshot to file with current non-TIFF format
              Ctrl-S - Snapshot to TIFF file

       _M_o_u_s_e _B_u_t_t_o_n_s _i_n _t_h_e _X_Y_Z _W_i_n_d_o_w
               Actions in Movie Mode:
                  Clicking the first mouse button will select the current
              point.  In one of the three image planes, this will generally
              change the coordinates displayed in the other two planes.
              Clicking in the horizontal gutter region occupied by the X
              marker line will change the current X coordinate and the plane
              displayed in the YZ panel.  Clicking in the vertical gutter
              region will select a new Y coordinate and XZ plane.  Clicking in
              the upper right region will select a new Z coordinate and XY
              plane, as indicated by the crossed marker lines.
                  Dragging with the first mouse button depressed will either
              pan the image within the window or riffle through one of the
              planes, depending on where the mouse is when the button is first
              pressed.  If it is in one of the image panels, dragging will pan
              the image (provided it is larger than the window.)  In the hori-
              zontal or vertical gutter regions, dragging will riffle through
              YZ or XZ planes, respectively.  In the upper right region, drag-
              ging will change the XY plane; this is most effective if one
              grabs the handle there and moves diagonally.
                  Clicking the second mouse button in one of the image panels
              will start or stop a movie in the forward direction in that
              panel.
                  Clicking the third mouse button in one of the image panels
              will start or stop a movie in the backward direction in that
              panel.

               Actions in Model Mode:
                  Clicking the first mouse button near a model point in the XY
              plane will select that point as the current model point.  Click-
              ing anywhere else will cause the same result as in movie mode.
                  Dragging with the first mouse button is the same as in movie
              mode.
                  Clicking with the second mouse button in the XY plane will
              add a point to the current contour and has no effect elsewhere.
                  Dragging with the second mouse button depressed will add a
              series of points to the current contour.
                  Clicking with the right mouse button in the XY plane will
              move the current model point to that location.


TTuummbblleerr WWiinnddooww
       The Tumbler Window is opened by selecting the Tumbler item from the
       Image menu.  A projection of a volume around the current point will be
       shown in the Tumbler Window.  Various toolbar controls allow you to
       change the size of the volume and the zoom, lock the position, select a
       high-resolution display, or set thresholds for truncating pixels as
       black or white.  The image display in the model view window, accessed
       from the Edit-Image menu entry of that window, will give a faster and
       better display for most pruposes, but the tumbler display will be a
       more accurate projection, especially in high-resolution mode.  The hot
       keys in the tumbler window are:
       Keypad up and down arrow keys tumble the volume around the X axis.
       Keypad left and right arrow keys tumble the volume around the Y axis.
       Keypad PgUp and PgDn keys tumble the volume around the Z axis.
       -/=     Decrease/Increase the zoom
       F5/F6   Decrease/Increase black threshold level
       F7/F8   Decrease/Increase white threshold level
       b       Toggle the bounding box on or off
       ,/.     Decrease/Increase angular increment when rotating
       S    -  Snapshot to file with current non-TIFF format
       Ctrl-S - Snapshot to TIFF file

GGrraapphh WWiinnddooww
       This window graphs image intensity along the image X-axis, Y-axis, Z-
       axis or along the current contour.  A histogram of image intensities
       can also be graphed.  The type of graph can be chosen by using the
       option menu located in the toolbar.  The [+] and [-] buttons in the
       toolbar adjust the zoom in the drawing area.  The [LOCK] button stops
       the window from tracking the current point.  The [RESOLUTION] button
       toggles between taking data from the image buffer and taking data from
       the file.


MMooddeell VViieeww WWiinnddooww
       This window shows the model in 3D, continually updated as the model is
       edited.  The window behaves the same as when it is started with the
       3dmodv command, except that some menu items are unavailable.  See the
       manual page for 3dmodv(1).


SSUURRFFAACCEESS,, OOPPEENN CCOONNTTOOUURRSS,, LLAABBEELLSS,, AANNDD PPOOIINNTT SSIIZZEESS
       Several features can be controlled from the Surf/Cont/Point window.
       One is the surface, which is an optional level of organization between
       contours and objects.  With surfaces, one can keep track of, navigate
       between, and manipulate groups of contours without having to use a sep-
       arate object for each group.  Each contour in an object has a surface
       number, which is 0 if surfaces are never employed.  To start a new sur-
       face, use NN or the New Surf button in the Surface section of the window
       to obtain a new, empty contour with the new surface number.  There-
       after, each new contour will have the same surface number as the previ-
       ous contour being modeled, until a new surface is started again.  The
       Surface section of this window has controls for moving within and
       between surfaces and for visualizing contours of the current surface,
       using the Ghost button.  The Contour Move window has options for moving
       contours from one surface to another or for moving an entire surface to
       a new object.

       The Contour section of the Surf/Cont/Point window has radio buttons for
       defining individual contours as open in an object defined as having
       closed contours.  This is useful for displaying a partially cut edge of
       an object.  See imodmesh(1) for more details.

       This part of the window also has a text box for displaying and editing
       the time index of the current contour.  If you have loaded multiple
       image files and want to model contours at specific times (i.e., dis-
       played only on images from a specific file), you must first activate
       time editing with a button in the Edit-Object-Type window.  Once this
       feature is selected, newly created contours will be assigned to the
       currently displayed time.

       The Point section of the Surf/Cont/Point window has a text box and
       slider for assigning a size value to an individual point.  Any point
       with an individual size will be displayed as a sphere, just like points
       in scattered point contours.

       The  window also has text boxes in which one can enter labels for indi-
       vidual contours and points.

       The Section Ghost section of the Surf/Cont/Point window has controls to
       enable the display of ghost contours from adjacent sections, which is
       also toggled by the g hot key.  Ghosts can be displayed from above or
       below the current section, and from variable numbers of sections away.
       There are also options to control whether the ghost contours are
       lighter or darker in color, and to show ghosts from all objects rather
       than just from the current object.


AAUUTTOOSSAAVVEE AANNDD BBAACCKKUUPP FFIILLEESS
       The program will back up the current model to the file
       model_file_name#autosave# every few minutes.  If no model file has been
       saved yet, the name of the autosave file is just #autosave#.  The
       autosave file is eliminated whenever the model is saved, and when the
       program exits normally.  The first time that you save a model file, the
       existing model file will be renamed to model_file_name~, and any exist-
       ing file by that name will be deleted.  This backup file will not be
       overwritten each time that you save thereafter, so that it will pre-
       serve the state of the model when 3dmod was started.

       Automatic saves can be controlled or disabled by using the 3dmod Pref-
       erences dialog or by setting environment variables (obsolete).  The
       Preferences dialog has a checkbox to enable autosaving, a spin box to
       set the number of minutes between automatic saves, and a text box to
       specify a directory in which the autosave file will be written.  Thus,
       one can specify a directory on a local disk (e.g., /usr/tmp) and avoid
       the long delays required to write a large model to a disk over the net-
       work.  Formerly, these features were controlled by the IMOD_AUTOSAVE
       environment variable, which specified the minutes between autosaves or
       0 to disable autosaving, and by the IMOD_AUTOSAVE_DIR variable.  If
       these variables are defined, the Preferences dialog will initially show
       their values; but once the user has changed these settings through the
       Preferences dialog, the environment variables will be ignored.


IIMMAAGGEE LLIISSTT FFIILLEESS
       An image list file can be entered instead of an image file on the 3dmod
       command line.  This ASCII file can specify a series of image files that
       represent different times, so that one can step through time as well as
       X, Y, and Z.  An image list file can also be used to specify both an
       image file and a piece list with a single file.  In either case, the
       cache is turned on.  Lines beginning with # are treated as comments and
       ignored.

       The format of the file is:

       IMOD image list               [must be the first line of the file]
       VERSION 0   or   VERSION 1    [must appear somewhere in file]

       To specify a series of files at different times, include a series of
       entries of the form (the second entries for time labels are optional,
       and default label if it is omitted is the image filename):

       IMAGE image_filename
       TIME time_label               [The label can be any desired text]

       If the first file might not exist, precede the list of images with a
       line:
       SIZE nx,ny,nz                 [nx,ny,nz are the image dimensions
                                      to be assumed for the first file]

       To specify an image file and piece coordinates, include the following:

       IMAGE image_filename
       XYZ                           [on a line by itself]
       x  y  z                       [piece coordinates, one line per section]
        . . .

       To load files that are located in another directory, include the fol-
       lowing before the IMAGE lines for the respective files.  This entry can
       occur more than once.
       IMGDIR path_to_image_directory


PPLLUUGGIINN EENNVVIIRROONNMMEENNTT
       3dmod will load special plugin libraries that are in the directory
       pointed to by the IMOD_PLUGIN_DIR environment variable.  The directo-
       ries /usr/IMOD/plugins, /usr/local/IMOD/plugins, and /usr/free-
       ware/lib/imodplugs/ are loaded by default if they exist.  To write your
       own plugins, look for the IMOD software development kit on the IMOD
       home page at http://bio3d.colorado.edu/imod.  (Not yet available for
       the Qt version.)


AAUUTTHHOORRSS
       Jim Kremer
       David Mastronarde

SSEEEE AALLSSOO
       Viewing programs  3dmodv, midas
       Model conversion  imod2nff, imod2synu
       Image conversion  tomrc, frommrc (convert to/from sgi images)
                         tif2mrc, raw2mrc, dm2mrc.
       Please email all bug reports to mast@colorado.edu.



BL3DEMC                             3.4.16                            3dmod(1)
