     BBoouullddeerr LLaabboorraattoorryy ffoorr 33--DDiimmeennsssiioonnaall EElleeccttrroonn MMiiccrroossccooppyy ooff CCeellllss

TILTXCORR(1)							   TILTXCORR(1)

NNAAMMEE
	tiltxcorr - to align a tilt series by cross-correlation

SSYYNNOOPPSSIISS
	tiltxcorr

DDEESSCCRRIIPPTTIIOONN

  TILTXCORR uses cross-correlation to find an initial translational
  alignment between successive images of a tilt series.  For a given
  pair of images, it stretches the image with the larger tilt angle
  perpendicular to the tilt axis, by an amount equal to the ratio of
  the cosines of the two tilt angles (cosine stretch).  The stretched
  image is correlated with the other image, and the position of the
  peak of the correlation indicates the relative shift between the
  images.  There are options to use only a subset of the image, to
  pad the image with a border before correlating, and to taper the
  image intensities down to the average level over some boundary
  region.  The latter feature is particularly important for getting
  reliable correlation peaks.  The program also has an option to
  correlate each image with the sum of already-aligned images at lower
  tilts, a method developed by Christian Renken. The program will reduce
  the size of images larger than 1024 pixels in one dimension by binning
  them down, i.e. by averaging the values in square sets of adjacent
  pixels (2x3, or 3x3, etc).  Images are binned by the smallest factor
  needed to make them 1024 or smaller.

  Some notes about some of the options:
  
  Filtering: Some high pass filtering, using a small value of Sigma1
  such as 0.03, may be needed to keep the program from being misled
  by very large scale features in the images.  If the images are
  noisy, some low pass filtering with Sigma2 and Radius2 is
  appropriate (e.g. 0.05 for Sigma2, 0.25 for Radius2).  If the images
  are binned, these values specify frequencies in the binned image, so
  a higher cutoff (less filtering) might be appropriate.
  
  The exclusion of a central peak can be essential when there is
  fixed noise in the images due to inadequate gain normalization of CCD
  camera images.  Because one image is stretched, this
  spurious peak can actually occur anywhere in an elongated region
  perpendicular to the tilt axis.  If the real alignment happens to
  fall in that streak, then it will be ignored as well, and an
  incorrect alignment will be found.  For this reason, this option 
  should be used only when necessary.
  
  Trimming some area off the edges of the images may be helpful if
  those areas are particularly out of focus or contain material with
  no useful features in it.  The area to be used for correlation can be
  offset from the center of the image by specifying starting and ending
  coordinates of the region to correlate instead of the amount to trim
  off.  The coordinates should be chosen from the zero-tilt image; the
  program will shift the specified box closer to the center of the image
  at higher tilts so that it will contain approximately the same
  features.  By default, the transformations will be adjusted to move the
  tilt axis back to the center of the whole image, but there is an option
  to leave the axis at the center of correlated area instead.
  
  Padding is customarily done to reduce the contribution to the
  correlation from wrapped around features, which occurs when
  correlation is done with Fourier transforms.  Extensive padding does
  not help with typical biological specimens but may be needed for
  specimens with periodic structures, in which case one should pad each
  edge by half the image size.
  
  In contrast, tapering the images down to a mean intensity at their
  edges is very important.  Tapering over as few as 20 pixels may be
  adequate, but fewer artifacts will appear in the correlation with
  longer tapers (say, 50 to 100 pixels).
  
  Tiltxcorr has an option to use a cumulative correlation method developed
  by Christian Renken at the National Center for the Visualization of
  Biological Complexity in Albany, N.Y.  With this option, the program
  will take the image at zero tilt as the first reference, and correlate
  it with the image at the next most negative tilt.  It will then add the
  aligned image to the first reference to make the reference for the next
  tilt.  At each tilt, the reference will be the sum of images that
  have already been aligned.  When the most negative tilt angle is
  reached, the procedure is repeated from the zero-tilt view to more
  positove tilt angles.  (If you specify a range of views to correlate
  that does not pass through zero tilt, then this procedure will start at
  the lowest tilt in the specified range.)  There are two options that
  can be used with this procedure.  By default, aligned images are not
  cosine-stretched before being added into the cumulative reference; but
  the "absstretch" option will add images that have been stretched by the
  inverse of the cosine of the tilt angle into the reference.  The
  "nostretch" option will disable the cosine stretching that is
  used before correlating an image with the reference.

  Tiltxcorr uses the PIP package for input (see the manual page for pip(1))
  and can still take sequential input interactively, to maintain compatibility
  with old command files.  The following options can be specified either as
  command line arguments (with the -) or one per line in a command file or
  parameter file (without the -):

INSERT OPTION TEXT HERE

  -StandardInput
     Read parameter entries from standard input.


  If there are no command-line arguments, Tiltxcorr takes sequential input
  the old way, with the following entries:
  
  Image input file

  Piece list file for reordering the Z values in the stack, or Return
  if none

  Output file for F transforms
  
  -1 to enter individual tilt angle for each view, 1 to specify a
  starting and increment tilt, or 0 to read tilt angles from a file
  
  IF you entered 1, next enter the starting and incremental tilt angles
  IF you entered -1, enter the tilt angle of each view.
  IF you entered 0, enter name of file with tilt angles
  
  Angle of rotation of the tilt axis in the images; specifically, the
  angle from the vertical to the tilt axis (counterclockwise
  positive).

  Filter parameters to filter the correlation, or / for no filter
  (Enter values of Sigma1, Sigma2, Radius1, Radius2 just as for
  ENHANCE.)

  1 to exclude a central correlation peak due to fixed pattern noise
  in the images, or 0 not to
  
  Nymber of pixels to trim off each side in the X and Y dimensions, or /
  to use the whole image area
  
  Borders (in pixels) with which to pad images in the X and Y dimensions,
  or / for the default, which is 5% of the image dimensions up to 20
  pixels
  
  Distances in pixels over which to taper image intensities down to the
  mean at the edges, in the X and Y dimensions.  Enter / for the default,
  which is 10% of the image dimensions up to 100 pixels

  Starting and ending view #'s (first is 1), or / for all views
  
  
HHIISSTTOORRYY
  Written by David Mastronarde 10/6/98
