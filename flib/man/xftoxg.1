     BBoouullddeerr LLaabboorraattoorryy ffoorr 33--DDiimmeennsssiioonnaall EElleeccttrroonn MMiiccrroossccooppyy ooff CCeellllss

XFTOXG(1)							 XFTOXG(1)

NNAAMMEE
	xftoxg - Converts transforms between sections into alignment transforms

SSYYNNOOPPSSIISS
	xftoxg

DDEESSCCRRIIPPTTIIOONN

   XFTOXG takes a list of transformations (f) from each section to
   the previous one, and computes a list of xforms (g) to apply to each
   section to obtain a single consistent set of alignments.

   Three different modes of operation can be selected.	 In the first, all
   sections will be transformed to a single position in the "center" of
   the series.	 Here "position" refers to the entire set of parameters
   describing the transformation, i.e. not just the x,y coordinates but
   the rotation and stretch as well.  This mode will remove any consistent
   trends in the data stack, such a progressive rotation, compression or
   shift.

   In the second mode, the "center" position is assumed to change
   progressively over the whole series, based on a polynomial fit to the
   series, and a transformation will be computed for each section that will
   align it to a fitted shifting center position.  If a polynomial order of 1
   is selected, the center position will shift linearly from one end to the
   other of the data stack.  This mode will retain trends in the data stack
   to the extent that they can be fit by the order of polynomial chosen.  For
   example, if order 1 is chosen, the fit is a linear one, and the resulting
   transforms will retain trends that occur at a constant rate from one end
   to the other.

   In the third mode, one defines a distance (number of sections) over which
   to fit a polynomial to a shifting center position.  For each section, the
   program fits polynomials to the transformation parameters over the
   selected distance (centered on the given section, if possible), and uses
   these polynomial fits to define the position to which that section should
   be transformed.  This mode will retain trends in the data stack that occur
   over the range of the specified distance.
	  
   It is also possible to do a hybrid alignment in which trends are retained
   for some parameters while they are eliminated for others.  Trends will
   be eliminated for X and Y translations, and can optionally be eliminated
   for rotations and overall size changes.  The most appropriate choice would
   be to eliminate trends for translations and rotations, unless the rotation
   trends in the data are meaningful and should be preserved.  This hybrid
   method can be used with either local or global polynomial fits (the second
   or third mode of operation).

   To do the averaging and fitting, the program converts the A matrix of the
   g transforms to the "semi-natural" parameters: global rotation and
   magnification, and differences between Y and X axis rotation and stretch.
   This conversion allows the hybrid alignments to be done.  It also means
   that if input transformations involve only a restricted set of these 
   parameters (e.g., rotation only), this restriction will be retained in the
   final g transforms.

   The ability to use both the local fits and fits of order higher than 1 is
   somewhat redundant.  If local fitting is used, start with order 1 and go
   to higher orders only if necessary.
	  
   Inputs to the program:
   
   0 to align all sections to a single average central alignment, 1 to align
   to an average alignment fit to a single polynomial, N > 1 to align each
   section to an average alignment fit to the nearest N sections, or -1 or
   -N to do a hybrid of central and shifting alignments with fits to a single
   polynomial or to locally fitted polynomials
	  
   IF you entered a negative number, next enter 2 for central alignment of
   translations only, 3 for central alignment of translations and rotations,
   or 4 for central alignment of translations, rotations and size changes
	  
   IF you entered a nonzero number to the first query, next enter the order
   of the polynomials to fit (1 for linear fits)
	  
   Name of input file of F transforms
	  
   Name of output file of G transforms

HHIISSTTOORRYY
  Written by David Mastronarde, 1988

