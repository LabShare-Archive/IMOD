<head>
<title>Bead Helper Plugin Help</title>
</head>
<body>
<h3>Bead Helper Plugin Help</h3><br>
--------------------------<br><br>
This plugin is designed to assist in the <i>speedy refinement of
fiducial models</i> - allowing you to quickly identify and correct
bad points. "<b>Bead Helper</b>" is designed to compliment the
functionality of <b>"Bead Fixer"</b> by providing useful visual
aids and tools which can be used to rapidly rectify or delete 
<b>bad contours</b> - i.e. contours where the fiducial marker has
tracked poorly. If tracking goes well you probably won't need
Bead Helper, but in situations where tracking proves problematic
Bead Helper has many tools which may be able to help.
<br>
<br><br>
<b>Hot Key Summary</b><br>
---------------------<br>
<b>[e]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Moves (or adds) point in the current view to its <u>e</u>xpected position<br>
<br>
<b>[E]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Smooth current contour using the current settings under
"Move points to <u>e</u>xpected position"<br>
<b>[f]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u>F</u>ill all missing points (gaps) in the current contour using estimated
positions, but not past the end pints<br>
<b>[F]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u>F</u>ill all gaps in the current contour past the end points<br>
<b>[d]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u>D</u>elete all points above or below the current point - whichever end
is closer<br><br>
<b>[r]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u>R</u>educe the current contour to its original seed point<br>
<br>
<b>[h]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Go to the next biggest "<u>h</u>ole" between seed points<br>
<b>[y]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select point with the next biggest "<u>y</u> jump"<br>
<b>[b]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select point with the next <u>b</u>iggest distance from it's
estimated position<br>
<b>[w]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select point with the next biggest <u>w</u>eighted distance from it's
estimated position<br>
<b>[o]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select next biggest contour using "Re-<u>o</u>rder Contour" criteria<br>
<br>
<b>[u]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Toggle current contour between checked/<u>u</u>nchecked (checked contours
are shown as stippled)<br>
<b>[Enter]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Go to next unchecked (unstippled) contour.<br>
<br>
<b>[M]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u>M</u>ove current contour to elsewhere.<br>
<br>
<b>[mouse wheel]</b>&nbsp;&nbsp;&nbsp;&nbsp;
Scroll through points and/or views<br>
<br>
<br>
<br>
<b>Visual Aids</b><br>
---------------------<br>
<ul>
<li><b>show estimated position</b> - Shows the estimated position
of the fiducial on the current slice based on
the position of nearby points in the current contour. Be warned:
this uses a very basic calculation which don't account for
complex image shifts. <i>Press [e] to move a point to
this position.</i> </li>
<li><b>sphere size</b> - Changes the sphere size for the object,
allowing you to see the position of points on adjacent views.</li>
<li><b>line display</b> - Used to show the trajectory of contours.
Use this to help identify which points to fix.</li>
<li><b>tilt display</b> - Show the tilt axis as a reference for
contour rotation. You can change the tilt angle in "More Settings"
or "More Actions".</li>
</ul>
<br>
<br>
<b>Range</b><br>
---------------------<br>
Before performing any action you should select the range of views
and range of contours you wish to apply actions to.... almost
all of the action buttons will apply to the chosen range of
contours and/or views.. notice however that the listed 
shortcut keys apply the action to the current contour only.
<br>
<br>
<br>
<b>Actions</b><br>
---------------------<br>
<ul>
<li><b>Delete Points in Range</b> - Deletes all points from the
selected range of contour range which lie within the range of views. If
certain views have tracked poorly (especially at high tilt) use this to
quickly delete points from these views. After doing this it is a good idea
to manually fix the first few contours then try tracking again.
<i>Press [d] to delete points from current contour only.</i></li>
<li><b>Reduce Contours to Seed</b> - Deletes all but the middle most
point of all contours in range. If "track seed model" goes poorly
use this to revert back to the seed points. After this it is a good idea
to reorder them or chose different fiducials.
<i>Press [r] to apply for current contour only.</i></li>
<li><b>Move Points to Estimated Pos</b> - Moves all points within the
range of views towards their estimated position for all specified contours.
This feature can be used to smooth bad contours and several smoothing
options are presented. Use this option carefully, because it may often
move correct points AWAY from the fiducial. After doing this
you should check over the moved points, and if it has done a
poor job you might want to undo it!
<i>Press [E] to apply to these settings to the current contour only.</i></li>
<li><b>Fill Missing Points</b> - Similar to above, except that it only adds
points within the range, it does not move any existing points. After doing
this you should ALWAYS manually correct the added points.
<i>Press [f] to fill current contour only.</i></li>
<li><b>Smooth Points</b> - Presents several options for smoothing
the selected range of points.</li>
<li><b>Reorder Contours</b> - Allows you to sort the fiducials in several
different ways. When clicked you can chose to reorder a range of contours
by residual, average grey scale or several other options - typically
placing the worst fiducials at the end. After doing this it is a good idea to
iterate backwards from the last contour and delete any which look bad.</li>
</ul>
<br>
<br>
<b>Options</b><br>
---------------------<br>
<ul>
<li><b>wheel behavior</b> - Allows you to use the mouse wheel to scroll
through <i>points</i>, <i>slices</i> or both (if <i>smart scroll</i> is
selected).</li>
<li><b>estimation method</b> - Allows you to change the method used to
calculate the "estimated position" of points on given views.
The <i>nearest 2 points</i> option calculates a simple linear trajectory
between the two closest points on the contour to the chosen view (but
not including that view). This is the most simple option, but
quite effective for filling small gaps.
The <i>curve</i> option calculates a quadratic curve using the first,
last and middle-most point (in most cases the seed point) in the contour.
This provides a "quadric of best fit" and therefore is useful for filling
missing points at high-tilt, but less useful at filling small small gaps.
The <i>local curve</i> option also uses a quadratic, but choses the closest
set of 3 points spaced at least 10 view apart such that the curve adapts well
to local shifts and rotation.</li>
The <i>prev 6 points</i> option uses the line of best fit, plus increasing
distance in x over the last 6 points, and is useful for filling ends, but
terrible at filling small gaps.</li>
</ul>
<br>
<br>
<b>Tips</b><br>
---------------------<br>
<br>
I've found tracking >120 seeds is very slow (processing time
increases exponentially), hence it's a good idea to start with 100, and
if those track well you can add another 100.<br>
<br>
It's best to have an even distribution of points, starting at the middle.
To help achieve this use [h] and add the nearest isolated fiducial 
to the crosshair.<br>
<br>
If particles are on both sides it's best to have a roughly even
distribution, but if I'm adding >100 fiducials I find I usually get
a pretty good spread by choosing randomly. The more careful approach
is to use [pagedown] and [insert] to see if a fiducial is on the
top/bottom and if looks easy to track. You can also click "More Actions"
then <b>"show fiducials on bottom as purple"</b> to help see which 
contour are on which side.<br>
<br>
For many tilt series beadtracker does an excellent job the first time,
however tracking often go off course:
<ol>
<li>when one fiducial passes close by another
<li>when consecutive views are poorly aligned
<li>when fiducials are obscured
</ol>
Tracking is most likely to fail at high tilt where fiducials
are often hard to see. When this happens the best course of action is
to delete all points from these <b>bad views</b> then manually seed the
first 5 or 10 contours and try "track fiducial model as seed" again.<br>
<br>
If the first few fiducials track poorly, then chances are ALL
the fiducials will track badly - so make sure the first few are correct
before proceeding.<br>
<br>
Fixing bad fiducials is slow - so don't hesitate to delete
any contour which looks bad. For this reason it's a good idea to
seed more fiducials than you need.<br>
<br>
To check the tracking of each contour I highly recommend turning on
<i>"keep point centered"</i> (the square button on the ZAP window)
and toggle [t] to see the point more clearly. Use the [{] and [}]
(or better yet the mousewheel) to iterate through point, [c] and [C]
to iterate contours and the numpad keys to shift points.<br>
<br>
For the best reconstruction it's a good idea to manually check all
contours using this method, unfortunately that can be very slow, and so
it's useful to instead use the visual aids to identify bad points/contours
before moving to the "Fine alignment" step.<br>
<br>
A fast way to correct bad points before fine alignment is to use
[y], [b] or [w] to jump the the "next worst point" and use [e] to
move it to it's expected point. To identify bad contours you can
chose a sort criteria under "Reorder contours" and use [o] to
move through the values in descending order.<br>
<br>
Be very careful using the provided methods to fill in gaps and/or
smooth contours by moving points. Cross-correlation never does a perfect
job, and so often shifts between images are correct, and it's important
you don't lose these. When first inspecting the fiducial model you should
make a note of which views appear out of alignment.<br>
<br>
---------------------<br>
<br>
This plugin was created by <b>Andrew Noske</b>
(<u>a.noske@imb.uq.edu.au</u>).<br>
<i>If you encounter bugs please e-mail me before e-mailing the
IMOD group (to reduce traffic). <br>
In your e-mail please tell me exactly how and when the error/crash
occurred and attach the model file you were using... 
enough information that I can replicate the error/crash.
</body>
