Version = 1.2

[Field = fnVolume]
comment = The file names of tomograms

[Field = fnModParticle]
comment = The file names of IMOD models corresponding to each tomogram.

[Field = initMOTL]
comment = A code specifying how to construct the initial motive list:
^0: Set all rotational values to zero
^
^1: Use the particle model and reference index to
^   initialize theta (rotation around the z axis), be sure
^   the points are sorted along a direction of interest
^
^2: Use the particle model and reference index to initialize
^   theta and psi (rotation around the z axis and x axis)
^
^or a string array to specify the filenames to load, must end in 1.em
tooltip = A code specifying how to construct the initial motive list
or a string array to specify the filenames to load, must end in 1.em
enum.0.tooltip = Set all rotational values to zero
enum.1.tooltip = Use the particle model and reference index to initialize theta
(rotation around the z axis), be sure the points are sorted along a direction of
interest
enum.2.tooltip = Use the particle model and reference index to initialize theta
and psi (rotation around the z axis and x axis)

[Field = reference]
comment = * If it is a string it should specify the name of an MRC file containing the reference
^  volume.
^* If it is [i  j]. It specifies the reference to be the jth particle of the ith tomogram.

comment = If it is a string it should specify the name of an MRC file containing
^the reference volume.  If it is [i  j]. It specifies the reference to be the
^jth particle of the ith tomogram.

[Field = maskType]
comment = If it is set to 'sphere' or 'cylinder', it will use 'insideMaskRadius' and
^'outsideMaskRadius' to create a mask.
^If it is set to a string other than 'sphere', 'cylinder', or 'none', the
^string is assumed to be a filename of a stack whose voxels of zero value
^specify voxels that will be masked out, whose voxels of nonzero value
^specify voxels that will be included.
^If it does not exist or is set to 'none', there will be no masking.

[Field = maskModelPts]
KeyValueDelimiter = ==
comment == It specifies which model and which point of that model will be used to create a
^'cylinder' mask. The format is [i j].
^It specifies the jth point of the ith model will be used.
^It is used only when reference is specified as a filename and
^maskType='cylinder'.
^When reference is specified as [ii jj], the [ii jj] will be used.
KeyValueDelimiter == =

[Field = insideMaskRadius]
KeyValueDelimiter = ==
comment == radius in pixels. Voxels residing inside this radius is masked out;
^for .77 virus tomo;
^insideMaskRadius=28
KeyValueDelimiter == =

[Field = outsideMaskRadius]
KeyValueDelimiter = ==
comment == radius in pixels. Voxels residing outside this radius is masked out;
^for .77 virus tomo;
^outsideMaskRadius=36
KeyValueDelimiter == =

[Field = yaxisType]
comment = 0: use the volume's Y axis as the particle's Y axis.
^1: use the vector between neighboring model points as the Y axis.
^2: use end points of the contour specified by the "yaxisContour" parameter
^   as the Y axis.
enum.0.tooltip = use volume's Y axis as the particle's Y axis;
enum.1.tooltip = use vector between neighboring model points as the Y axis.
enum.2.tooltip = use end points of the contour specified by the "yaxisObjectNum" and "yaxisContourNum" parameters.

[Field = yaxisObjectNum]
comment =  An integer specifying the index of the model object used for Y axis determination when yaxisType is 2. 

[Field = yaxisContourNum]
comment =  An integer specifying the index of the contour in object
"yaxisObjecNum" whose endpoints will determine the Y axis for the associated volume when when yaxisType is 2.
 
[Field = relativeOrient]
comment = Specify the slicer angles in degrees needed to rotate particles in each tomogram to the
^reference orientation.  For the first iteration, those angles are combined with a particle's
^angles in the motive list to determine the rotation needed to align the particle with the
^reference.  It is only applied before the first iteration.

[Field = particlePerCPU]
comment = Specify how to distribute workload among all CPUs.  # of particles per CPU for each
^run.

[Field = szVol]
comment = The size of the volume around each particle to average
^if reference is filename, this parameter is ignored. the reference size dictates "szVol".

[Field = fnOutput]
comment = The base name of the output files for the average volumes, the
^reference volumes, and the transformation parameters

[Field = sampleSphere]
comment = If This is set to 'full' or 'half', for the fisrt iteration, dTheta and dPsi will be ignored and
^'dPhi' and 'sampleInterval' will be used.
^if it does not exist or is set to 'none', it will search over the range specified by dPhi, dTheta, dPsi.


[Field = sampleInterval]
comment = The interval in degrees at which the spherical surface is sampled.

[Field = dPhi]
comment = Phi is the rotation around the  Y-axis specified above by the parameter "yaxis".
^From this Y-axis, the corresponding X-axis and Z-axis are deduced.

[Field = dTheta]
comment = Theta is around the corresponding Z-axis. dTheta is the increment.

[Field = dPsi]
comment = Psi is around the corresponding X-axis. dPsi is the increment.

[Field = searchRadius]
KeyValueDelimiter = ==
comment == The number of pixels to search in each dimension
^searchRadius={4, 5} is equivalent to searchRadius={[4 4 4],[5 5 5]}
KeyValueDelimiter == =

[Field = lowCutoff]
KeyValueDelimiter = ==
comment == The frequency domain cutoff parameters for prefiltering the
^particles and reference lowCutoff =< 0 prevents low frequency
^filtering, hiCutoff >= 0.866 prevents high frequency filtering.
^An optional second parameter defines the transition width.
KeyValueDelimiter == =

[Field = hiCutoff]
KeyValueDelimiter = ==
comment == The frequency domain cutoff parameters for prefiltering the
^particles and reference lowCutoff =< 0 prevents low frequency
^filtering, hiCutoff >= 0.866 prevents high frequency filtering.
^An optional second parameter defines the transition width.
KeyValueDelimiter == =

[Field = CCMode]
comment = The cross correlation measure to use.
^0: Local energy normalized cross correlation (default)
^1: True local correlation coefficient
tooltip = The cross correlation measure to use.
enum.0.tooltip = Local energy normalized cross correlation (default)
enum.1.tooltip = True local correlation coefficient

[Field = refThreshold]
comment = The threshold to generate the reference particle at each stage
^If this is less than 1 it specifies a cross correlation
^coefficient threshold, if it is greater than 1 it specfies the
^number of particles to use


[Field = refFlagAllTom]
comment = 1: use particles with best correlation scores among all particles of all tomos;
^0: prefer equal number of particles from each tomo;

[Field = tiltRange]
comment = The tilt range used to acquire the tilt series [min max].
^This will compenstate  for the missing wedge in generating
^the alignment and the averages.  A empty array, [] or {}, specifies
^not to account for the missing wedge (and use more efficient
^space domain averaging).

[Field = edgeShift]
comment = The number of pixels shift the edge of the wedge mask to ensure
^that all of the frequency info is included.

[Field = flgWedgeWeight]
comment = Apply missing wedge compensation to the alignment search

[Field = nWeightGroup]
comment = Number of wedge weight groups to divide particles into for equalizing
^CCCs between the groups.  When selecting particles for a new reference or
^average after the first round of alignment, correlation coefficients will be
^adjusted so that the median CCCs of the weight groups are about the same,
^alleviating biases dues to deficiencies in the missing wedge compensation.  Use
^0 for no adjustment.

[Field = lstThresholds]
comment = The list of thresholds to use for computing the final volumes.
^An average volume is generated for each value in this vector.
^The format of the average volume file name is
^fnOutout_AvgVol_navg_thresh_iteration.mrc

[Field = lstFlagAllTom]
comment = 1: use particles with best correlation scores among all particles of all tomos;
^0: prefer equal number of particles from each tomo;

[Field = flgMeanFill]
comment = If any particles are partially out of the volume fill with the
^mean of the existant data (default: 1).

[Field = alignedBaseName]
comment = The basename for the aligned particle MRC files (default: '').

[Field = debugLevel]
comment = How much debugging info to print {0|1|2|3}

[Field = flgAlignAverages]
comment = If non-zero, and if "yaxisType" is also non-zero, rotate average
^volumes to have the particle's Y axes approximately vertical.
tooltip = Align averages to have the particle's Y axis approximately vertical.

[Field = flgRemoveDuplicates]
comment = If non-zero, search for and mark duplicate particles after
^each alignment iteration. Particles marked as duplicates will be
^excluded from averages and resolution estimates.
tooltip = Remove mulitple references to the same particle after each iteration.

[Field = duplicateShiftTolerance]
comment = An arry of integers giving the maximum distance in pixels at
^which particles can be considered duplicates at each iteration. Applied 
^separately to each dimension, so the region defined is a cube rather
^than a sphere. 
tooltip = The maximum distance in pixels at which particles can be
considered duplicates.

[Field = flgDuplicateAngularTolerance]
comment = An array of integers giving the maximum orientation difference in
^degrees at which particles can be considered duplicates at each iteration.
tooltip = The maximum orientation difference in degrees at which particles can be considered duplicates.

