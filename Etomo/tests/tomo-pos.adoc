Version = 1.2

[function = build]
run.function.create-sample-tomograms=
run.function.compute-z-shift-&-pitch-angles=
run.function.create-final-alignment=
bn.done =

[function = create-sample-tomograms]
copy.file = %{dataset}%{axis}.fid
tf.sample-tomogram-thickness = %{sample-tomogram-thickness}
bn.create-sample-tomograms =
wait.process.creating-sample-tomogram = done

[function = compute-z-shift-&-pitch-angles]
copy.file = tomopitch%{axis}.mod
bn.compute-z-shift-&-pitch-angles =
wait.process.finding-sample-position = done

[function = create-final-alignment]
bn.create-final-alignment =
wait.process.calculating-final-alignment = done

[function = run1]
copy.file = %{dataset}%{axis}.fid
tf.sample-tomogram-thickness = %{sample-tomogram-thickness}
bn.create-sample-tomograms =
wait.process.creating-sample-tomogram = done
assert.file.exist = sample%{axis}.log
bn.create-sample-tomograms =
wait.process.creating-sample-tomogram = done
assert.file.exist = sample%{axis}.log~
# check whole tomogram
cb.use-whole-tomogram =
bn.create-whole-tomogram =
wait.process.tilt = done

[function = run2]
cb.use-whole-tomogram =
#
copy.file = tomopitch%{axis}.mod
bn.compute-z-shift-&-pitch-angles =
wait.process.finding-sample-position = done
assert.file.exist = tomopitch%{axis}.log
bn.compute-z-shift-&-pitch-angles =
wait.process.finding-sample-position = done
assert.file.exist = tomopitch%{axis}.log~
bn.create-final-alignment =
wait.process.calculating-final-alignment = done
assert.file.exist = align%{axis}.log
bn.create-final-alignment =
wait.process.calculating-final-alignment = done
assert.file.exist = align%{axis}.log~
bn.done =

[function = assert-whole-tomo]
assert.file.exist = %{dataset}%{axis}.rec

[function = assert-whole-tomo-single]
assert.file.exist = %{dataset}_full.rec

[function = test]
run.function.run1=
run.function.assert-whole-tomo=
run.function.run2=

[function = test-single]
run.function.run1=
run.function.assert-whole-tomo-single=
run.function.run2=

[function = run-fidless]
tf.sample-tomogram-thickness = %{sample-tomogram-thickness}
cb.use-whole-tomogram =
bn.create-whole-tomogram =
wait.process.tilt = done
assert.file.exist = newst%{axis}.log
assert.file.exist = tilt%{axis}.log
bn.create-whole-tomogram =
wait.process.tilt = done
assert.file.exist = newst%{axis}.log~
assert.file.exist = tilt%{axis}.log~
copy.file = tomopitch%{axis}.mod
bn.compute-z-shift-&-pitch-angles =
wait.process.finding-sample-position = done
assert.file.exist = tomopitch%{axis}.log
bn.compute-z-shift-&-pitch-angles =
wait.process.finding-sample-position = done
assert.file.exist = tomopitch%{axis}.log~
bn.done =

