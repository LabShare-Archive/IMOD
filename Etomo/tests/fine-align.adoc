Version = 1.2

[function = main]
[[if = test-gui]]
	run.function.assert-general-fields=
	run.function.assert-general-fields-advanced=
	run.function.assert-general-local-alignments-fields-enabled=
	run.function.assert-global-fields=
	run.function.assert-global-fields-advanced=
	run.function.assert-global-beam-tilt-fields-enabled=
	run.function.compute-alignment=
	run.function.files-exist=
	run.function.set-global=
	run.function.compute-alignment=
	assert.exists.file = align%{axis}.log~
[[]]
[[ifnot = test-gui]]
	run.function.set-global=
	run.function.set-general=
[[]]
run.function.compute-alignment=
copy.file = %{dataset}%{axis}.fid
run.function.compute-alignment=
bn.done =
wait.popup.etomo-question = Yes


# build functions
#################

[function = set-global]
tb.general.1 = 
rb.full-solution =

[function = set-general]
tb.general.0 =
cb.enable-local-alignments =
rb.neighboring-views =

[function = compute-alignment]
bn.compute-alignment =
wait.process.aligning-stack = done


# field state functions
#######################

[function = assert-general-fields]
tb.general.0 =
assert.tf.list-of-views-to-exclude=
assert.tf.separate-view-groups=
assert.tf.threshold-for-residual-report=3.0
assert.rb.all-views=on
assert.rb.neighboring-views=off
assert.rb.assume-fiducials-on-1-surface-for-analysis=off
assert.rb.assume-fiducials-on-2-surfaces-for-analysis=on
assert.tf.total-tilt-angle-offset=0.0
assert.tf.tilt-axis-z-shift=0.0
assert.cb.enable-local-alignments=0
assert.rb.target-patch-size=on
assert.tf.target-patch-size=700,700
assert.rb.#-of-local-patches=off
assert.tf.#-of-local-patches=5,5
assert.tf.min-#-of-fiducials=8,3
# enabled
assert.enabled.tf.list-of-views-to-exclude=
assert.enabled.tf.separate-view-groups=
assert.enabled.tf.threshold-for-residual-report=
assert.enabled.rb.all-views=
assert.enabled.rb.neighboring-views=
assert.enabled.rb.assume-fiducials-on-1-surface-for-analysis=
assert.enabled.rb.assume-fiducials-on-2-surfaces-for-analysis=
assert.enabled.tf.total-tilt-angle-offset=
assert.enabled.tf.tilt-axis-z-shift=
assert.enabled.cb.enable-local-alignments=
assert.disabled.rb.target-patch-size=
assert.disabled.tf.target-patch-size=
assert.disabled.rb.#-of-local-patches=
assert.disabled.tf.#-of-local-patches=
assert.disabled.tf.min-#-of-fiducials=

[function = assert-general-fields-advanced]
bn.advanced =
assert.tf.metro-factor=0.25
assert.tf.cycle-limit=1000
assert.tf.overlap-factor=0.5,0.5
#assert.cb.use-global-x-y-z-coordinates=%{use-global-x-y-z-coordinates}
# enabled
assert.enabled.tf.metro-factor=
assert.enabled.tf.cycle-limit=
assert.disabled.tf.overlap-factor=
assert.disabled.cb.use-global-x-y-z-coordinates=
bn.basic =

[function = assert-general-local-alignments-fields-enabled]
bn.advanced=
cb.enable-local-alignments=on
assert.enabled.rb.target-patch-size=
assert.enabled.tf.target-patch-size=
assert.enabled.rb.#-of-local-patches=
assert.disabled.tf.#-of-local-patches=
assert.enabled.tf.overlap-factor=
assert.enabled.tf.min-#-of-fiducials=
assert.enabled.cb.use-global-x-y-z-coordinates=
# bug# 973
rb.#-of-local-patches=
assert.disabled.tf.target-patch-size=
assert.enabled.tf.#-of-local-patches=
assert.tf.min-local-patch-size-or-overlap-factor=0.5,0.5
assert.enabled.tf.min-local-patch-size-or-overlap-factor=
rb.target-patch-size=
assert.enabled.tf.target-patch-size=
assert.disabled.tf.#-of-local-patches=
assert.tf.overlap-factor=0.5,0.5
#
cb.enable-local-alignments=off
assert.disabled.rb.target-patch-size=
assert.disabled.tf.target-patch-size=
assert.disabled.rb.#-of-local-patches=
assert.disabled.tf.#-of-local-patches=
assert.disabled.tf.overlap-factor=
assert.disabled.tf.min-#-of-fiducials=
assert.disabled.cb.use-global-x-y-z-coordinates=
bn.basic =

[function = assert-global-fields]
tb.general.1 =
assert.rb.no-rotation=off
assert.rb.solve-for-all-rotations=on
assert.rb.group-rotations=off
assert.rb.one-rotation=off
assert.tf.rotation-angle=%{image-rotation}
assert.tf.group-size = 5
assert.rb.fixed-magnification-at-10=off
assert.rb.solve-for-all-magnifications = on
assert.rb.group-magnifications = off
assert.tf.group-size.1 = 4
assert.rb.fixed-tilt-angles=off
assert.rb.solve-for-all-except-minimum-tilt=off
assert.rb.group-tilt-angles=on
assert.tf.group-size.2 = 5
assert.rb.disabled = on
assert.rb.full-solution = off
assert.rb.skew-only = off
assert.tf.x-stretch-group-size = 7
assert.tf.skew-group-size = 11
# enabled
assert.enabled.rb.no-rotation=
assert.enabled.rb.solve-for-all-rotations=
assert.enabled.rb.group-rotations=
assert.enabled.rb.one-rotation=
assert.disabled.tf.rotation-angle=
assert.disabled.tf.group-size=
assert.enabled.rb.fixed-magnification-at-10=
assert.enabled.rb.solve-for-all-magnifications=
assert.enabled.rb.group-magnifications=
assert.disabled.tf.group-size.1=
assert.enabled.rb.fixed-tilt-angles=
assert.enabled.rb.solve-for-all-except-minimum-tilt=
assert.enabled.rb.group-tilt-angles=
assert.enabled.tf.group-size.2=
assert.enabled.rb.disabled=
assert.enabled.rb.full-solution=
assert.enabled.rb.skew-only=
assert.disabled.tf.x-stretch-group-size=
assert.disabled.tf.skew-group-size=
# Test enabling
rb.no-rotation=
assert.enabled.tf.rotation-angle=
rb.solve-for-all-rotations=
tb.general.0 =

[function = assert-global-fields-advanced]
tb.general.1 =
bn.advanced =
assert.tf.non-default-grouping = 
assert.tf.non-default-grouping.1 =
assert.tf.reference-view = 1
assert.tf.non-default-grouping.2 =  
assert.tf.x-stretch-non-default-grouping = 
assert.tf.skew-non-default-grouping = 
assert.rb.no-beam-tilt = on
assert.rb.fixed-beam-tilt = off
assert.tf.fixed-beam-tilt = 
assert.rb.solve-for-beam-tilt = off
assert.cb.solve-for-single-stretch-during-projection = off
# enabled
assert.disabled.tf.non-default-grouping=
assert.disabled.tf.non-default-grouping.1=
assert.enabled.tf.reference-view=
assert.enabled.tf.non-default-grouping.2=
assert.disabled.tf.x-stretch-non-default-grouping=
assert.disabled.tf.skew-non-default-grouping=
assert.enabled.rb.no-beam-tilt=
assert.enabled.rb.fixed-beam-tilt=
assert.disabled.tf.fixed-beam-tilt=
assert.enabled.rb.solve-for-beam-tilt=
assert.enabled.cb.solve-for-single-stretch-during-projection=
bn.basic =
tb.general.0 =

[function = assert-global-beam-tilt-fields-enabled]
# bug# 981
tb.general.1 =
mb.beam-tilt = A
rb.full-solution =
assert.disabled.rb.solve-for-beam-tilt=
rb.group-rotations=
assert.disabled.rb.solve-for-beam-tilt=
rb.skew-only=
assert.disabled.rb.solve-for-beam-tilt=
rb.one-rotation=
assert.enabled.rb.solve-for-beam-tilt=
rb.solve-for-beam-tilt = 
assert.disabled.rb.solve-for-all-rotations=
assert.disabled.rb.group-rotations=
rb.full-solution =
assert.disabled.rb.solve-for-all-rotations=
assert.disabled.rb.group-rotations=
rb.disabled =
assert.enabled.rb.solve-for-all-rotations=
assert.enabled.rb.group-rotations=
rb.solve-for-all-rotations=
assert.disabled.rb.full-solution=
assert.rb.skew-only=off
rb.group-rotations=
assert.disabled.rb.full-solution=
assert.rb.skew-only=off
rb.no-beam-tilt=
assert.enabled.rb.full-solution=
assert.enabled.rb.skew-only=
rb.solve-for-all-rotations=
rb.disabled =
mb.beam-tilt = B
tb.general.0 =

# Functionality tests
#####################

[function = files-exist]
assert.exists.file = align%{axis}.log
assert.exists.file = taAngles%{axis}.log
assert.exists.file = taCoordinates%{axis}.log
assert.exists.file = taError%{axis}.log
assert.exists.file = taLocals%{axis}.log
assert.exists.file = taMappings%{axis}.log
assert.exists.file = taResiduals%{axis}.log
assert.exists.file = taSolution%{axis}.log